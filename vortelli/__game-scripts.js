var PlayerStats=pc.createScript("playerStats");PlayerStats.prototype.initialize=function(){this.app.playerStats={PLAYER_STATS_VERSION:"1.0",settings:{pedDensity:6,vehicleDensity:3},tutorialCompleted:!1,jobsCompleted:0,jobsFailed:0,jobsCancelled:0,pizzasDelivered:0,coins:0,highwayPasses:2,selectedVehicleName:"Dasher",regions:{Downtown:{isUnlocked:!1,jobsCompleted:0,jobsFailed:0,pizzasDelivered:0},"South Beach":{isUnlocked:!1,jobsCompleted:0,jobsFailed:0,pizzasDelivered:0},Middleport:{isUnlocked:!1,jobsCompleted:0,jobsFailed:0,pizzasDelivered:0},Docks:{isUnlocked:!1,jobsCompleted:0,jobsFailed:0,pizzasDelivered:0},"The Cove":{isUnlocked:!1,jobsCompleted:0,jobsFailed:0,pizzasDelivered:0}},vehicles:{Dasher:{isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0},Memphis:{isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0},Callie:{isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0},Oxford:{isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0}},skills:{jobSize:0,jobUrgency:0},jumps:{completed:[]},settings:{musicMuted:!1,sfxMuted:!1}},this.app.isVehicleOwned=function(t){return void 0!==this.app.playerStats.vehicles[t]}.bind(this),this.app.hasJumpBeenCompleted=function(t){return this._hasJumpBeenCompleted(t)}.bind(this),this.app.getNumJumpsCompleted=function(){return this.app.playerStats.jumps.completed.length}.bind(this),this._lastSavedHealth=-100,this.app.on("coins:add",this._addCoins,this),this.app.on("coins:spend",this._spendCoins,this),this.app.on("job:failed",this._saveJobFailed,this),this.app.on("job:cancel",this._saveJobCancelled,this),this.app.on("settings:change",this._persistStats,this),this.app.on("job:complete",this._saveJobCompleted,this),this.app.on("region:travel",this._spendHighwayPass,this),this.app.on("highway:pass:add",this._addHighwayPass,this),this.app.on("jump:completed:new",this._saveJumpCompleted,this),this.app.on("skills:upgrade",this._saveUpgradedSkills,this),this.app.on("vehicle:boost:add",this._saveVehicleBoost,this),this.app.on("vehicle:boost:use",this._saveVehicleBoost,this),this.app.on("vehicle:purchase",this._storeVehiclePurchase,this),this.app.on("region:unlock",this._saveRegionUnlockState,this),this.app.on("tutorial:complete",this._saveTutorialComplete,this),this.app.on("vehicle:player:damage",this._saveVehicleHealth,this),this.app.on("vehicle:player:repair",this._saveRepairedVehicle,this),this.app.on("vehicle:player:spawn",this._saveSelectedVehicle,this)},PlayerStats.prototype.postInitialize=function(){let t=this.app.localStorage.getItem("stats");if(t&&t.length>0){let e=JSON.parse(JSON.stringify(this.app.playerStats));this.app.playerStats=JSON.parse(atob(t)),this._addMissingFields(e)}this.app.fire("stats:loaded",this.app.playerStats)},PlayerStats.prototype._addMissingFields=function(t){for(const[e,s]of Object.entries(t))if(!(e in this.app.playerStats)){if("PLAYER_STATS_VERSION"==e)return this.app.playerStats=JSON.parse(JSON.stringify(t)),this._persistStats(),void this.postInitialize();this.app.playerStats[e]=JSON.parse(JSON.stringify(t[e]))}this.app.playerStats.vehicles.Memphis||(this.app.playerStats.vehicles.Memphis={isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0}),this.app.playerStats.vehicles.Callie||(this.app.playerStats.vehicles.Callie={isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0}),this.app.playerStats.vehicles.Oxford||(this.app.playerStats.vehicles.Oxford={isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0})},PlayerStats.prototype._persistStats=function(){let t=JSON.stringify(this.app.playerStats),e=btoa(t);this.app.localStorage.setItem("stats",e)},PlayerStats.prototype._addCoins=function(t){this.app.playerStats.coins+=t,this._persistStats()},PlayerStats.prototype._spendCoins=function(t){isNaN(t)||t<=0||(this.app.playerStats.coins-=t,this.app.playerStats.coins<0&&(this.app.playerStats.coins=0),this.app.fire("coins:update",this.app.playerStats.coins),this._persistStats())},PlayerStats.prototype._saveJobFailed=function(){if(this.app.playerStats.jobsFailed+=1,this.app.globals.currentJob){let t=this.app.globals.currentJob;const e=t.numPizzas-t.numDeliveriesRemaining;this.app.playerStats.pizzasDelivered+=e,this.app.playerStats.regions[this.app.globals.currentJob.region].jobsFailed+=1}if(this.app.globals.currentVehicle){const t=this.app.globals.currentVehicle.vehicleName;if(this.app.playerStats.vehicles[t].jobsFailed+=1,this.app.globals.currentJob){const e=this.app.globals.currentJob.numPizzas-this.app.globals.currentJob.numDeliveriesRemaining;this.app.playerStats.vehicles[t].pizzasDelivered+=e}}this._persistStats()},PlayerStats.prototype._saveJobCancelled=function(){this.app.playerStats.jobsCancelled+=1,this._persistStats()},PlayerStats.prototype._saveJobCompleted=function(){if(this.app.playerStats.jobsCompleted+=1,this.app.globals.currentJob){const t=this.app.globals.currentJob.region;this.app.playerStats.regions[t].jobsCompleted+=1,this.app.playerStats.regions[t].pizzasDelivered+=this.app.globals.currentJob.numPizzas,this.app.playerStats.pizzasDelivered+=this.app.globals.currentJob.numPizzas}if(this.app.globals.currentVehicle){const t=this.app.globals.currentVehicle.vehicleName;this.app.playerStats.vehicles[t].jobsCompleted+=1,this.app.globals.currentJob&&(this.app.playerStats.vehicles[t].pizzasDelivered+=this.app.globals.currentJob.numPizzas)}this._persistStats()},PlayerStats.prototype._addHighwayPass=function(){this.app.playerStats.highwayPasses+=1,this._persistStats()},PlayerStats.prototype._spendHighwayPass=function(){this.app.playerStats.highwayPasses-=1,this.app.playerStats.highwayPasses<0&&(this.app.playerStats.highwayPasses=0),this._persistStats()},PlayerStats.prototype._saveJumpCompleted=function(t){this._hasJumpBeenCompleted(t)||(this.app.playerStats.jumps.completed.push(t.name),this._persistStats())},PlayerStats.prototype._hasJumpBeenCompleted=function(t){for(let e in this.app.playerStats.jumps.completed)if(t.name==this.app.playerStats.jumps.completed[e])return!0;return!1},PlayerStats.prototype._saveUpgradedSkills=function(t){this.app.playerStats.skills=t,this._persistStats()},PlayerStats.prototype._saveVehicleBoost=function(t,e){this.app.playerStats.vehicles[t].boostTime=e,this._persistStats()},PlayerStats.prototype._storeVehiclePurchase=function(t){this.app.playerStats.vehicles[t.name]={isUnlocked:!0,health:100,boostTime:0,jobsFailed:0,jobsCompleted:0,pizzasDelivered:0},this._persistStats()},PlayerStats.prototype._saveRegionUnlockState=function(t){this.app.playerStats.regions[t].isUnlocked=!0,this._persistStats()},PlayerStats.prototype._saveTutorialComplete=function(){this.app.playerStats.tutorialCompleted=!0,this._persistStats()},PlayerStats.prototype._saveVehicleHealth=function(t){let e=this.app.playerStats.selectedVehicleName;this.app.playerStats.vehicles[e].health=t,(Math.abs(this._lastSavedHealth-t)>5||t<=0)&&(this._persistStats(),this._lastSavedHealth=t)},PlayerStats.prototype._saveRepairedVehicle=function(t,e){this.app.playerStats.vehicles[t].health=e,this._persistStats()},PlayerStats.prototype._saveSelectedVehicle=function(t){this.app.playerStats.selectedVehicleName=t.name,this._persistStats()};!function(){let t=[],o=[],e=0,c=0;for(let e=0;e<256;e++)o.push(new pc.Vec3),t.push(new pc.Quat);function Q(o){let c=t[255&e++];return 0!=o&&c.copy(o||pc.Quat.IDENTITY),c}function V(t,e,n){let r=o[255&c++];if(void 0!==e&&void 0!==n){let o=r.data;return o[0]=t,o[1]=e,o[2]=n,r}if(void 0!==t){let o=r.data,e=t.data;o[0]=e[0],o[1]=e[1],o[2]=e[2]}return r}function orthogonal(t){let o=Math.abs(t.x),e=Math.abs(t.y),c=Math.abs(t.z),n=o<e?o<c?pc.Vec3.RIGHT:pc.Vec3.FORWARD:e<c?pc.Vec3.UP:pc.Vec3.FORWARD;return V().cross(t,n)}pc.Vec3.temp=V,pc.Quat.temp=Q,pc.Vec3.prototype.angle=function(t,o){return function angleBetween(t,o,e){return e=e||pc.Vec3.UP,Math.atan2(V().cross(t,o).dot(e),t.dot(o))*pc.math.RAD_TO_DEG}(this,t,o)},pc.Quat.prototype.fromToRotation=function(t,o){return function fromToRotation(t,o,e){let c=t.dot(o);if(e=e||Q(),c<=-.999){e.w=0;let o=orthogonal(t).normalize();return e.x=o.x,e.y=o.y,e.z=o.z,e}let n=V(t).add(o).scale(.5);e.w=t.dot(n);let r=V().cross(t,n);return e.x=r.x,e.y=r.y,e.z=r.z,e.normalize()}(t,o,this)},pc.Quat.prototype.twist=function(t){let o=orthogonal(t),e=this.transformVector(o,V()),c=V(e).sub(V(t).scale(e.dot(t))).normalize(),n=Math.acos(o.dot(c))*pc.math.RAD_TO_DEG;return V(this.x,this.y,this.z).dot(t)>0?-n:n};let n=new pc.Mat4;pc.Quat.prototype.lookAt=function(t,o,e){return n.setLookAt(t,o,e||pc.Vec3.UP),this.setFromMat4(n),this};let r=pc.Vec3.prototype.mul;pc.Vec3.prototype.mul=function(t,o,e){return t instanceof pc.Quat?t.transformVector(this,this):r.call(this,t,o,e)}}();let Vehicle=pc.createScript("vehicle");Vehicle.attributes.add("wheels",{type:"entity",array:!0,title:"Wheels"}),Vehicle.attributes.add("maxEngineForce",{type:"number",default:2e3,title:"Max Engine Force"}),Vehicle.attributes.add("maxBrakingForce",{type:"number",default:100,title:"Max Braking Force"}),Vehicle.attributes.add("maxSteering",{type:"number",default:.3,title:"Max Steering"}),Vehicle.attributes.add("maxSpeed",{type:"number",default:200,title:"Max Speed"}),Vehicle.attributes.add("isPlayerControlled",{type:"boolean",default:!1}),Vehicle.attributes.add("durability",{type:"number",description:"Range between -10 and +10 that scales damage dealt upon collision. Higher means stronger."}),Vehicle.attributes.add("driftiness",{type:"number",default:.5,description:"Range between 0 and 1 describing how likely the car will lose traction cornering. 0 will have no traction, 1 will never lose traction."}),Vehicle.attributes.add("driftTraction",{type:"number",default:.5,description:"Range between 0 and 10 that applies when the rear tires slip. 0 will slide a lot, 10 will not slide."}),Object.defineProperty(Vehicle.prototype,"speed",{get:function(){return this.ammoVehicle?this.ammoVehicle.getCurrentSpeedKmHour():0}}),Vehicle.attributes.add("damageSmoke",{type:"entity"}),Vehicle.prototype.initialize=function(){this.isSubmerged=!1,this.engineDamageFactor=1,this._white=new pc.CurveSet([[0,.5,1,.8],[0,.5,1,.8],[0,.5,1,.8]]),this._grey=new pc.CurveSet([[0,.5,1,.35],[0,.5,1,.35],[0,.5,1,.35]]),this._black=new pc.CurveSet([[0,.5,1,0],[0,.5,1,0],[0,.5,1,0]])},Vehicle.prototype.initVehiclePhysics=function(){this.body=this.entity.rigidbody.body;let e=this.app.systems.rigidbody.dynamicsWorld;this.entity.rigidbody.on("collisionstart",(function(e){this.hadCollisionThisFrame=!0,!this.isPlayerControlled&&e.other.tags.has("player")&&this.entity.script.aiDriver&&this.entity.script.aiDriver.stopAfterCollision()}),this);let t=new Ammo.btVehicleTuning,i=new Ammo.btDefaultVehicleRaycaster(e),s=new Ammo.btRaycastVehicle(t,this.body,i);if(s.setCoordinateSystem(0,1,2),this.isPlayerControlled){const e=4;this.body.setActivationState(e)}let o=new Ammo.btVector3(-1,0,0),h=new Ammo.btVector3(0,-1,0),n=new Ammo.btVector3(0,0,0);this._startingFrictionSlip=10,this.wheels.forEach((function(e){let i=e.script.vehicleWheel,r=i.frictionSlip;this._startingFrictionSlip=r;let a=i.isFront,l=i.radius,c=i.rollInfluence,p=i.suspensionCompression,m=i.suspensionDamping,d=i.suspensionRestLength,u=i.suspensionStiffness,g=e.getLocalPosition();n.setValue(g.x,g.y,g.z),e.script.vehicleWheel.wheelInfo=s.addWheel(n,h,o,d,l,t,a);let y=e.script.vehicleWheel.wheelInfo;y.set_m_suspensionStiffness(u),y.set_m_wheelsDampingRelaxation(m),y.set_m_wheelsDampingCompression(p),y.set_m_frictionSlip(r),y.set_m_rollInfluence(c)}),this),Ammo.destroy(o),Ammo.destroy(h),Ammo.destroy(n),e.addAction(s),this.ammoVehicle=s,this.absSpeedLastFrame=0,this.hadCollisionThisFrame=!1,this.driftiness=.1,this.driftTraction=.25,this.isDrifting=!1,this.engineForce=0,this.brakingForce=0,this.steering=0,this.cumulativeSteerInput=0,this._startingMass=this.entity.rigidbody.mass,this._slipForceIncrease=0,this._BOOST_DURATION=3,this._boostCountdownS=0,this._maxSpeedBoost=0,this._engineForceBoost=0,this.on("vehicle:controls",(function(e,t,i,s){this.body.setActivationState(1);const o=this.maxSpeed+this._maxSpeedBoost;if(this.isPlayerControlled){const e=this.speed/o>=this.driftiness;if(this.cumulativeSteerInput=e&&-1==t||e&&1==t?pc.math.lerp(this.cumulativeSteerInput,t,.05):pc.math.lerp(this.cumulativeSteerInput,0,.2),1==s&&(this.cumulativeSteerInput<=-this.driftiness||this.cumulativeSteerInput>=this.driftiness)){let e;this.isDrifting=!0,this.wheels.forEach(function(t){let i=t.script.vehicleWheel;i.isFront||(i.wheelInfo.m_skidInfo<.5?(e=pc.math.lerp(i.wheelInfo.m_frictionSlip,1,.2),i.wheelInfo.set_m_frictionSlip(e)):(e=pc.math.lerp(i.wheelInfo.m_frictionSlip,this.driftTraction,.2),i.wheelInfo.set_m_frictionSlip(e)))}.bind(this)),this._slipForceIncrease=pc.math.lerp(this._slipForceIncrease,.5*this.maxEngineForce,.1)}else this.isDrifting=!1,this.wheels.forEach(function(e){let t=e.script.vehicleWheel;if(!t.isFront){let e=pc.math.lerp(t.wheelInfo.m_frictionSlip,this._startingFrictionSlip,.01);t.wheelInfo.set_m_frictionSlip(e)}}.bind(this)),this._slipForceIncrease=pc.math.lerp(this._slipForceIncrease,0,.1)}let h=this.maxSteering;this.speed>0&&(h=this.maxSteering-this.speed/(2*o)*this.maxSteering);let n=1;1==s&&(n=1.25),this.steering=pc.math.lerp(this.steering,t*h*n,.3);let r=this.maxEngineForce*this.engineDamageFactor;if(this.entity.script.gearBox&&this.entity.script.gearBox.applyInput(e,t,i,s),i>0){if(this.brakingForce=0,this.speed<o)this.engineForce=r;else{let e=this.speed/o*r;e>r&&(e=r),this.engineForce=r-e}this.isPlayerControlled&&this.backWheelsAreSlipping()&&(this.engineForce+=this._slipForceIncrease)}else if(i<0)if(this.brakingForce=0,this.speed>-o)this.engineForce=-r;else{let e=Math.abs(this.speed/o)*r;e>r&&(e=r),this.engineForce=-r+e}else this.brakingForce=this.maxBrakingForce,this.engineForce=0;i>0?this.engineForce+=this._engineForceBoost:i<0&&(this.engineForce-=this._engineForceBoost)}))},Vehicle.prototype.update=function(e){if(this.ammoVehicle){if(this.ammoVehicle.setSteeringValue(this.steering,0),this.ammoVehicle.setSteeringValue(this.steering,1),this.ammoVehicle.applyEngineForce(this.engineForce,2),this.ammoVehicle.setBrake(this.brakingForce,2),this.ammoVehicle.applyEngineForce(this.engineForce,3),this.ammoVehicle.setBrake(this.brakingForce,3),this.setWheelPositions(),this.hadCollisionThisFrame){let e=this.absSpeedLastFrame-Math.abs(this.speed);e>=3&&this.dealDamage(e/10)}this.hadCollisionThisFrame=!1,this.absSpeedLastFrame=Math.abs(this.speed),this.isPlayerControlled&&this._updateBoost(e)}},Vehicle.prototype.setWheelPositions=function(){let e=this.ammoVehicle.getNumWheels();for(let t=0;t<e;t++){this.isSubmerged||this.ammoVehicle.updateWheelTransform(t,!0);let e=this.ammoVehicle.getWheelTransformWS(t),i=e.getOrigin(),s=e.getRotation(),o=this.wheels[t];o.setPosition(i.x(),i.y(),i.z()),o.setRotation(s.x(),s.y(),s.z(),s.w()),o.rotateLocal(0,0,180)}},Vehicle.prototype.dealDamage=function(e,t=null){if(this.app.globals.isTutorialRunning&&this.health<=50)return this.health<=50&&this.isSubmerged?void this.app.fire("vehicle:player:drowned"):void 0;e-=e*this.durability/10,this.health-=e,this.health<0&&(this.health=0),this.updateSmokeColor(),this.updateEnginePower(),this.entity.tags.has("player")&&(this.app.fire("vehicle:player:damage",this.health),this.health<=.1&&this.isSubmerged&&this.app.fire("vehicle:player:drowned"),this.health<=.1&&!this.isSubmerged&&this.app.fire("vehicle:player:wrecked")),this._playDamageSound(t)},Vehicle.prototype._playDamageSound=function(e){if((null==e||!e.script.pedestrian)&&this.entity.sound&&!this.isSubmerged){let e=parseInt(pc.math.random(0,3));this.entity.sound.slot("metal-hit-"+e).play()}},Vehicle.prototype.getHealth=function(){return this.health},Vehicle.prototype.setHealth=function(e){this.health=e,this.updateSmokeColor(),this.updateEnginePower()},Vehicle.prototype.getBoostTime=function(){return this.boostTimeS},Vehicle.prototype.setBoostTime=function(e){e&&(this.boostTimeS=e)},Vehicle.prototype.updateSmokeColor=function(){this.damageSmoke&&(this.health>=75||this.isSubmerged?this.damageSmoke.particlesystem.stop():this.health>=50?(this.damageSmoke.particlesystem.colorGraph=this._white,this.damageSmoke.particlesystem.play()):this.health>=25?(this.damageSmoke.particlesystem.colorGraph=this._grey,this.damageSmoke.particlesystem.play()):(this.damageSmoke.particlesystem.colorGraph=this._black,this.damageSmoke.particlesystem.play()))},Vehicle.prototype.updateEnginePower=function(){this.health<=.1?this.engineDamageFactor=.25:this.health<25?this.engineDamageFactor=.8:this.engineDamageFactor=1},Vehicle.prototype.backWheelsAreSlipping=function(){let e=this.ammoVehicle.getNumWheels();for(let t=0;t<e;t++){let e=this.wheels[t].script.vehicleWheel;if(!e.isFront&&e.wheelInfo.m_frictionSlip<.2*this._startingFrictionSlip)return!0}return!1},Vehicle.prototype.boost=function(){this._boostCountdownS=this._BOOST_DURATION,this.boostTimeS-=this._BOOST_DURATION,this._maxSpeedBoost=.75*this.maxSpeed,this._engineForceBoost=this.maxEngineForce},Vehicle.prototype._updateBoost=function(e){this.isBoosting&&(this._boostCountdownS-=e,this._boostCountdownS<=0&&this._endBoost())},Vehicle.prototype._endBoost=function(){this._boostCountdownS=0,this._maxSpeedBoost=0,this._engineForceBoost=0},Vehicle.prototype.isBoosting=function(){return this._boostCountdownS>0},Vehicle.prototype.getBoostPercentage=function(){return this._boostCountdownS/this._BOOST_DURATION},Vehicle.prototype.getBoostCountdownS=function(){return this._boostCountdownS};var UiSpeed=pc.createScript("uiSpeed");UiSpeed.prototype.initialize=function(){},UiSpeed.prototype.update=function(e){if(this.app.globals.currentVehicle){let e=this.app.globals.currentVehicle.script.vehicle.speed;this.entity.element.text="Speed: "+Math.round(e)+"km/h"}else this.entity.element.text=""};var FollowCamera=pc.createScript("followCamera");FollowCamera.attributes.add("target",{type:"entity",title:"Target",description:"The target entity to follow"}),FollowCamera.attributes.add("targetFollowEntity",{type:"entity",title:"Target Follow Entity",description:"The invisible entity following the target, increases smoothness"}),FollowCamera.attributes.add("cameraOffset",{type:"vec3",default:[0,5,-10],title:"Camera Offset",description:"The distance and angle the camera will follow the car. Game needs to be reloaded for settings to take full effect!"}),FollowCamera.attributes.add("postTrackingOffset",{type:"vec3",default:[0,2.5,0],title:"Post Tracking Offset",description:"The local space offset applied after all other tracking logic runs"}),FollowCamera.attributes.add("lerpAmount",{type:"number",min:0,max:1,default:.99,title:"Lerp Amount",description:"The amount to lerp the camera towards its desired position every frame based on a 60fps frame rate. Lerping is frame rate independent though and will be correct for other frame rates."}),FollowCamera.attributes.add("followsAmmoVehicle",{type:"boolean",default:!1,description:"If true, this will place a 3-frame delay before moving to follow its target"}),FollowCamera.prototype.initialize=function(){this.targetPos=new pc.Vec3,this.currentPos=this.targetPos.clone(),this.userInputOffset=new pc.Vec3,this.matrix=new pc.Mat4,this.quat=new pc.Quat,this.vec=new pc.Vec3,this._holdFrameCountdown=0,this._targetCameraOffset=new pc.Vec3,this._startingCameraOffset=this.cameraOffset.clone(),this._targetCameraOffset.copy(this._startingCameraOffset),this._followEntity=this.targetFollowEntity,this.app.on("vehicle:player:ready",this._setStartingPosition,this)},FollowCamera.prototype._setStartingPosition=function(){if(this.target){this.updateTargetPosition(),this.currentPos.lerp(this.currentPos,this.targetPos,1),this.entity.setPosition(this.currentPos);let t=this._followEntity.getPosition().clone();t.lerp(t,this.target.getPosition(),1),this._followEntity.setPosition(t),this.entity.lookAt(this._followEntity.getPosition()),this.entity.fire("camera:ready")}},FollowCamera.prototype.setTarget=function(t){this.target=t,this.updateTargetPosition(),this.currentPos.copy(this.targetPos),this.followsAmmoVehicle&&(this._holdFrameCountdown=3)},FollowCamera.prototype.setImmediateTarget=function(t){this.target=t,this.updateTargetPosition(),this.currentPos.copy(this.targetPos)},FollowCamera.prototype.updateSpeedOffset=function(){if(!this.target.script||!this.target.script.vehicle)return;let t=this.target.script.vehicle.speed,e=this.target.script.vehicle.maxSpeed;this._targetCameraOffset.y=this._startingCameraOffset.y-t/e,this._targetCameraOffset.z=t<-25?-1*this._startingCameraOffset.z:this._startingCameraOffset.z,this.target.script.vehicle.isBoosting()&&(this._targetCameraOffset.z*=1.4,this._targetCameraOffset.y=1.5),this.cameraOffset.lerp(this.cameraOffset,this._targetCameraOffset,.05)},FollowCamera.prototype.updateTargetPosition=function(){var t=this.target.forward;this.vec.set(-t.x,0,-t.z).normalize();var e=180*Math.atan2(this.vec.x,this.vec.z)/Math.PI;this.quat.setFromEulerAngles(0,e,0),this.matrix.setTRS(this.target.getPosition(),this.quat,pc.Vec3.ONE),this.matrix.transformPoint(this.cameraOffset,this.targetPos)},FollowCamera.prototype.postUpdate=function(t){if(this._holdFrameCountdown>0&&(this._holdFrameCountdown-=1),this.target&&this._holdFrameCountdown<=0){this.updateSpeedOffset(),this.updateTargetPosition();let e=1-Math.pow(1-this.lerpAmount,t);this.currentPos.lerp(this.currentPos,this.targetPos,e),this.entity.setPosition(this.currentPos);let i=this._followEntity.getPosition().clone();i.lerp(i,this.target.getPosition(),e),this._followEntity.setPosition(i),this.entity.lookAt(this._followEntity.getPosition()),this.entity.translate(this.postTrackingOffset)}};var VehicleWheel=pc.createScript("vehicleWheel");const DEFAULT_WHEEL_RADIUS=.32,DEFAULT_WHEEL_WIDTH=.2;VehicleWheel.attributes.add("isFront",{type:"boolean",default:!0,title:"Front Wheel"}),VehicleWheel.attributes.add("radius",{type:"number",default:.32,title:"Radius"}),VehicleWheel.attributes.add("width",{type:"number",default:.2,title:"Width"}),VehicleWheel.attributes.add("suspensionStiffness",{type:"number",default:10,title:"Suspension Stiffness"}),VehicleWheel.attributes.add("suspensionDamping",{type:"number",default:2.3,title:"Suspension Damping"}),VehicleWheel.attributes.add("suspensionCompression",{type:"number",default:4.4,title:"Suspension Compression"}),VehicleWheel.attributes.add("suspensionRestLength",{type:"number",default:.2,title:"Suspension Rest Length"}),VehicleWheel.attributes.add("rollInfluence",{type:"number",default:.2,title:"Roll Influence"}),VehicleWheel.attributes.add("frictionSlip",{type:"number",default:1e3,title:"Friction Slip"}),VehicleWheel.attributes.add("renderEntity",{type:"entity",title:"Render Entity",description:"The visible entity containing the wheel's 3D model"}),VehicleWheel.prototype.initialize=function(){this.renderEntity.setLocalScale(this.width/.2,this.radius/.32,this.radius/.32),this.eBrakeFrictionSlip=0,this.eBrakeRecoveryTimeS=0};var WaterSurface=pc.createScript("waterSurface");WaterSurface.attributes.add("wave",{type:"json",schema:[{name:"durationS",type:"number",default:10},{name:"yPosition",type:"curve"}]}),WaterSurface.attributes.add("surface",{type:"json",schema:[{name:"material",type:"asset"},{name:"speed",type:"number"}]}),WaterSurface.attributes.add("ripple",{type:"asset",assetType:"template"}),WaterSurface.attributes.add("rippleScale",{type:"curve"}),WaterSurface.attributes.add("rippleOpacity",{type:"curve"}),WaterSurface.attributes.add("rippleSystem",{type:"entity"}),WaterSurface.prototype.initialize=function(){this._surfaceSpeed=this.surface.speed/1e3,this._waveCountdownS=this.wave.durationS,this._surfaceDiffuseMapOffset=new pc.Vec2,this._surfaceNormalMapOffset=new pc.Vec2,this.submergedVehicle=null,this._submergedVehicleTargetPos=new pc.Vec3,this._submergedVehicleTargetQuat=new pc.Quat,this._submergedVehicleLerpPos=new pc.Vec3,this._submergedVehicleSlerpQuat=new pc.Quat,this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.app.on("vehicle:player:respawn",this._clearSubmergedVehicle,this)},WaterSurface.prototype.onTriggerEnter=function(e){if(e.tags.has("player")&&e.script&&e.script.vehicle){this.submergedVehicle=e,this.rippleSystem.script.waterRipples.makeSplash(this.submergedVehicle.getPosition());let t=this.submergedVehicle.getPosition();this._submergedVehicleTargetPos.x=t.x,this._submergedVehicleTargetPos.y=this.entity.getPosition().y-1,this._submergedVehicleTargetPos.z=t.z;let s=this.submergedVehicle.getEulerAngles().y;this._submergedVehicleTargetQuat.setFromEulerAngles(0,s,0),this.submergedVehicle.rigidbody.enabled=!1,this.submergedVehicle.script.vehicle.isSubmerged=!0,this.entity.sound.play("splash")}},WaterSurface.prototype.update=function(e){if(this._updateWave(e),this._updateSurface(e),this.submergedVehicle&&this.submergedVehicle.script&&!this.app.globals.isHomeScreenOpen){let t=e/.016667;this._submergedVehicleLerpPos.lerp(this.submergedVehicle.getPosition(),this._submergedVehicleTargetPos,.1*t),this._submergedVehicleSlerpQuat.slerp(this.submergedVehicle.getRotation(),this._submergedVehicleTargetQuat,.02*t),this.submergedVehicle.rigidbody.teleport(this._submergedVehicleLerpPos,this._submergedVehicleSlerpQuat);let s=this.submergedVehicle.script.vehicle.getHealth();this.submergedVehicle.script.vehicle.dealDamage(.1*s*t)}},WaterSurface.prototype._updateWave=function(e){this._waveCountdownS-=e;let t=this._waveCountdownS/this.wave.durationS,s=this.wave.yPosition.value(t);this._submergedVehicleTargetPos.y=s-1;let i=this.entity.getPosition();this.entity.setPosition(i.x,s,i.z),this._waveCountdownS<=0&&(this._waveCountdownS=this.wave.durationS)},WaterSurface.prototype._updateSurface=function(e){this._surfaceDiffuseMapOffset.x+=this._surfaceSpeed,this._surfaceDiffuseMapOffset.y+=this._surfaceSpeed,this._surfaceNormalMapOffset.x-=this._surfaceSpeed,this._surfaceNormalMapOffset.y+=this._surfaceSpeed,this.surface.material.resource.diffuseMapOffset=this._surfaceDiffuseMapOffset,this.surface.material.resource.normalMapOffset=this._surfaceNormalMapOffset,this.surface.material.resource.update()},WaterSurface.prototype._clearSubmergedVehicle=function(){this.submergedVehicle=null,this._submergedVehicleTargetPos.set(0,0,0),this._submergedVehicleTargetQuat.set(0,0,0,1),this._submergedVehicleLerpPos.set(0,0,0),this._submergedVehicleSlerpQuat.set(0,0,0,1)};var VehicleWaypoint=pc.createScript("vehicleWaypoint");VehicleWaypoint.attributes.add("supportsSpawns",{type:"boolean",default:!0,description:"Can vehicles spawn at this waypoint? Disable if waypoint is inside intersection"}),VehicleWaypoint.attributes.add("nextWaypoint",{type:"entity",array:!0}),VehicleWaypoint.prototype.initialize=function(){};var AiDriver=pc.createScript("aiDriver");AiDriver.attributes.add("topSpeed",{type:"number",default:25}),AiDriver.attributes.add("sensorTemplate",{type:"asset",assetType:"template"}),AiDriver.prototype.initialize=function(){this._isStoppedAtIntersection=!1,this._isStoppedBehindVehicle=!1,this._postCollisionCountdownS=0,this._currentWaypoint=null,this._directionVec=new pc.Vec3,this._collisionSensorOffset=new pc.Vec3(0,.8,4),this._collisionSensor=null},AiDriver.prototype.postInitialize=function(){this._collisionSensor=this.sensorTemplate.resource.instantiate(),this.app.root.addChild(this._collisionSensor),this._collisionSensor.collision.on("triggerenter",(function(t){this.stopBehindVehicle()}),this),this._collisionSensor.collision.on("triggerleave",(function(t){this.clearLeadVehicle()}),this)},AiDriver.prototype.stopAtIntersection=function(){this._isStoppedAtIntersection=!0},AiDriver.prototype.moveIntoIntersection=function(){this._isStoppedAtIntersection=!1},AiDriver.prototype.stopBehindVehicle=function(){this._isStoppedBehindVehicle=!0},AiDriver.prototype.stopAfterCollision=function(){this._postCollisionCountdownS=10},AiDriver.prototype.clearLeadVehicle=function(){this._isStoppedBehindVehicle=!1},AiDriver.prototype.setCurrentWaypoint=function(t){this._currentWaypoint=t},AiDriver.prototype.despawn=function(){this._isStoppedBehindVehicle=!1,this._isStoppedAtIntersection=!1,this._postCollisionCountdownS=0,this._currentWaypoint=null},AiDriver.prototype.update=function(t){this._updateWaypointDistance(t),this._postCollisionCountdownS>0&&(this._postCollisionCountdownS-=t)},AiDriver.prototype._updateWaypointDistance=function(t){let i=0,e=0;if(this._currentWaypoint){if(this._currentWaypoint.getPosition().distance(this.entity.getLocalPosition())<=3){let t=this._getNextWaypoint();this.setCurrentWaypoint(t)}else if(!this.isStopped()){this.entity.script.vehicle.speed<this.topSpeed&&(e=1);let t=this._directionVec.copy(this._currentWaypoint.getPosition()).sub(this.entity.getPosition()).normalize(),o=this.entity.forward.angle(t);o<0?i=(o+180)/25:o>0&&(i=(o-180)/25)}}this.entity.script.vehicle.fire("vehicle:controls",t,i,e,0)},AiDriver.prototype._getNextWaypoint=function(){let t=this._currentWaypoint.script.vehicleWaypoint.nextWaypoint.length,i=Math.floor(pc.math.random(0,t));return this._currentWaypoint.script.vehicleWaypoint.nextWaypoint[i]},AiDriver.prototype.isStopped=function(){return this._isStoppedAtIntersection||this._isStoppedBehindVehicle||this._postCollisionCountdownS>0||!this.app.globals.isDriving},AiDriver.prototype.postUpdate=function(){if(this._collisionSensor){let t=this.entity.getPosition(),i=this.entity.getRotation().transformVector(this._collisionSensorOffset),e={x:t.x+i.x,y:t.y+i.y,z:t.z+i.z};this._collisionSensor.setPosition(e.x,e.y,e.z)}};var Intersection=pc.createScript("intersection");Intersection.prototype.initialize=function(){this._vehiclesInside=[],this._vehiclesWaiting=[],this._deadlockCountdownS=10,this.entity.collision.on("triggerenter",(function(i){this._isVehicle(i)&&(i.script&&i.script.aiDriver&&this.isOccupied()?(i.script.aiDriver.stopAtIntersection(),this._vehiclesWaiting.push(i)):this._vehiclesInside.push(i))}),this),this.entity.collision.on("triggerleave",(function(i){if(this._isVehicle(i)){for(let e=this._vehiclesInside.length-1;e>=0;--e)this._vehiclesInside[e]._guid==i._guid&&(this._vehiclesInside.splice(e,1),this._deadlockCountdownS=10);if(this._vehiclesInside.length<=0&&this._vehiclesWaiting.length>0){let i=this._vehiclesWaiting.shift();i.script.aiDriver.moveIntoIntersection(),this._vehiclesInside.push(i)}}}),this)},Intersection.prototype._isVehicle=function(i){return!(!i.script||!i.script.aiDriver)||!(!i.script||!i.script.vehicle)},Intersection.prototype.isOccupied=function(){return this._vehiclesInside.length>0},Intersection.prototype.update=function(i){(this._vehiclesInside.length>0||this._vehiclesWaiting.length>0)&&this.isOccupied()&&(this._deadlockCountdownS-=i,this._deadlockCountdownS<=0&&(this._deadlockCountdownS=10,this._purge()))},Intersection.prototype._purge=function(){for(let i in this._vehiclesInside){let e=this._vehiclesInside[i];e&&e.script.aiDriver&&(e.script.aiDriver.clearLeadVehicle(),e.script.aiDriver.moveIntoIntersection())}for(let i in this._vehiclesWaiting){let e=this._vehiclesWaiting[i];e&&e.script.aiDriver&&(e.script.aiDriver.clearLeadVehicle(),e.script.aiDriver.moveIntoIntersection())}};var UiPosition=pc.createScript("uiPosition");UiPosition.attributes.add("vehicle",{type:"entity"}),UiPosition.prototype.update=function(t){let i=this.vehicle.getPosition();this.entity.element.text=parseInt(i.x)+", "+parseInt(i.y)+", "+parseInt(i.z)};var UiGrid=pc.createScript("uiGrid");UiGrid.attributes.add("vehicle",{type:"entity"}),UiGrid.prototype.update=function(t){let e=this.vehicle.getPosition(),i=parseInt(e.x/20),r=parseInt(e.z/20);this.entity.element.text="x: "+i+", z: "+r};var UiVehicles=pc.createScript("uiVehicles");UiVehicles.attributes.add("vehicleTraffic",{type:"entity"}),UiVehicles.prototype.update=function(e){this.vehicleTraffic.script.vehicleTraffic.vehicles&&(this.entity.element.text="Vehicles: "+this.vehicleTraffic.script.vehicleTraffic.vehicles.length)};var Pedestrian=pc.createScript("pedestrian");Pedestrian.attributes.add("armature",{type:"entity"}),Pedestrian.attributes.add("walkingSpeed",{type:"number",default:.01}),Pedestrian.attributes.add("targetWaypoint",{type:"entity"}),Pedestrian.attributes.add("hand",{type:"entity",description:"hand.R or .L entity from the Armature."}),Pedestrian.prototype.initialize=function(){this.entity.isPed=!0,this.isOffMap=!1,this._collisionsEnabled=!1,this._eulerY={visible:0,target:0},this._groundY=0,this._rayCastToPos=new pc.Vec3,this._screenPos=new pc.Vec3,this._isWaitingForPlayer=!1,this._invincibilityS=0,this.targetWaypoint&&(this.moveDirection=this.targetWaypoint.getPosition()),this._handheldItem=null,this.moveDirectionOrginal=new pc.Quat,this.moveDirectionFinal=new pc.Quat,this.slerpedRotation=new pc.Quat},Pedestrian.prototype.triggerEnter=function(t){if(this._collisionsEnabled&&(this._isInMotion(t)||t.tags.has("player"))){this._flatten(t);let i=t.rigidbody.linearVelocity;if(t.script&&t.script.vehicle){let e=i.length()/3;t.script.vehicle.dealDamage(e,this.entity)}}},Pedestrian.prototype._isInMotion=function(t){let i=t.rigidbody.linearVelocity;return i.x<=-.5||i.x>=.5||i.y<=-.5||i.y>=.5||i.z<=-.5||i.z>=.5},Pedestrian.prototype.setCurrentWaypoint=function(t){this.targetWaypoint=t,this.targetWaypoint?this.moveDirection=this.targetWaypoint.getPosition():this.moveDirection=null},Pedestrian.prototype.update=function(t){if(this.targetWaypoint){if(this._getDistanceToWaypoint()<1){if(this.targetWaypoint=this.targetWaypoint.script.pedestrianWaypoint.nextWaypoint,!this.targetWaypoint)return void(this.moveDirection=null);this.moveDirection=this.targetWaypoint.getPosition()}let i=this.targetWaypoint.getPosition(),e=this.entity.getPosition(),n=i.z-e.z,s=i.x-e.x,o=Math.atan2(n,s),a=Math.cos(o)*this.walkingSpeed*(t/.01667),r=Math.sin(o)*this.walkingSpeed*(t/.01667);this.entity.translate(a,0,r),this.moveDirection&&(this.moveDirectionOrginal.copy(this.entity.getRotation()),this.entity.lookAt(this.moveDirection.x,this.entity.getPosition().y,this.moveDirection.z),this.moveDirectionFinal.copy(this.entity.getRotation()),this.entity.setRotation(this.moveDirectionOrginal),this.entity.setRotation(this.slerpedRotation.slerp(this.moveDirectionOrginal,this.moveDirectionFinal,.05)))}else if(this._isWaitingForPlayer){let t=this.entity.getPosition(),i=this.app.globals.currentVehicle.getPosition(),e=i.x-t.x,n=i.z-t.z,s=Math.atan2(e,n);this.entity.setEulerAngles(0,180+180*s/Math.PI,0),this._rayCast()}(this._collisionsEnabled||this._handheldItem)&&this._rayCast(),this._updateVisibility(),this._updateInvincibility(t)},Pedestrian.prototype._rayCast=function(){let t=this.entity.getPosition(),i=new pc.Vec3(t.x,100,t.z);this._rayCastToPos.set(t.x,-100,t.z);let e=this.app.systems.rigidbody.raycastAll(i,this._rayCastToPos,{filterTags:["ground","water"]}),n=null,s=1e3;for(let t in e){let o=i.y-e[t].point.y;(o<s||null==n)&&(s=o,this._groundY=e[t].point.y,n=e[t].entity)}if(n)if(n.tags.has("ground")){let i=this._groundY+this.entity.collision.halfExtents.y;this.entity.anim.getBoolean("isFlat")&&(i=this._groundY+.2),this.entity.setPosition(t.x,i,t.z)}else n.tags.has("water")&&!this.isWaitingForPlayer()&&(this.isOffMap=!0)},Pedestrian.prototype._getDistanceToWaypoint=function(){let t=this.entity.getPosition().x,i=this.entity.getPosition().z;const e=this.targetWaypoint.getPosition().x-t,n=this.targetWaypoint.getPosition().z-i;return Math.sqrt(e*e+n*n)},Pedestrian.prototype.enableCollisions=function(){this._collisionsEnabled=!0,this.entity.collision.on("triggerenter",this.triggerEnter,this)},Pedestrian.prototype.disableCollisions=function(){this._collisionsEnabled=!1,this.entity.collision.off("triggerenter",this.triggerEnter,this),this.entity.collision.off("collisionstart")},Pedestrian.prototype.spawn=function(){this.entity.anim.enabled=!0,this.enableCollisions(),this.entity.anim.setBoolean("isFlat",!1),this.entity.anim.findAnimationLayer("Carry").blendToWeight(0,.1)},Pedestrian.prototype.despawn=function(){this.isOffMap=!1,this._invincibilityS=0,this.entity.anim.enabled=!1,this.setCurrentWaypoint(null),this._handheldItem&&(this.hand.removeChild(this._handheldItem),this._handheldItem.destroy())},Pedestrian.prototype._flatten=function(t){this.entity.sound.slot("flatten").play(),this.entity.anim.setBoolean("isFlat",!0),this.setCurrentWaypoint(null),this.disableCollisions(),t.tags.has("player")&&this.app.fire("pedestrian:flattened"),this._rayCast();let i=this.entity.getPosition();i.y=this._groundY+.2,this.entity.setPosition(i)},Pedestrian.prototype.waitForPlayer=function(){this.disableCollisions(),this._isWaitingForPlayer=!0,this.setCurrentWaypoint(null),this.entity.anim.setBoolean("isFlat",!1),this.entity.anim.setBoolean("isWaiting",!0),this.entity.anim.findAnimationLayer("Carry").blendToWeight(0,.1)},Pedestrian.prototype.stopWaitingForPlayer=function(){this._isWaitingForPlayer=!1,this.entity.anim.setBoolean("isWaiting",!1)},Pedestrian.prototype.isWaitingForPlayer=function(){return this._isWaitingForPlayer},Pedestrian.prototype.holdItem=function(t){this.hand.addChild(t),this.app.root.removeChild(t),this._handheldItem=t,this._handheldItem.setLocalPosition(-.9,1.1,0),this._handheldItem.setLocalScale(3,3,3),this._handheldItem.setLocalEulerAngles(0,0,90),this.entity.anim.setBoolean("isWaiting",!1),this.entity.anim.findAnimationLayer("Carry").blendToWeight(1,.33)},Pedestrian.prototype.makeInvincible=function(t){this._invincibilityS=t,this.disableCollisions()},Pedestrian.prototype._updateVisibility=function(){if(this.app.globals.followCamera){this.app.globals.followCamera.camera.worldToScreen(this.entity.getPosition(),this._screenPos);let t=this.app.globals.followCamera.camera.frustum.containsPoint(this.entity.getPosition());this._screenPos.z>0&&t?this.entity.anim.enabled=!0:this.entity.anim.enabled=!1}},Pedestrian.prototype._updateInvincibility=function(t){this._invincibilityS>0&&(this._invincibilityS-=t,this._invincibilityS<=0&&this.enableCollisions())};var PedestrianWaypoint=pc.createScript("pedestrianWaypoint");PedestrianWaypoint.attributes.add("supportsSpawns",{type:"boolean",default:!0,description:"Can pedestrians spawn at this waypoint?"}),PedestrianWaypoint.attributes.add("nextWaypoint",{type:"entity"});var Outfit=pc.createScript("outfit");Outfit.attributes.add("rig",{type:"entity",description:"The parent of the Armature"}),Outfit.attributes.add("defaultMaterial",{type:"asset",assetType:"material"}),Outfit.prototype.initialize=function(){this._rig=this.entity.script.outfit.rig,this._rig.enabled=!1,this._layerWeightTargets={},this._halfExtents=new pc.Vec3(5,5,5),this._boundingBox=new pc.BoundingBox(this.entity.getPosition(),this._halfExtents),this._batch=this.app.batcher.getGroupByName("Pedestrians"),this._armature=this.entity.findByName("Armature"),this.eulerAngle=new pc.Vec3(-90,90,0),this._bones=[this._armature.findByName("head"),this._armature.findByName("neck"),this._armature.findByName("shoulder.L"),this._armature.findByName("shoulder.R"),this._armature.findByName("thigh.L"),this._armature.findByName("thigh.R"),this._armature.findByName("shin.L"),this._armature.findByName("shin.R"),this._armature.findByName("foot.L"),this._armature.findByName("foot.R")],this._setRandomOutfit()},Outfit.prototype._setRandomOutfit=function(){let t=parseInt(pc.math.random(0,4)).toString(),e=parseInt(pc.math.random(0,8)).toString(),i=[0,["head-"+e],["body-"+e],["left-arm-"+e],["right-arm-"+e],["left-thigh-"+e],["right-thigh-"+e],["left-shin-"+e],["right-shin-"+e],["foot-L-basic-"+t],["foot-R-basic-"+t]],r=parseInt(pc.math.random(0,3));if(0==r){let t=parseInt(pc.math.random(0,4)).toString();i[1].push("hat-cap-"+t)}else if(1==r){let t=parseInt(pc.math.random(0,6)).toString();i[1].push("hair-short-"+t)}0==parseInt(pc.math.random(0,8))&&i[1].push("moustache-0"),this._applyOutfitPayload(i)},Outfit.prototype._applyOutfitPayload=function(t){for(let e in this._bones)this._equipToBone(this._bones[e],t[parseInt(e)+1]);this.show()},Outfit.prototype._equipToBone=function(t,e){for(let i=t.children.length;i>0;--i)this._shouldBeDestroyed(t.children[i-1],e)&&t.children[i-1].destroy();for(let i in e){if(this._alreadyEquipped(t,e[i]))continue;let r=new pc.Entity;r.name=e[i],r.addComponent("render",{type:"asset",asset:this.app.assets.find(e[i],"render"),materialAssets:[this.defaultMaterial],batchGroupId:this._batch.id,customAabb:this._boundingBox}),t.addChild(r)}},Outfit.prototype._shouldBeDestroyed=function(t,e){if(!t.render)return!1;for(let i in e)if(e[i]==t.name)return!1;return!0},Outfit.prototype._alreadyEquipped=function(t,e){for(let i in t.children)if(t.children[i].name==e)return!0;return!1},Outfit.prototype.update=function(t){let e=Object.entries(this._layerWeightTargets);if(!(e.length<=0))for(let t=e.length;t>0;t--){let i=e[t-1][0],r=e[t-1][1],a=.18*(r.target-r.current);this._rig.anim.findAnimationLayer(i).weight+=a,this._layerWeightTargets[i].current=this._rig.anim.findAnimationLayer(i).weight,Math.abs(this._layerWeightTargets[i].target-this._layerWeightTargets[i].current)<=.01&&delete this._layerWeightTargets[i]}},Outfit.prototype.setLayerWeight=function(t,e){this._layerWeightTargets[t]={current:this._rig.anim.findAnimationLayer(t).weight,target:e}},Outfit.prototype.show=function(){this.rig.enabled=!0},Outfit.prototype.hide=function(){this.rig.enabled=!1};var UiPedestrians=pc.createScript("uiPedestrians");UiPedestrians.attributes.add("pedestrianTraffic",{type:"entity"}),UiPedestrians.prototype.update=function(e){this.pedestrianTraffic.script.pedestrianTraffic.peds&&(this.entity.element.text="Pedestrians: "+this.pedestrianTraffic.script.pedestrianTraffic.peds.length)};var RenderCameraTomap=pc.createScript("renderCameraTomap");RenderCameraTomap.attributes.add("renderElement",{type:"entity",description:"Element to render the texture to"}),RenderCameraTomap.attributes.add("renderResolution",{type:"vec2",description:"Resolution to render at"}),RenderCameraTomap.attributes.add("useWindowSize",{type:"boolean",default:!1,description:"Render output matches browser window dimensions"}),RenderCameraTomap.attributes.add("renderOnce",{type:"boolean",description:"Renders the first frame only"}),RenderCameraTomap.prototype.initialize=function(){this.createNewRenderTexture(),this.renderOnceFrameCount=0,this.app.graphicsDevice.on("resizecanvas",this.createNewRenderTexture,this),this.on("destroy",(function(){this.assignTextureToElements(null),this.renderTarget.destroy(),this.texture.destroy()}),this)},RenderCameraTomap.prototype.update=function(e){this.renderOnce&&(this.renderOnceFrameCount+=1,this.renderOnceFrameCount>4&&(this.entity.enabled=!1))},RenderCameraTomap.prototype.createNewRenderTexture=function(){var e=this.app.graphicsDevice;if(this.texture&&this.renderTarget){var t=this.renderTarget,r=this.texture;this.renderTarget=null,this.texture=null,t.destroy(),r.destroy()}let n=this.renderResolution.x,i=this.renderResolution.y;this.useWindowSize&&(n=window.innerWidth,i=window.innerHeight);var a=new pc.Texture(e,{width:n,height:i,format:pc.PIXELFORMAT_RGB8,mipmaps:!0,minFilter:pc.FILTER_LINEAR,magFilter:pc.FILTER_LINEAR,addressU:pc.ADDRESS_CLAMP_TO_EDGE,addressV:pc.ADDRESS_CLAMP_TO_EDGE}),s=new pc.RenderTarget(e,a,{depth:!0,flipY:!0,samples:2});this.entity.camera.renderTarget=s,this.texture=a,this.renderTarget=s,this.assignTextureToElements(this.texture)},RenderCameraTomap.prototype.assignTextureToElements=function(e){this.renderElement.element.texture=e};var WaterRipples=pc.createScript("waterRipples");WaterRipples.attributes.add("ripple",{type:"asset",assetType:"template"}),WaterRipples.attributes.add("rippleScale",{type:"curve"}),WaterRipples.attributes.add("rippleOpacity",{type:"curve"}),WaterRipples.attributes.add("container",{type:"entity"}),WaterRipples.attributes.add("waterSurface",{type:"entity"}),WaterRipples.prototype.initialize=function(){this.dippingEntity=null,this._waterRipples=[],this._nextRippleId=0,this._timeSUntilNextRipple=0,this._spawnStartingRipples(),this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerleave,this)},WaterRipples.prototype._spawnStartingRipples=function(){for(let e=0;e<12;e++){let e=this.ripple.resource.instantiate();e.lifeRemainingS=0,e.enabled=!1,e.render.meshInstances[0].setParameter("material_opacity",.9999),this.container.addChild(e),this._waterRipples.push(e)}},WaterRipples.prototype.onTriggerEnter=function(e){this.dippingEntity=e},WaterRipples.prototype.onTriggerleave=function(e){this.dippingEntity&&e._guid==this.dippingEntity._guid&&(this.dippingEntity=null)},WaterRipples.prototype.update=function(e){this._spawnNewRipples(e),this._updateRipples(e)},WaterRipples.prototype._spawnNewRipples=function(e){this._timeSUntilNextRipple-=e;let t=this.waterSurface.script.waterSurface.submergedVehicle;t&&this._timeSUntilNextRipple<=0&&(this._loadNewRipple(t.getPosition()),this._timeSUntilNextRipple=2),this.dippingEntity&&this._timeSUntilNextRipple<=0&&(this._loadNewRipple(this.dippingEntity.getPosition(),{scale:.7,totalLifeS:.8}),this._timeSUntilNextRipple=.1)},WaterRipples.prototype._loadNewRipple=function(e,t=null){let i=this._waterRipples[this._nextRippleId];i.lifeRemainingS>0||(i.totalLifeS=4,t&&(i.totalLifeS=t.totalLifeS),i.lifeRemainingS=i.totalLifeS,i.lifeRemainingS<=.5&&(i.lifeRemainingS=.5),i.setLocalScale(1,1,1),i.enabled=!0,i.setPosition(e),i.render.meshInstances[0].setParameter("material_opacity",.001),i.config=t,this._nextRippleId+=1,this._nextRippleId>=this._waterRipples.length&&(this._nextRippleId=0))},WaterRipples.prototype._updateRipples=function(e){for(let t in this._waterRipples){let i=this._waterRipples[t];if(i.enabled){i.lifeRemainingS-=e;let p=i.getPosition(),l=this.entity.parent.getPosition().y;i.setPosition(p.x,l-.003*(t+1),p.z);let a=1-i.lifeRemainingS/i.totalLifeS,n=this.rippleScale.value(a);i.config&&(n*=i.config.scale),i.setLocalScale(n,n,n);let s=this.rippleOpacity.value(a);i.render.meshInstances[0].setParameter("material_opacity",s),i.lifeRemainingS<=0&&(i.enabled=!1)}}},WaterRipples.prototype.makeSplash=function(e){this._loadNewRipple(e,{scale:1.5,totalLifeS:7})};var VehicleSound=pc.createScript("vehicleSound");VehicleSound.attributes.add("basePitch",{type:"number",default:.5}),VehicleSound.attributes.add("damagedEngineWave",{type:"curve"}),VehicleSound.prototype.initialize=function(){this._damagedEngineCycleS=0,this.damagedEngineCycleTimeS=pc.math.random(1,5),this._skidState=0},VehicleSound.prototype.update=function(e){this._updateEngineLevel(e),this._updateSkid(e)},VehicleSound.prototype._updateEngineLevel=function(e){if(this.entity.script.gearBox.gear>0){let t=this.entity.script.gearBox.getSoundPitch();if(this.entity.script.vehicle.engineDamageFactor<=.25){this._damagedEngineCycleS-=e,this._damagedEngineCycleS<0&&(this.damagedEngineCycleTimeS=pc.math.random(1,5),this._damagedEngineCycleS=this.damagedEngineCycleTimeS);let i=this._damagedEngineCycleS/this.damagedEngineCycleTimeS,s=this.damagedEngineWave.value(i);this.entity.sound.slot("engine").pitch=s+t/3}else this.entity.sound.slot("engine").pitch=this.basePitch+t;this.entity.sound.slot("reverse").isPaused||this.entity.sound.slot("reverse").pause()}else if(-1==this.entity.script.gearBox.gear)if(this.entity.script.vehicle.speed<-1){let e=Math.abs(this.entity.script.vehicle.speed)/100;this.entity.sound.slot("reverse").pitch=this.basePitch+e,this.entity.sound.slot("reverse").isPlaying||this.entity.sound.slot("reverse").play()}else this.entity.sound.slot("reverse").isPaused||this.entity.sound.slot("reverse").pause()},VehicleSound.prototype._updateSkid=function(e){let t=(this.entity.script.vehicle.ammoVehicle.getWheelInfo(2).m_skidInfo+this.entity.script.vehicle.ammoVehicle.getWheelInfo(3).m_skidInfo)/2;this._skidState=t,this._skidState>0&&this._skidState<1?(this.entity.sound.slot("skid").isPlaying||this.entity.sound.slot("skid").play(),this.entity.sound.slot("skid").volume=.2*(1-this._skidState)):this.entity.sound.slot("skid").isStopped||this.entity.sound.slot("skid").stop()};var DestructibleEntity=pc.createScript("destructibleEntity");DestructibleEntity.prototype.initialize=function(){this._startingPosition=this.entity.getPosition().clone(),this._startingQuat=this.entity.getRotation().clone(),this._startingLinearFactor=this.entity.rigidbody.linearFactor.clone(),this._startingAngularFactor=this.entity.rigidbody.angularFactor.clone(),this._pauseCountdownS=3,this._postCollisionAngularFactor=new pc.Vec3(.5,.5,.5),this.entity.rigidbody.type=pc.RIGIDBODY_TYPE_STATIC},DestructibleEntity.prototype.trigger=function(){this.entity.rigidbody.type=pc.RIGIDBODY_TYPE_DYNAMIC,this.entity.rigidbody.linearFactor=pc.Vec3.ONE,this.entity.rigidbody.angularFactor=this._postCollisionAngularFactor,this._pauseCountdownS=3},DestructibleEntity.prototype.update=function(t){this.entity.rigidbody.type==pc.RIGIDBODY_TYPE_DYNAMIC&&(this._isInMotion(this.entity)?this._pauseCountdownS=3:(this._pauseCountdownS-=t,this._pauseCountdownS<=0&&this.pause()))},DestructibleEntity.prototype._isInMotion=function(t){let i=t.rigidbody.linearVelocity;return i.x<=-.1||i.x>=.1||i.y<=-.1||i.y>=.1||i.z<=-.1||i.z>=.1},DestructibleEntity.prototype.pause=function(){this.entity.rigidbody.type=pc.RIGIDBODY_TYPE_STATIC},DestructibleEntity.prototype.reset=function(){this.entity.rigidbody.type=pc.RIGIDBODY_TYPE_STATIC,this.entity.rigidbody.linearFactor=this._startingLinearFactor,this.entity.rigidbody.angularFactor=this._startingAngularFactor,this.entity.rigidbody.teleport(this._startingPosition,this._startingQuat),this.entity.rigidbody.enabled=!0,this.entity.collision.enabled=!0,this._pauseCountdownS=3};var DestructibleEntitySystem=pc.createScript("destructibleEntitySystem");DestructibleEntitySystem.attributes.add("mapGrid",{type:"entity"}),DestructibleEntitySystem.prototype.initialize=function(){this._entities=[],this._loadedChunks=[],this._needToPlaceEntitiesInGrid=!0,this.app.on("map:chunk:load",this._loadChunk,this),this.app.on("map:chunk:preload",this._loadChunk,this)},DestructibleEntitySystem.prototype._loadChunk=function(t){if(-1==this._loadedChunks.indexOf(t.name)){let i=t.script.mapChunk.buildings;for(let t in i.children)this._addToDestructibles(i.children[t]);this._needToPlaceEntitiesInGrid=!0,this._loadedChunks.push(t.name)}},DestructibleEntitySystem.prototype._addToDestructibles=function(t){if(t.script&&t.script.destructibleEntity&&this._entities.push(t),t.children.length>0)for(let i in t.children)this._addToDestructibles(t.children[i])},DestructibleEntitySystem.prototype.update=function(t){this._needToPlaceEntitiesInGrid&&this._placeEntitiesInGrid(),this._removeOutOfViewDestructibles()},DestructibleEntitySystem.prototype._placeEntitiesInGrid=function(){for(let t in this._entities){let i=this._entities[t],e=this.mapGrid.script.mapGrid.getGridPosition(i),s=this.mapGrid.script.mapGrid.gridCells[e.x][e.z];s.destructibleEntities||(s.destructibleEntities=[]),s.destructibleEntities.push(i)}this._needToPlaceEntitiesInGrid=!1},DestructibleEntitySystem.prototype._removeOutOfViewDestructibles=function(){for(let t in this.mapGrid.script.mapGrid.newlyClosedGridCells){let i=this.mapGrid.script.mapGrid.newlyClosedGridCells[t];for(let t in i.destructibleEntities){i.destructibleEntities[t].script.destructibleEntity.reset()}}};var DestructibleActivationZone=pc.createScript("destructibleActivationZone");DestructibleActivationZone.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},DestructibleActivationZone.prototype.onTriggerEnter=function(t){(t.tags.has("player")||t.rigidbody&&t.rigidbody.type==pc.RIGIDBODY_TYPE_DYNAMIC)&&this._trigger()},DestructibleActivationZone.prototype._trigger=function(){if(this.entity.parent.script.destructibleEntity)this.entity.parent.script.destructibleEntity.trigger();else if(this.entity.parent.script.destructibleGroup){let t=this.entity.parent.script.destructibleGroup.dependants;for(let i in t)t[i].script.destructibleEntity.trigger()}};var Globals=pc.createScript("globals");Globals.prototype.initialize=function(){this.app.globals={isDriving:!1,firstInputGiven:!1,isTutorialRunning:!1,isHomeScreenOpen:!1,isTouchPortrait:!1,isAdPlaying:!1,currentJob:null,currentVehicle:null,restorePosition:new pc.Vec3,restoreRotation:new pc.Quat,followCamera:this.app.root.findByName("Follow Camera"),currentMapChunk:null,proximityMapChunk:null}};var ShaderCompilationCamera=pc.createScript("shaderCompilationCamera");ShaderCompilationCamera.prototype.initialize=function(){this._isWaitingForFirstFrame=!0},ShaderCompilationCamera.prototype.update=function(i){this._isWaitingForFirstFrame&&(this._isWaitingForFirstFrame=!1,this.entity.enabled=!1)};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[u]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[u]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),A<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,u=void 0,c=void 0,d=c=void 0,f=p=u=void 0;f=void 0;0===(c=.5>=l?l*(1+i):l+i-l*i)?e="#000":(u=(c-(d=2*l-c))/c,f=(e*=6)-(p=Math.floor(e)),f*=c*u,0===p||6===p?(p=c,u=d+f,c=d):1===p?(p=c-f,u=c,c=d):2===p?(p=d,u=c,c=d+f):3===p?(p=d,u=c-f):4===p?(p=d+f,u=d):(p=c,u=d,c-=f),e="#"+N(p)+N(u)+N(c)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,P=0,A=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){P=n()},v.tick=function(){l=n(),E+=(l-A-E)/O.smoothing,v.fps=1e3/E,v.duration=P<A?E:l-P,A=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,c)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var u="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var c=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var FPSCounter=pc.createScript("fpsCounter");FPSCounter.prototype.initialize=function(){this.meter=new FPSMeter({theme:"transparent",heat:!0,left:"auto",right:"5px",top:"auto",bottom:"5px",zIndex:-1e3})},FPSCounter.prototype.update=function(t){this.meter.tick()};var RenderQuality=pc.createScript("renderQuality");RenderQuality.attributes.add("fpsMeter",{type:"entity"}),RenderQuality.attributes.add("fpsSampleInterval",{type:"number",default:.05}),RenderQuality.attributes.add("qualityUpdateInterval",{type:"number",default:1}),RenderQuality.attributes.add("maxFpsSamples",{type:"number",default:100}),RenderQuality.attributes.add("camera",{type:"entity"}),RenderQuality.attributes.add("shadowLight",{type:"entity"}),RenderQuality.attributes.add("pedestrianTraffic",{type:"entity"}),RenderQuality.attributes.add("vehicleTraffic",{type:"entity"}),RenderQuality.prototype.initialize=function(){this._shadowFadeCountdownS=0,this._shadowFadeDirection="in",this._timeSUntilNextFPSSample=this.fpsSampleInterval,this._fpsSamples=[],this._timeSUntilNextQualityUpdate=this.qualityUpdateInterval,this._device=pc.Application.getApplication().graphicsDevice,this._device.maxPixelRatio=1,this._minPixelRatio=.75,pc.platform.mobile&&(this._minPixelRatio=1),this.app.on("job:start",this._updateSimulationDensity,this)},RenderQuality.prototype._updateSimulationDensity=function(){let t=this._getAvgFPS();t>=58&&(this.pedestrianTraffic.script.pedestrianTraffic.increasePedDensity(3),this.vehicleTraffic.script.vehicleTraffic.increaseVehicleDensity(3))},RenderQuality.prototype._mustEnableShadows=function(){return!1},RenderQuality.prototype._mustDisableShadows=function(){return!1},RenderQuality.prototype._getAvgFPS=function(){let t=0;for(let e in this._fpsSamples)t+=this._fpsSamples[e];return t/this._fpsSamples.length},RenderQuality.prototype.update=function(t){this._updateFpsSamples(t),this._updateQuality(t),this._updateShadowFade(t)},RenderQuality.prototype._updateFpsSamples=function(t){this._timeSUntilNextFPSSample-=t,this._timeSUntilNextFPSSample<=0&&(this._takeFPSSample(),this._timeSUntilNextFPSSample=this.fpsSampleInterval)},RenderQuality.prototype._takeFPSSample=function(){let t=this.fpsMeter.script.fpsCounter.meter.fps;this._fpsSamples.push(t),this._fpsSamples.length>this.maxFpsSamples&&this._fpsSamples.shift()},RenderQuality.prototype._updateQuality=function(t){if(this._timeSUntilNextQualityUpdate-=t,this._timeSUntilNextQualityUpdate<=0){let t=this._getAvgFPS();this._updateShadowMode(t),this._updatePixelRatio(t),this._timeSUntilNextQualityUpdate=this.qualityUpdateInterval}},RenderQuality.prototype._updateShadowMode=function(t){t<30&&this._device.maxPixelRatio<=this._minPixelRatio&&"out"!=this._shadowFadeDirection?(this.shadowLight.light.shadowUpdateMode=pc.SHADOWUPDATE_NONE,this._shadowFadeCountdownS=3,this._shadowFadeDirection="out"):t>58&&this._device.maxPixelRatio>=1.25&&"in"!=this._shadowFadeDirection&&(this.shadowLight.light.shadowUpdateMode=pc.SHADOWUPDATE_REALTIME,this._shadowFadeCountdownS=3,this._shadowFadeDirection="in")},RenderQuality.prototype._updatePixelRatio=function(t){t<30&&this._device.maxPixelRatio>this._minPixelRatio?this._device.maxPixelRatio-=.1:t>=58&&this._device.maxPixelRatio<1.25&&(this._device.maxPixelRatio+=.1)},RenderQuality.prototype._updateShadowFade=function(t){if(this._shadowFadeCountdownS>0){this._shadowFadeCountdownS-=t;let e=this._shadowFadeCountdownS/3;"in"==this._shadowFadeDirection&&(e=1-e),this.shadowLight.light.shadowIntensity=.66*e}};var CameraSystem=pc.createScript("cameraSystem");CameraSystem.attributes.add("followCamera",{type:"entity"}),CameraSystem.attributes.add("miniMapCamera",{type:"entity"}),CameraSystem.attributes.add("jobsMapCamera",{type:"entity"}),CameraSystem.attributes.add("showroomCamera",{type:"entity"}),CameraSystem.attributes.add("homeScreenCamera",{type:"entity"}),CameraSystem.prototype.postInitialize=function(){this.followCamera.enabled=!1,this.app.on("ui:home:show",this._switchToHome,this),this.app.on("ui:home:hide",this._switchToDriving,this),this.app.on("ui:home:page:show",this._switchToHome,this),this.app.on("vehicle:player:ready",this._followVehicle,this)},CameraSystem.prototype._switchToHome=function(){this.followCamera.enabled=!0,this.miniMapCamera.enabled=!1,this.jobsMapCamera.enabled=!1,this.showroomCamera.enabled=!1,this.homeScreenCamera.enabled=!0},CameraSystem.prototype._switchToDriving=function(){this.followCamera.enabled=!0,this.miniMapCamera.enabled=!0,this.jobsMapCamera.enabled=!1,this.showroomCamera.enabled=!1,this.homeScreenCamera.enabled=!1},CameraSystem.prototype._followVehicle=function(e){this._switchToDriving(),this.followCamera.script.followCamera.setTarget(e)},CameraSystem.prototype.update=function(e){this.app.globals.isHomeScreenOpen&&!this.homeScreenCamera.enabled&&(this.homeScreenCamera.enabled=!0)};var DirectionArrow=pc.createScript("directionArrow");DirectionArrow.attributes.add("scaleMultiplier",{type:"number",default:1}),DirectionArrow.attributes.add("idleScaleCurve",{type:"curve"}),DirectionArrow.attributes.add("idleScaleTimeS",{type:"number",default:1}),DirectionArrow.attributes.add("vanishScaleCurve",{type:"curve"}),DirectionArrow.attributes.add("vanishScaleTimeS",{type:"number",default:.2}),DirectionArrow.attributes.add("invisibleWorld",{type:"boolean",default:!1,description:"This arrow is not rendered in the game world. Used when showing this arrow on the minimap"}),DirectionArrow.prototype.initialize=function(){this._isVanishing=!1,this._vanishScaleCountdownTimerS=0,this._idleScaleCountdownTimerS=pc.math.random(0,this.idleScaleTimeS),this._timeSUntilNextDistanceCheck=pc.math.random(0,.5),this.invisibleWorld&&(this.entity.render.enabled=!1)},DirectionArrow.prototype.vanish=function(){this.entity.fire("vanish"),this._isVanishing=!0,this._vanishScaleCountdownTimerS=this.vanishScaleTimeS},DirectionArrow.prototype.update=function(i){if(this._idleScaleCountdownTimerS-=i,this._timeSUntilNextDistanceCheck-=i,this._idleScaleCountdownTimerS<=0&&(this._idleScaleCountdownTimerS=this.idleScaleTimeS),this._isVanishing&&this._vanishScaleCountdownTimerS>0){this._vanishScaleCountdownTimerS-=i,this._vanishScaleCountdownTimerS<=0&&this.entity.render.enabled?(this.entity.render.enabled=!1,this._vanishScaleCountdownTimerS=this.vanishScaleTimeS):this._vanishScaleCountdownTimerS<=0&&!this.entity.render.enabled&&(this.entity.enabled=!1);let e=this._vanishScaleCountdownTimerS/this.vanishScaleTimeS,t=this.vanishScaleCurve.value(e)*this.scaleMultiplier;this.entity.setLocalScale(t,t,t)}else{let i=this._idleScaleCountdownTimerS/this.idleScaleTimeS,e=this.idleScaleCurve.value(i)*this.scaleMultiplier;this.entity.setLocalScale(e,e,e)}if(this._timeSUntilNextDistanceCheck<=0&&this.app.globals.currentVehicle&&!this._isVanishing){this._timeSUntilNextDistanceCheck=.2,this.app.globals.currentVehicle.getPosition().distance(this.entity.getPosition())<=6&&this.vanish()}};var DeliveryTarget=pc.createScript("deliveryTarget");DeliveryTarget.attributes.add("customerArrow",{type:"entity"}),DeliveryTarget.attributes.add("hostWaypoint",{type:"entity",description:"NPC waypoint this targets is a child of"}),DeliveryTarget.attributes.add("playerCamera",{type:"entity"}),DeliveryTarget.attributes.add("deliverButton",{type:"entity"}),DeliveryTarget.attributes.add("pedestrianSystem",{type:"entity"}),DeliveryTarget.attributes.add("pizzaBoxTemplate",{type:"asset",assetType:"template"}),DeliveryTarget.prototype.initialize=function(){this._isActive=!1,this._deliveryCompleted=!1,this.deliverButton.enabled=!1,this.customerArrow.enabled=!1,this._customer=null,this._pizzaBox=null,this._pizzaBoxVelocity=new pc.Vec3},DeliveryTarget.prototype.activate=function(t){this._isActive=!0,this.customerArrow.enabled=!0,this._deliveryCompleted=!1,this.hostWaypoint=t,this.entity.setLocalPosition(this.hostWaypoint.getPosition()),this.customerArrow.setPosition(this.hostWaypoint.getPosition()),this._customer=this.pedestrianSystem.script.pedestrianTraffic.getCustomer(),this._customer?(this._customer.setPosition(this.hostWaypoint.getPosition()),this.customerArrow.script.customerArrow.setTrackingCustomer(this._customer),this._customer.script.pedestrian.waitForPlayer(this.app.globals.currentVehicle)):console.error("We are out of pedestrians!"),this.app.fire("delivery:target:activate",this.entity),this.app.on("job:failed",this._unstageDelivery,this),this.app.on("job:time:up",this._unstageDelivery,this),this.entity.on("vehicle:enter",this._stageDelivery,this),this.entity.on("vehicle:exit",this._unstageDelivery,this)},DeliveryTarget.prototype.deactivate=function(){this._customer&&(this._customer.script.pedestrian.stopWaitingForPlayer(),this._customer.script.pedestrian.setCurrentWaypoint(this.hostWaypoint.script.pedestrianWaypoint.nextWaypoint),this._customer=null),this.app.fire("delivery:target:deactivate",this.entity),this._isActive=!1,this.hostWaypoint=null,this.customerArrow.enabled=!1,this.entity.off("vehicle:enter"),this.entity.off("vehicle:exit")},DeliveryTarget.prototype._stageDelivery=function(){this.app.globals.currentJob.isTimeUp||(this.deliverButton.enabled=!0,this.deliverButton.button.on("click",this._throwPizza,this),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._onKeyDown,this),this.app.isUsingTouch?(this.deliverButton.findByName("Touch Animation").enabled=!0,this.deliverButton.findByName("Key Icon").enabled=!1):(this.deliverButton.findByName("Touch Animation").enabled=!1,this.deliverButton.findByName("Key Icon").enabled=!0))},DeliveryTarget.prototype._unstageDelivery=function(){this.deliverButton.enabled=!1,this.deliverButton.button.off("click",this._throwPizza,this),this.app.keyboard.off(pc.EVENT_KEYDOWN,this._onKeyDown,this)},DeliveryTarget.prototype._throwPizza=function(){if(this._pizzaBox)return;this._unstageDelivery(),this._pizzaBox=this.pizzaBoxTemplate.resource.instantiate(),this._pizzaBox.setPosition(this.app.globals.currentVehicle.getPosition()),this.app.root.addChild(this._pizzaBox);let t=this._customer.getPosition(),e=this.app.globals.currentVehicle.getPosition();this._pizzaBoxVelocity.sub2(t,e).divScalar(20),this.app.globals.currentJob&&(this.app.globals.currentJob.isPizzaFlying=!0)},DeliveryTarget.prototype._onKeyDown=function(t){t.key!=pc.KEY_SPACE&&t.key!=pc.KEY_ENTER||this._throwPizza()},DeliveryTarget.prototype.update=function(t){let e=t/(1/60);this._pizzaBox&&!this._deliveryCompleted&&(this._pizzaBox.translate(this._pizzaBoxVelocity.x*e,this._pizzaBoxVelocity.y*e,this._pizzaBoxVelocity.z*e),this._pizzaBox.rotate(0,5*e,0),this._pizzaBox.getPosition().distance(this._customer.getPosition())<1&&this._completeDelivery())},DeliveryTarget.prototype._completeDelivery=function(){this.app.globals.currentJob&&(this.app.globals.currentJob.isPizzaFlying=!1),this._customer.script.pedestrian.holdItem(this._pizzaBox),this._customer.script.pedestrian.makeInvincible(20),this._pizzaBox=null,this._pizzaBoxVelocity.set(pc.Vec3.ZERO),this.app.fire("job:progress",this.entity),this._deliveryCompleted=!0,this.deactivate()};var DeliveryGame=pc.createScript("deliveryGame");DeliveryGame.attributes.add("homeScreen",{type:"entity"}),DeliveryGame.attributes.add("homeScreenVehicleMarker",{type:"entity"}),DeliveryGame.attributes.add("highwaySystem",{type:"entity"}),DeliveryGame.attributes.add("followCamera",{type:"entity"}),DeliveryGame.attributes.add("homeScreenCamera",{type:"entity"}),DeliveryGame.attributes.add("tutorial",{type:"entity"}),DeliveryGame.attributes.add("autoStartTutorial",{type:"boolean",default:!0}),DeliveryGame.attributes.add("spawnPoint",{type:"entity"}),DeliveryGame.attributes.add("trafficSystem",{type:"entity"}),DeliveryGame.attributes.add("inGameHUD",{type:"entity"}),DeliveryGame.attributes.add("homeButton",{type:"entity"}),DeliveryGame.attributes.add("jobsButton",{type:"entity"}),DeliveryGame.attributes.add("respawnButton",{type:"entity"}),DeliveryGame.attributes.add("repairButton",{type:"entity"}),DeliveryGame.attributes.add("regionsButton",{type:"entity"}),DeliveryGame.attributes.add("boostButton",{type:"entity"}),DeliveryGame.attributes.add("playerJobMapIcon",{type:"entity"}),DeliveryGame.attributes.add("chunkTriggers",{type:"entity"}),DeliveryGame.prototype.initialize=function(){this.homeButton.button.on("click",this._pauseDrivingSimulation,this),this.regionsButton.button.on("click",this._openRegionsPage,this),this.jobsButton.button.on("click",this._openJobsPage,this),this.respawnButton.button.on("click",this._respawn,this),this.app.on("highway:enter",this._enterHighway,this),this.app.on("ui:home:show",this._hideHudButtons,this),this.app.on("highway:exit",this._resumeDrivingSimulation,this),this.repairButton.button.on("click",this._openGarage,this),this.homeScreen.on("drive",this._resumeDrivingSimulation,this),this.app.on("job:roam",this._resumeDrivingSimulation,this),this.app.on("job:start",this._resumeDrivingSimulation,this),this.app.on("job:resume",this._resumeDrivingSimulation,this),this.app.on("vehicle:player:spawn",this._spawnVehicle,this),this.app.on("vehicle:player:stuck",this._offerRespawn,this),this.app.on("vehicle:player:repair",this._hideRepairButton,this),this.app.on("vehicle:player:ready",this._startTutorialOrRoam,this),this.app.on("vehicle:player:drowned",this._offerRespawn,this),this.app.on("vehicle:player:unstuck",this._hideRespawnButton,this),this.app.on("vehicle:player:wrecked",this._showRepairButton,this),this.app.on("poki:rewardedBreak:start",this._respondToRewardedBreak,this),this._showHomeScreen(),this._homeScreenVehiclePosition=new pc.Vec3,this._wasOutofFocus=!1,this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForESC,this)},DeliveryGame.prototype._startTutorialOrRoam=function(){this.autoStartTutorial&&!this.tutorial.script.deliveryGameTutorial.isComplete()?(this.tutorial.script.deliveryGameTutorial.start(),this.autoStartTutorial=!1):(this.tutorial.script.deliveryGameTutorial.endTutorial(),this.app.fire("job:roam")),document.hasFocus()||(this._wasOutofFocus=!0,this._pauseDrivingSimulation(),this.homeScreenCamera.enabled=!0)},DeliveryGame.prototype._showHomeScreen=function(){this.homeScreen.enabled=!0,this.homeScreen.script.homeScreen.show(),this.inGameHUD.script.gameHud.hide()},DeliveryGame.prototype._hideHomeScreen=function(){this.homeScreen.script.homeScreen.hide(),this.homeScreen.enabled=!1,this.inGameHUD.script.gameHud.show()},DeliveryGame.prototype._offerRespawn=function(){this.repairButton.enabled&&this._hideRepairButton(),this.app.fire("poki:gameplayStop"),this.respawnButton.enabled=!0,this.app.keyboard.on(pc.EVENT_KEYDOWN,this._bindRespawnKeys,this)},DeliveryGame.prototype._hideRespawnButton=function(){if(this.respawnButton.enabled=!1,this.app.globals.currentVehicle){this.app.globals.currentVehicle.script.vehicle.health<=.1&&this._showRepairButton()}this.app.keyboard.off(pc.EVENT_KEYDOWN,this._bindRespawnKeys,this)},DeliveryGame.prototype._bindRespawnKeys=function(e){e.key!=pc.KEY_ENTER&&e.key!=pc.KEY_SPACE||this._respawn()},DeliveryGame.prototype._hideHudButtons=function(){this._hideRespawnButton(),this._hideRepairButton()},DeliveryGame.prototype._showRepairButton=function(){this.respawnButton.enabled||(this.repairButton.enabled=!0)},DeliveryGame.prototype._hideRepairButton=function(){this.repairButton.enabled=!1},DeliveryGame.prototype._spawnVehicle=function(e){this.app.globals.currentVehicle&&(this.app.fire("vehicle:player:despawn",this.app.globals.currentVehicle),this.app.root.removeChild(this.app.globals.currentVehicle),this.app.globals.currentVehicle.destroy());let t=e.template.resource.instantiate();t.vehicleName=e.name,this.app.root.addChild(t),this.app.globals.currentVehicle=t,this.app.globals.isDriving=!0,this._homeVehicleStartRotation=this.spawnPoint.getRotation().clone(),this._homeVehicleStartPosition=this.spawnPoint.getPosition().clone(),this.app.globals.restorePosition=this._homeVehicleStartPosition,this.app.globals.restoreRotation=this._homeVehicleStartRotation,this._beginDrivingSimulation(),this.app.fire("vehicle:player:ready",this.app.globals.currentVehicle)},DeliveryGame.prototype._respawn=function(){this.app.fire("poki:gameplayStart",function(){this._stopVehicle(),this._beginDrivingSimulation(),this._hideRespawnButton(),this.app.fire("vehicle:player:respawn")}.bind(this))},DeliveryGame.prototype._enterHighway=function(e){this._pauseDrivingSimulation();let t=this.homeScreen.findByName("Pages").findByName("Highway Page");this.homeScreen.script.homeScreen.showPage(t);let i=e.script.highwayEntrance.exit;this.app.globals.restorePosition=i.getPosition().clone(),this.app.globals.restoreRotation=i.getRotation().clone()},DeliveryGame.prototype._openGarage=function(){this._pauseDrivingSimulation();let e=this.homeScreen.findByName("Pages").findByName("Garage Page");this.homeScreen.script.homeScreen.showPage(e)},DeliveryGame.prototype._openRegionsPage=function(){this._pauseDrivingSimulation();let e=this.homeScreen.findByName("Pages").findByName("Regions Page");this.homeScreen.script.homeScreen.showPage(e)},DeliveryGame.prototype._openJobsPage=function(){this._pauseDrivingSimulation();let e=this.homeScreen.findByName("Pages").findByName("Jobs Page");this.homeScreen.script.homeScreen.showPage(e)},DeliveryGame.prototype._stopVehicle=function(){this.app.globals.currentVehicle.rigidbody.linearVelocity=pc.Vec3.ZERO,this.app.globals.currentVehicle.rigidbody.angularVelocity=pc.Vec3.ZERO,this.app.globals.currentVehicle.script.vehicle.fire("vehicle:controls",0,0,0,0)},DeliveryGame.prototype._disableDrivingSimulation=function(){this._stopVehicle(),this.app.globals.isDriving=!1,this.app.globals.restorePosition=null,this.app.globals.restoreRotation=null},DeliveryGame.prototype._pauseDrivingSimulation=function(){this._showHomeScreen(),this._stopVehicle(),this.app.globals.isDriving=!1,this.app.globals.restorePosition=this.app.globals.currentVehicle.getPosition().clone(),this.app.globals.restoreRotation=this.app.globals.currentVehicle.getRotation().clone();let e=this.app.vehicles[this._getCurrentVehicleId()].displayPosition;this._homeScreenVehiclePosition.add2(this.homeScreenVehicleMarker.getPosition(),e),this.app.globals.currentVehicle.rigidbody.teleport(this._homeScreenVehiclePosition,this.homeScreenVehicleMarker.getRotation());let t=this.app.audioSettings.getSFXVolume();this.app.globals.currentVehicle.sound.volume=.5*t,this.followCamera.script.followCamera.target=null,this.app.fire("poki:gameplayStop")},DeliveryGame.prototype._getCurrentVehicleId=function(){if(this.app.globals.currentVehicle)for(let e in this.app.vehicles)if(this.app.globals.currentVehicle.vehicleName==this.app.vehicles[e].name)return parseInt(e);return 0},DeliveryGame.prototype._resumeDrivingSimulation=function(){this.app.globals.isDriving||this.app.fire("poki:gameplayStart",function(){this._hideHomeScreen(),this.app.globals.isDriving=!0,null!=this.app.globals.restorePosition&&null!=this.app.globals.restoreRotation&&this.app.globals.currentVehicle.rigidbody.teleport(this.app.globals.restorePosition,this.app.globals.restoreRotation);let e=this.app.audioSettings.getSFXVolume();this.app.globals.currentVehicle.sound.volume=1*e,this._wasOutofFocus?(this.followCamera.script.followCamera.setImmediateTarget(this.app.globals.currentVehicle),this._wasOutofFocus=!1):this.followCamera.script.followCamera.setTarget(this.app.globals.currentVehicle),this.app.globals.currentVehicle.script.vehicle.fire("vehicle:controls",0,0,0,0),this._setHealth(),this._setBoost()}.bind(this))},DeliveryGame.prototype._beginDrivingSimulation=function(){this._hideHomeScreen(),this.app.globals.isDriving=!0,this.app.globals.currentVehicle.script.vehicle.isSubmerged=!1,this.app.globals.currentVehicle.script.vehicle.updateSmokeColor(),this.app.globals.currentVehicle.rigidbody.enabled=!0,this.app.globals.currentVehicle.rigidbody.teleport(this._homeVehicleStartPosition,this._homeVehicleStartRotation),this.app.globals.currentVehicle.setPosition(this._homeVehicleStartPosition),this.app.globals.currentVehicle.sound.volume=1,this.followCamera.script.followCamera.setTarget(this.app.globals.currentVehicle),this._setHealth(),this._setBoost()},DeliveryGame.prototype._setHealth=function(){let e=0;const t=this.app.globals.currentVehicle.vehicleName;this.app.playerStats.vehicles[t]&&(e=this.app.playerStats.vehicles[t].health),this.app.globals.currentVehicle.script.vehicle.setHealth(e),e<=.1&&this._showRepairButton()},DeliveryGame.prototype._setBoost=function(){let e=0;const t=this.app.globals.currentVehicle.vehicleName;this.app.playerStats.vehicles[t]&&(e=this.app.playerStats.vehicles[t].boostTime),this.app.globals.currentVehicle.script.vehicle.setBoostTime(e),e>0?(this.boostButton.enabled=!0,this.boostButton.script.uiBoostButton.show()):(this.boostButton.enabled=!1,this.boostButton.script.uiBoostButton.hide())},DeliveryGame.prototype._listenForESC=function(e){e.key!=pc.KEY_ESCAPE||this.homeScreen.enabled||this._pauseDrivingSimulation()},DeliveryGame.prototype._respondToRewardedBreak=function(){this.app.globals.isDriving&&this._stopVehicle()},DeliveryGame.prototype.update=function(e){this._updateProximityMapChunk()},DeliveryGame.prototype._updateProximityMapChunk=function(){if(this.app.globals.isDriving&&this.app.globals.currentVehicle){let e=null,t=this.app.globals.currentVehicle.getPosition();for(let i in this.chunkTriggers.children){let o=this.chunkTriggers.children[i],s=o.script.mapChunkTrigger.loadChunk;s.script.mapChunk.isLocked()&&(s.name!=this.app.globals.currentMapChunk.name&&o.script.mapChunkTrigger.boundingBox.containsPoint(t)&&(e=o.script.mapChunkTrigger.loadChunk))}null!=e&&null==this.app.globals.proximityMapChunk?(this.regionsButton.enabled=!0,this.regionsButton.script.uiRegionsButton.setMapChunk(e),this.regionsButton.script.uiRegionsButton.slideIn(),this.app.globals.proximityMapChunk=e):null==e&&null!=this.app.globals.proximityMapChunk&&(this.regionsButton.script.uiRegionsButton.slideOut(),this.app.globals.proximityMapChunk=null)}};var CustomerArrow=pc.createScript("customerArrow");CustomerArrow.attributes.add("positionYCurve",{type:"curve"}),CustomerArrow.attributes.add("bobTimeS",{type:"number",default:1}),CustomerArrow.prototype.initialize=function(){this._bobCountdownS=this.bobTimeS,this._trackingCustomer=null},CustomerArrow.prototype.setTrackingCustomer=function(t){this._trackingCustomer=t},CustomerArrow.prototype.update=function(t){if(this._trackingCustomer){this._bobCountdownS-=t;let o=this._bobCountdownS/this.bobTimeS,i=this.positionYCurve.value(o),r=this._trackingCustomer.getPosition(),e=r.y+i+1;this.entity.setPosition(r.x,e,r.z),this._bobCountdownS<=0&&(this._bobCountdownS=this.bobTimeS),this.entity.rotateLocal(0,.5,0)}};var DeliveryHome=pc.createScript("deliveryHome");DeliveryHome.prototype.initialize=function(){this.entity.on("vehicle:enter",this._enterHome,this)},DeliveryHome.prototype._enterHome=function(){this.entity.fire("home:enter")};var JuicyForm=pc.createScript("juicyForm");JuicyForm.attributes.add("formCover",{type:"entity"}),JuicyForm.attributes.add("formContent",{type:"entity"}),JuicyForm.attributes.add("formScale",{type:"curve",curves:["x","y"]}),JuicyForm.prototype.initialize=function(){this._scaleDirection=1,this._SCALE_TIME_S=.33,this._scaleCountdownS=this._SCALE_TIME_S,this._callback=null},JuicyForm.prototype.hide=function(t=null){this._scaleDirection=-1,this._scaleCountdownS=this._SCALE_TIME_S,this._callback=t},JuicyForm.prototype.instaHide=function(){this._scaleDirection=-1,this._scaleCountdownS=0,this.formCover.enabled=!1,this.formContent.enabled=!1},JuicyForm.prototype.show=function(t=null){this._scaleDirection=1,this.formCover.enabled=!0,this.formContent.enabled=!0,this._scaleCountdownS=this._SCALE_TIME_S,this._callback=t,this.update(0)},JuicyForm.prototype.update=function(t){if(this._scaleCountdownS>0){let i=1;this._scaleDirection>0?i=1-this._scaleCountdownS/this._SCALE_TIME_S:this._scaleDirection<0&&(i=this._scaleCountdownS/this._SCALE_TIME_S);let e=this.formScale.value(i);this.formCover.element.opacity=.9*i,this.formContent.setLocalScale(e[0],e[1],1),this._scaleCountdownS-=t,this._scaleCountdownS<=0&&(this._scaleDirection<0&&(this.formCover.enabled=!1,this.formContent.enabled=!1),this._scaleDirection=0,this._scaleCountdownS=0,this._callback&&this._callback())}};var DeliveryGameTutorial=pc.createScript("deliveryGameTutorial");DeliveryGameTutorial.attributes.add("firstJob",{type:"json",schema:[{name:"waypoints",type:"entity",array:!0},{name:"navArrows",type:"entity"}]}),DeliveryGameTutorial.attributes.add("secondJob",{type:"json",schema:[{name:"waypoints",type:"entity",array:!0},{name:"navArrows",type:"entity"}]}),DeliveryGameTutorial.attributes.add("thirdJob",{type:"json",schema:[{name:"waypoints",type:"entity",array:!0},{name:"navArrows",type:"entity"}]}),DeliveryGameTutorial.attributes.add("guideArrow",{type:"entity"}),DeliveryGameTutorial.attributes.add("gameHud",{type:"entity"}),DeliveryGameTutorial.attributes.add("jobSystem",{type:"entity"}),DeliveryGameTutorial.attributes.add("backButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("homeButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("homeScreen",{type:"entity"}),DeliveryGameTutorial.attributes.add("driveButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("regionsButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("downtownButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("takeJobButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("garageButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("jobsButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("skillsButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("jobSizeUpgradeButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("regionUnlockButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("carBuyButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("arrowInputAnimation",{type:"entity"}),DeliveryGameTutorial.attributes.add("shiftInputAnimation",{type:"entity"}),DeliveryGameTutorial.attributes.add("touchAnimation",{type:"entity"}),DeliveryGameTutorial.attributes.add("forwardTouchInput",{type:"entity"}),DeliveryGameTutorial.attributes.add("rightTouchInput",{type:"entity"}),DeliveryGameTutorial.attributes.add("garagePage",{type:"entity"}),DeliveryGameTutorial.attributes.add("garageNextButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("garagePrevButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("garageDriveButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("statsButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("settingsButton",{type:"entity"}),DeliveryGameTutorial.attributes.add("miniMapArrows",{type:"entity"}),DeliveryGameTutorial.attributes.add("tutorialCompleteNotification",{type:"entity"}),DeliveryGameTutorial.prototype.initialize=function(){this._progress={firstJobComplete:!1,secondJobComplete:!1,thirdJobComplete:!1,regionUnlocked:!1,jobSizeUpgraded:!1,carPurchased:!1,keyboardInputDetected:!1,shiftKeyDetected:!1,touchTutorialCompleted:!1,tutorialCompleted:!1},this.app.on("ui:touch:enable",this._showTouchTutorial,this)},DeliveryGameTutorial.prototype._showTouchTutorial=function(){this.arrowInputAnimation.enabled=!1,this.shiftInputAnimation.enabled=!1,this._progress.touchTutorialCompleted||this._showTouchAnimationOn(this.forwardTouchInput)},DeliveryGameTutorial.prototype.isComplete=function(){return this._progress.tutorialCompleted||this.app.playerStats.tutorialCompleted},DeliveryGameTutorial.prototype.start=function(){this.app.globals.isTutorialRunning=!0,this.app.regions.Downtown.isUnlocked=!1,this.app.playerStats.skills.jobSize=1,delete this.app.playerStats.vehicles["Dasher Turbo"],this.app.playerStats.regions.Downtown.isUnlocked=!1,this.app.globals.currentJob={id:0,numPizzas:1,region:"Downtown",waypoints:this.firstJob.waypoints,hasTimeLimit:!1,perPizzaBonus:5,expiresInS:0,startingTimeS:parseInt(pc.math.random(10,30)),tip:parseInt(pc.math.random(5,10))},this.firstJob.navArrows.enabled=!0,this.guideArrow.enabled=!0,this.guideArrow.findByName("Arrow Render").script.pulsingElement.enabled=!0,this.miniMapArrows.script.miniMapArrows.add(this.firstJob.navArrows.children),this.app.isUsingTouch?this._showTouchAnimationOn(this.forwardTouchInput):this.arrowInputAnimation.enabled=!0,this.regionsButton.script.pageButton.lock(),this.jobsButton.script.pageButton.lock(),this.skillsButton.script.pageButton.lock(),this.garageButton.script.pageButton.lock(),this.gameHud.script.gameHud.hideJobsButton(),this.app.on("highway:enter",this._highwayEntered,this),this.app.on("ui:home:show",this._homeButtonClick,this),this.homeScreen.on("drive",this._driveButtonClick,this),this.app.fire("tutorial:start",this.app.globals.currentJob),this.app.on("job:complete",this._respondToJobComplete,this),this.app.keyboard.on("keydown",this._respondToKeydown,this),this.app.on("vehicle:player:spawn",this._respondToSpawn,this),this.jobsButton.button.on("click",this._jobsButtonClick,this),this.backButton.button.on("click",this._backButtonClick,this),this.homeButton.button.on("click",this._homeButtonClick,this),this.garagePage.on("showroom:show",this._showroomBrowsed,this),this.driveButton.button.on("click",this._driveButtonClick,this),this.statsButton.button.on("click",this._statsButtonClick,this),this.carBuyButton.button.on("click",this._carBuyButtonClick,this),this.garageButton.button.on("click",this._garageButtonClick,this),this.skillsButton.button.on("click",this._skillsButtonClick,this),this.regionsButton.button.on("click",this._regionButtonClick,this),this.takeJobButton.button.on("click",this._takeJobButtonClick,this),this.downtownButton.button.on("click",this._downtownButtonClick,this),this.settingsButton.button.on("click",this._settingsButtonClick,this),this.garageNextButton.button.on("click",this._garageNextButtonClick,this),this.garagePrevButton.button.on("click",this._garagePrevButtonClick,this),this.regionUnlockButton.button.on("click",this._regionUnlockButtonClick,this),this.rightTouchInput.button.on("pressedstart",this._rightTouchInputGiven,this),this.jobSizeUpgradeButton.button.on("click",this._jobSizeUpgradeButtonClick,this),this.forwardTouchInput.button.on("pressedstart",this._forwardTouchInputGiven,this)},DeliveryGameTutorial.prototype.endTutorial=function(){this.app.globals.isTutorialRunning=!1,this.touchAnimation.enabled=!1,this.takeJobButton.button.active=!0,this.miniMapArrows.script.miniMapArrows.clear(),this.regionsButton.script.pageButton.unlock(),this.jobsButton.script.pageButton.unlock(),this.skillsButton.script.pageButton.unlock(),this.garageButton.script.pageButton.unlock(),this.app.off("highway:enter",this._highwayEntered,this),this.app.off("ui:home:show",this._homeButtonClick,this),this.homeScreen.off("drive",this._driveButtonClick,this),this.app.off("job:complete",this._respondToJobComplete,this),this.app.keyboard.off("keydown",this._respondToKeydown,this),this.app.off("vehicle:player:spawn",this._respondToSpawn,this),this.jobsButton.button.off("click",this._jobsButtonClick,this),this.backButton.button.off("click",this._backButtonClick,this),this.homeButton.button.off("click",this._homeButtonClick,this),this.garagePage.off("showroom:show",this._showroomBrowsed,this),this.driveButton.button.off("click",this._driveButtonClick,this),this.statsButton.button.off("click",this._statsButtonClick,this),this.carBuyButton.button.off("click",this._carBuyButtonClick,this),this.garageButton.button.off("click",this._garageButtonClick,this),this.skillsButton.button.off("click",this._skillsButtonClick,this),this.regionsButton.button.off("click",this._regionButtonClick,this),this.takeJobButton.button.off("click",this._takeJobButtonClick,this),this.downtownButton.button.off("click",this._downtownButtonClick,this),this.settingsButton.button.off("click",this._settingsButtonClick,this),this.regionUnlockButton.button.off("click",this._regionUnlockButtonClick,this),this.rightTouchInput.button.off("pressedstart",this._rightTouchInputGiven,this),this.jobSizeUpgradeButton.button.off("click",this._jobSizeUpgradeButtonClick,this),this.forwardTouchInput.button.off("pressedstart",this._forwardTouchInputGiven,this)},DeliveryGameTutorial.prototype._highwayEntered=function(){this._showTouchAnimationOn(this.backButton)},DeliveryGameTutorial.prototype._showTouchAnimationOn=function(t){this.touchAnimation.enabled=!0,this.touchAnimation.parent.removeChild(this.touchAnimation),t.addChild(this.touchAnimation);let i=this.touchAnimation.parent.getLocalEulerAngles();i.mulScalar(-1),this.touchAnimation.setLocalEulerAngles(i)},DeliveryGameTutorial.prototype._forwardTouchInputGiven=function(){this._progress.touchTutorialCompleted||this._showTouchAnimationOn(this.rightTouchInput)},DeliveryGameTutorial.prototype._rightTouchInputGiven=function(){this._progress.touchTutorialCompleted||(this.touchAnimation.enabled=!1,this._progress.touchTutorialCompleted=!0,this.app.off("ui:touch:enable",this._showTouchTutorial,this))},DeliveryGameTutorial.prototype._respondToJobComplete=function(){this._progress.firstJobComplete?this._progress.firstJobComplete&&!this._progress.secondJobComplete?this._completeSecondJob():this._progress.firstJobComplete&&this._progress.secondJobComplete&&!this._progress.thirdJobComplete&&this._completeThirdJob():this._completeFirstJob()},DeliveryGameTutorial.prototype._completeFirstJob=function(){this.shiftInputAnimation.enabled&&(this._progress.shiftKeyDetected=!0,this.shiftInputAnimation.enabled=!1),this._progress.firstJobComplete=!0,this.firstJob.navArrows.enabled=!1,this._showTouchAnimationOn(this.homeButton)},DeliveryGameTutorial.prototype._driveButtonClick=function(){this.app.isUsingTouch||(this._progress.keyboardInputDetected?this._progress.shiftKeyDetected||(this.shiftInputAnimation.enabled=!0):this.arrowInputAnimation.enabled=!0),this._hasActiveJob()||this._promptForHomeButtonClick()},DeliveryGameTutorial.prototype._promptForHomeButtonClick=function(){(this._progress.firstJobComplete&&!this._progress.regionUnlocked||!this._progress.secondJobComplete&&this._progress.regionUnlocked||this._progress.secondJobComplete&&!this._progress.jobSizeUpgraded||this._progress.secondJobComplete&&!this._progress.thirdJobComplete||this._progress.thirdJobComplete&&!this._progress.carPurchased)&&(this.homeButton.script.shakyElement.play(),this._showTouchAnimationOn(this.homeButton))},DeliveryGameTutorial.prototype._homeButtonClick=function(){this.arrowInputAnimation.enabled=!1,this.shiftInputAnimation.enabled=!1,this.homeButton.script.shakyElement.stop(),this._hasActiveJob()?this._showTouchAnimationOn(this.driveButton):this._progress.firstJobComplete&&!this._progress.regionUnlocked?(this.regionsButton.script.pageButton.unlock(),this._showTouchAnimationOn(this.regionsButton)):!this._progress.secondJobComplete&&this._progress.regionUnlocked?this._showTouchAnimationOn(this.jobsButton):this._progress.secondJobComplete&&!this._progress.jobSizeUpgraded?(this.skillsButton.script.pageButton.unlock(),this._showTouchAnimationOn(this.skillsButton)):this._progress.secondJobComplete&&!this._progress.thirdJobComplete?this._showTouchAnimationOn(this.jobsButton):this._progress.thirdJobComplete&&!this._progress.carPurchased&&(this.garageButton.script.pageButton.unlock(),this._showTouchAnimationOn(this.garageButton))},DeliveryGameTutorial.prototype._regionButtonClick=function(){this._progress.regionUnlocked?this._showTouchAnimationOn(this.backButton):this._showTouchAnimationOn(this.downtownButton)},DeliveryGameTutorial.prototype._downtownButtonClick=function(){this._progress.regionUnlocked?this._showTouchAnimationOn(this.backButton):this._showTouchAnimationOn(this.regionUnlockButton)},DeliveryGameTutorial.prototype._regionUnlockButtonClick=function(){this._progress.regionUnlocked||(this._progress.regionUnlocked=!0,this._showTouchAnimationOn(this.backButton),this.jobSystem.script.deliveryGameJobSystem.addJob({id:0,numPizzas:1,urgencyLevel:0,region:"Downtown",waypoints:this.secondJob.waypoints,hasTimeLimit:!1,perPizzaBonus:5,expiresInS:0,startingTimeS:parseInt(pc.math.random(10,30)),tip:parseInt(pc.math.random(10,20)),uiRow:null}))},DeliveryGameTutorial.prototype._backButtonClick=function(){this._hasActiveJob()?this._showTouchAnimationOn(this.driveButton):this._progress.regionUnlocked?this._progress.secondJobComplete&&!this._progress.jobSizeUpgraded?(this.jobsButton.script.pageButton.unlock(),this._showTouchAnimationOn(this.skillsButton)):this._progress.secondJobComplete&&this._progress.thirdJobComplete?this._progress.jobSizeUpgraded?this._progress.carPurchased||this._showTouchAnimationOn(this.garageButton):this._showTouchAnimationOn(this.skillsButton):(this.jobsButton.script.pageButton.unlock(),this._showTouchAnimationOn(this.jobsButton)):this._showTouchAnimationOn(this.regionsButton)},DeliveryGameTutorial.prototype._jobsButtonClick=function(){let t=this.jobSystem.script.deliveryGameJobSystem.getNumAvailableJobs();this.takeJobButton.button.active=!(t<=0),this._progress.secondJobComplete&&!this._progress.jobSizeUpgraded||!(t>0)||this._progress.secondJobComplete&&this._progress.thirdJobComplete?this._showTouchAnimationOn(this.backButton):this._showTouchAnimationOn(this.takeJobButton)},DeliveryGameTutorial.prototype._takeJobButtonClick=function(){this._progress.secondJobComplete?this._progress.thirdJobComplete||(this.thirdJob.navArrows.enabled=!0,this.guideArrow.enabled=!0,this.guideArrow.findByName("Arrow Render").script.pulsingElement.enabled=!1,this.miniMapArrows.script.miniMapArrows.add(this.thirdJob.navArrows.children)):(this.secondJob.navArrows.enabled=!0,this.guideArrow.enabled=!0,this.guideArrow.findByName("Arrow Render").script.pulsingElement.enabled=!0,this.miniMapArrows.script.miniMapArrows.add(this.secondJob.navArrows.children))},DeliveryGameTutorial.prototype._completeSecondJob=function(){this._progress.secondJobComplete=!0,this.secondJob.navArrows.enabled=!1,this._showTouchAnimationOn(this.homeButton)},DeliveryGameTutorial.prototype._skillsButtonClick=function(){this._progress.jobSizeUpgraded?this._showTouchAnimationOn(this.backButton):this._showTouchAnimationOn(this.jobSizeUpgradeButton)},DeliveryGameTutorial.prototype._jobSizeUpgradeButtonClick=function(){this._progress.jobSizeUpgraded||(this._progress.jobSizeUpgraded=!0,this._showTouchAnimationOn(this.backButton),this.jobSystem.script.deliveryGameJobSystem.addJob({id:0,numPizzas:2,urgencyLevel:0,region:"Downtown",waypoints:this.thirdJob.waypoints,hasTimeLimit:!1,perPizzaBonus:5,expiresInS:0,startingTimeS:parseInt(pc.math.random(10,30)),tip:parseInt(pc.math.random(20,40)),uiRow:null}))},DeliveryGameTutorial.prototype._completeThirdJob=function(){this._progress.thirdJobComplete=!0,this.thirdJob.navArrows.enabled=!1,this._showTouchAnimationOn(this.homeButton),this.app.isVehicleOwned("Bruno")&&this._completeTutorial()},DeliveryGameTutorial.prototype._garageButtonClick=function(){this.garagePage.script.vehicleShowroom.setViewingVehicleId(1),this.garagePage.script.vehicleShowroom._showVehicle(1),this._showTouchAnimationOn(this.carBuyButton)},DeliveryGameTutorial.prototype._showroomBrowsed=function(t){this.app.isVehicleOwned(t.name)?(this.garageDriveButton.enabled=!1,this._showTouchAnimationOn(this.garageNextButton)):this.app.playerStats.coins>=t.price?this._showTouchAnimationOn(this.carBuyButton):(this.garageDriveButton.enabled=!1,this._showTouchAnimationOn(this.garageNextButton))},DeliveryGameTutorial.prototype._carBuyButtonClick=function(){this._progress.carPurchased=!0},DeliveryGameTutorial.prototype._respondToSpawn=function(){this._progress.carPurchased&&this._completeTutorial()},DeliveryGameTutorial.prototype._completeTutorial=function(){this.gameHud.script.gameHud.showJobsButton(),this._progress.tutorialCompleted=!0,this.tutorialCompleteNotification.enabled=!0,this.app.fire("tutorial:complete"),this.endTutorial()},DeliveryGameTutorial.prototype._respondToKeydown=function(t){t.key!=pc.KEY_W&&t.key!=pc.KEY_UP||!this.arrowInputAnimation.enabled?t.key==pc.KEY_SHIFT&&this.shiftInputAnimation.enabled?(this.shiftInputAnimation.enabled=!1,this._progress.shiftKeyDetected=!0):t.key==pc.KEY_ESCAPE&&this._backButtonClick():(this.arrowInputAnimation.enabled=!1,this._progress.keyboardInputDetected=!0,this.shiftInputAnimation.enabled=!0)},DeliveryGameTutorial.prototype._statsButtonClick=function(){this._showTouchAnimationOn(this.backButton)},DeliveryGameTutorial.prototype._settingsButtonClick=function(){this._showTouchAnimationOn(this.backButton)},DeliveryGameTutorial.prototype._hasActiveJob=function(){return this.app.globals.currentJob&&this.app.globals.currentJob.numDeliveriesRemaining>0};var DeliveryMap=pc.createScript("deliveryMap");DeliveryMap.attributes.add("regionName",{type:"entity"}),DeliveryMap.attributes.add("spawnPoint",{type:"entity"}),DeliveryMap.attributes.add("mapIconContainer",{type:"entity"}),DeliveryMap.attributes.add("miniMapCamera",{type:"entity"}),DeliveryMap.attributes.add("jobMapCamera",{type:"entity"}),DeliveryMap.attributes.add("currentVehicleIcon",{type:"entity"}),DeliveryMap.attributes.add("jobMapPizzaIcons",{type:"entity"}),DeliveryMap.attributes.add("jobMapHighwayIcons",{type:"entity"}),DeliveryMap.attributes.add("miniMapNearestHighwayIcon",{type:"entity"}),DeliveryMap.attributes.add("menuMapContainer",{type:"entity"}),DeliveryMap.attributes.add("deliveryIconTemplate",{type:"asset",assetType:"template"}),DeliveryMap.prototype.initialize=function(){this._activeIcons=[],this._containerWidth=this.mapIconContainer.element.width,this._containerHeight=this.mapIconContainer.element.height,this._jobMapCameraTargetPos=new pc.Vec3,this._minimapRatio=0,this._iconSize={min:16,max:40},this._highwayMinimapTarget={icon:this.miniMapNearestHighwayIcon,target:null,screenPos:new pc.Vec3,distanceFactor:0},this.app.on("delivery:target:activate",this._addPizzaMarker,this),this.app.on("delivery:target:deactivate",this._removeMapMakers,this),this.app.on("job:progress",this._removeJobMapMarker,this),this.app.on("job:restart",this._resetJobMapPizzaIcons,this),this.app.on("job:complete",this._resetJobMapPizzaIcons,this),this.app.on("job:failed",this._resetJobMapPizzaIcons,this),this.app.on("job:preview",this._showDeliveries,this),this.app.on("stats:loaded",this._updateHighwayMarkers,this),this.app.on("region:unlock",this._updateHighwayMarkers,this),this.app.on("map:chunk:load",this._updateHighwayMarkers,this)},DeliveryMap.prototype._addPizzaMarker=function(e){let i=this.deliveryIconTemplate.resource.instantiate();this.mapIconContainer.addChild(i),i.enabled=!0;let t={icon:i,target:e,screenPos:new pc.Vec3,distanceFactor:0};this._activeIcons.push(t)},DeliveryMap.prototype._removeMapMakers=function(e){this._removeMiniMapMarker(e)},DeliveryMap.prototype._removeMiniMapMarker=function(e){for(let i=this._activeIcons.length-1;i>=0;--i)this._activeIcons[i].target._guid==e._guid&&(this.mapIconContainer.removeChild(this._activeIcons[i].icon),this._activeIcons[i].icon.destroy(),this._activeIcons.splice(i,1))},DeliveryMap.prototype._removeJobMapMarker=function(e){if(e.script.deliveryTarget.hostWaypoint){let i=e.script.deliveryTarget.hostWaypoint._guid;for(let e in this.jobMapPizzaIcons.children){let t=this.jobMapPizzaIcons.children[e];if(t._trackingGuid==i)return t._trackingGuid="",t._deliveryCompleted=!0,void(t.enabled=!1)}}else console.error("Cannot remove job map marker, host waypoint is null")},DeliveryMap.prototype.update=function(e){let i=window.devicePixelRatio,t=this.app.graphicsDevice.maxPixelRatio;this._minimapRatio=i,t<i&&(this._minimapRatio=t);for(let e in this._activeIcons)this._setIconTargetPosition(this._activeIcons[e]);this._setIconTargetPosition(this._highwayMinimapTarget);let a=this.jobMapCamera.getPosition();a.equals(this._jobMapCameraTargetPos)||(a.lerp(a,this._jobMapCameraTargetPos,.1),this.jobMapCamera.setPosition(a),this.jobMapCamera.enabled=!0)},DeliveryMap.prototype._setIconTargetPosition=function(e){if(!e.icon.enabled)return;this._setIconSize(e);let i=e.target.getPosition();i.y-=1050,this.miniMapCamera.camera.worldToScreen(i,e.screenPos),e.screenPos.x*=this._minimapRatio,e.screenPos.y*=this._minimapRatio;let t=this._containerWidth-this._containerWidth*(.5*e.distanceFactor),a=this._containerWidth*(.25*e.distanceFactor),n=e.screenPos.x/this.app.graphicsDevice.width*t,o=e.screenPos.y/this.app.graphicsDevice.height*this._containerHeight;n+=a,o-=.5*e.icon.element.height,n<0&&o>0&&(n=this._containerWidth),n<e.icon.element.width/2?n=e.icon.element.width/2:n>this._containerWidth&&(n=this._containerWidth),o>0?o=0:o<-this._containerHeight+e.icon.element.height/2&&(o=-this._containerHeight+e.icon.element.height/2),e.screenPos.z<=0&&(o=-this._containerHeight+e.icon.element.height/2),e.icon.setLocalPosition(n,o,0)},DeliveryMap.prototype._setIconSize=function(e){let i=e.target.getPosition(),t=this.app.globals.currentVehicle.getPosition(),a=this._iconSize.min;if(e.distanceFactor=1-t.distance(i)/100,e.distanceFactor>1)a=this._iconSize.max;else if(e.distanceFactor<0)a=this._iconSize.min;else{let i=this._iconSize.max-this._iconSize.min;a=this._iconSize.min+i*e.distanceFactor}e.icon.element.width=a,e.icon.element.height=a},DeliveryMap.prototype._showDeliveries=function(e){for(let e in this.jobMapPizzaIcons.children)this.jobMapPizzaIcons.children[e].enabled=!1;let i={xMin:0,xMax:0,zMin:0,zMax:0};this._setVehicleIconPosition(i),this._amendBoundsByPos(i,this.app.globals.restorePosition);for(let t in e.waypoints){let a=e.waypoints[t],n=a.getPosition(),o=this.jobMapPizzaIcons.children[t];o._trackingGuid=a._guid,n.y=-1052,o.setPosition(n),o._deliveryCompleted?o.enabled=!1:o.enabled=!0,this._amendBoundsByPos(i,n)}let t=320,a=i.xMax-i.xMin,n=i.zMax-i.zMin;a>t&&(t=a),n>t&&(t=n),t-=1e3;let o=i.xMin+(i.xMax-i.xMin)/2,s=i.zMin+(i.zMax-i.zMin)/2;this._jobMapCameraTargetPos.set(o,t,s),this.regionName.element.text=e.region},DeliveryMap.prototype._resetJobMapPizzaIcons=function(){for(let e in this.jobMapPizzaIcons.children){let i=this.jobMapPizzaIcons.children[e];i._deliveryCompleted=!1,i._trackingGuid="",i.enabled=!1}},DeliveryMap.prototype._setVehicleIconPosition=function(e){this.currentVehicleIcon.enabled=!0;let i=this.app.globals.restorePosition;this.currentVehicleIcon.setPosition(i.x,-1052,i.z),this.currentVehicleIcon.setRotation(this.app.globals.restoreRotation)},DeliveryMap.prototype._amendBoundsByPos=function(e,i){(0==e.xMin||i.x<e.xMin)&&(e.xMin=i.x),(0==e.xMax||i.x>e.xMax)&&(e.xMax=i.x),(0==e.zMin||i.z<e.zMin)&&(e.zMin=i.z),(0==e.zMax||i.z>e.zMax)&&(e.zMax=i.z)},DeliveryMap.prototype._hasActiveJob=function(){return this.app.globals.currentJob&&this.app.globals.currentJob.numDeliveriesRemaining>0&&!this.app.globals.currentJob.hasFailed},DeliveryMap.prototype._updateHighwayMarkers=function(){let e=0;for(const[i,t]of Object.entries(this.app.playerStats.regions))t.isUnlocked&&(e+=1);if(e<=1)this.miniMapNearestHighwayIcon.enabled=!1,this.jobMapHighwayIcons.enabled=!1;else if(this.app.globals.currentMapChunk){let e=this.app.globals.currentMapChunk.script.mapChunk.highwayEntrance;this._highwayMinimapTarget.target=e,this.miniMapNearestHighwayIcon.enabled=!0,this.jobMapHighwayIcons.enabled=!0;for(const[e,i]of Object.entries(this.app.playerStats.regions))i.isUnlocked?this.jobMapHighwayIcons.findByName(e).enabled=!0:this.jobMapHighwayIcons.findByName(e).enabled=!1}},DeliveryMap.prototype.hideIcons=function(){this.menuMapContainer.enabled=!1},DeliveryMap.prototype.showIcons=function(){this.menuMapContainer.enabled=!0};var JuicyButton=pc.createScript("juicyButton");JuicyButton.attributes.add("juicyAnimationTimeS",{type:"number",default:.4}),JuicyButton.attributes.add("buttonPressScaleCurve",{type:"curve",default:{keys:[0,1,.5,1,.75,1.025,1,1],type:pc.CURVE_SPLINE}}),JuicyButton.attributes.add("buttonPressRotationCurve",{type:"curve",default:{keys:[0,0,.33,1.1,.66,-1.1,1,0],type:pc.CURVE_SPLINE}}),JuicyButton.attributes.add("textEntity",{type:"entity"}),JuicyButton.attributes.add("actionText",{type:"string"}),JuicyButton.attributes.add("staticText",{type:"boolean",default:!1}),JuicyButton.attributes.add("continuous",{type:"boolean",default:!1}),JuicyButton.attributes.add("autoPlay",{type:"boolean",default:!1}),JuicyButton.prototype.initialize=function(){this._animCountdownS=0,this._startingText="",this._eulerZStart=this.entity.getEulerAngles().z,this.textEntity&&(this._startingText=this.textEntity.element.text),this.entity.button&&(this.entity.button.on("click",this._click,this),this.on("destroy",(function(){this.entity.button.off("click",this._click,this)}),this)),this.autoPlay&&this.jiggle()},JuicyButton.prototype._click=function(){this.app.fire("ui:click"),this.jiggle()},JuicyButton.prototype.jiggle=function(){this._animCountdownS=this.juicyAnimationTimeS,this.textEntity&&!this.staticText&&this.actionText.length>0&&(this.textEntity.element.text=this.actionText)},JuicyButton.prototype.jiggleFrom=function(t){this._animCountdownS=this.juicyAnimationTimeS*t,this.textEntity&&!this.staticText&&this.actionText.length>0&&(this.textEntity.element.text=this.actionText)},JuicyButton.prototype.stop=function(){this._animCountdownS=0},JuicyButton.prototype.update=function(t){if(this._animCountdownS>0){this._animCountdownS-=t;let i=this._animCountdownS/this.juicyAnimationTimeS,e=this.buttonPressScaleCurve.value(i);this.entity.setLocalScale(e,e,e);let n=this.buttonPressRotationCurve.value(i);this.entity.setEulerAngles(0,0,this._eulerZStart+n),this.textEntity&&!this.staticText&&this._animCountdownS<=0&&(this.textEntity.element.text=this._startingText),this._animCountdownS<=0&&this.continuous&&(this._animCountdownS=this.juicyAnimationTimeS)}};var DeliveryGameJobSystem=pc.createScript("deliveryGameJobSystem");DeliveryGameJobSystem.attributes.add("mapChunks",{type:"entity",array:!0}),DeliveryGameJobSystem.attributes.add("deliveryHome",{type:"entity"}),DeliveryGameJobSystem.attributes.add("deliveryTargetContainer",{type:"entity"}),DeliveryGameJobSystem.attributes.add("deliveryTargets",{type:"entity",array:!0}),DeliveryGameJobSystem.attributes.add("jobUIContainer",{type:"entity"}),DeliveryGameJobSystem.attributes.add("jobUIRow",{type:"asset",assetType:"template"}),DeliveryGameJobSystem.attributes.add("regionData",{type:"entity"}),DeliveryGameJobSystem.prototype.initialize=function(){this._jobIdGenerator=0,this._targetNumJobs=24,this._availableJobs=[],this._jobUpdateCountdownTimerS=.5,this._numNewJobsSinceLastMenuOpen=0,this._pastCompletedJobs=[],this._JOB_STREAK_LENGTH=3,this._previewingJob=null,this._jobStartPosition=new pc.Vec3,this._jobStartRotation=new pc.Quat,this.app.on("tutorial:start",this._takeJob,this),this.app.on("job:take",this._takePreviewingJob,this),this.app.on("job:failed",this._resetCurrentJob,this),this.app.on("job:cancel",this._cancelCurrentJob,this),this.app.on("job:restart",this._restartCurrentJob,this),this.app.on("job:progress",this._updateJobProgress,this),this.app.on("region:unlock",this._regenerateJobList,this),this.app.on("job:ui:row:click",this._previewJobUIRow,this),this.app.on("skills:upgrade",this._regenerateJobList,this),this.app.on("vehicle:player:spawn",this._loadDowntown,this),this.app.on("vehicle:player:respawn",this._loadDowntown,this)},DeliveryGameJobSystem.prototype.getNumAvailableJobs=function(){return this._availableJobs.length},DeliveryGameJobSystem.prototype._previewJobUIRow=function(e){this._showJobPreview(e.name)},DeliveryGameJobSystem.prototype._generateJobs=function(){if(!this.app.globals.isTutorialRunning){this._generatingJobList=!0;for(let e=0;e<this._targetNumJobs;e++)this._generateNewJob();this.previewFirstJob(),this._generatingJobList=!1}},DeliveryGameJobSystem.prototype.previewFirstJob=function(){let e=this._availableJobs[0];e&&this._showJobPreview(e.id)},DeliveryGameJobSystem.prototype.addJob=function(e){e.id=++this._jobIdGenerator,this._availableJobs.push(e),this._addToJobsTable(e),this._showJobPreview(e.id),this.app.fire("job:generated",e)},DeliveryGameJobSystem.prototype._generateNewJob=function(){let e=this.app.playerStats.skills.jobSize,t=parseInt(pc.math.random(1,e+1)),i=this._generateMapChunk(),o=this._getRandomWaypoints(i,t),a=this.app.playerStats.skills.jobUrgency,s=parseInt(pc.math.random(0,2))%2==0,n=s?parseInt(pc.math.random(0,a+1)):0,r=this._calculateTip(i,t,n,s),l=s?10:5,p={id:++this._jobIdGenerator,numPizzas:t,urgencyLevel:n,region:i.name,waypoints:o,hasTimeLimit:s,perPizzaBonus:l,expiresInS:parseInt(pc.math.random(20,240)),startingTimeS:0,totalDistance:0,tip:r,uiRow:null,isPizzaFlying:!1};this._availableJobs.push(p),this._addToJobsTable(p),this.app.fire("job:generated",p),!this.app.globals.isDriving||this.hasActiveJob()||this._generatingJobList||this.entity.sound.play("new-job")},DeliveryGameJobSystem.prototype._addToJobsTable=function(e){let t=this.jobUIRow.resource.instantiate();t.name=e.id,t.findByName("Region").element.text=e.region,t.findByName("Num Pizzas").element.text=e.numPizzas;let i=e.numPizzas*e.perPizzaBonus+e.tip;if(t.findByName("Tip").element.text=i.toLocaleString(),e.hasTimeLimit){for(let i=1;i<6;i++){let o=t.findByName("Urgency "+i.toString());i==e.urgencyLevel?o.enabled=!0:o.enabled=!1}e.urgencyLevel<1&&(t.findByName("Urgency Backing").enabled=!1)}else t.findByName("Urgency Backing").enabled=!1,t.findByName("Clock Icon").enabled=!1;e.uiRow=t,this.jobUIContainer.addChild(t),this.jobUIContainer.element.height=50*this.jobUIContainer.children.length},DeliveryGameJobSystem.prototype._generateMapChunk=function(){let e=[];for(let t in this.mapChunks)this.mapChunks[t].script.mapChunk.isLocked()||e.push(this.mapChunks[t]);if(e.length<=1)return e[0];let t=this._getRegionStreak();""!=t&&(e=e.filter((e=>e.name!=t)));return e.sort((()=>Math.random()-.5))[0]},DeliveryGameJobSystem.prototype._getRegionStreak=function(){if(this._pastCompletedJobs.length<this._JOB_STREAK_LENGTH)return"";let e=this._pastCompletedJobs[0].region;for(let t=1;t<this._pastCompletedJobs.length;t++)if(e!=this._pastCompletedJobs[t].region)return;return e},DeliveryGameJobSystem.prototype._getRandomWaypoints=function(e,t){let i=[];const o=e.script.mapChunk.getPedestrianWaypoints().sort((()=>Math.random()-.5));for(let e in o)if(this._canDeliverToWaypoint(o[e])&&(i.push(o[e]),i.length>=t))return i;return i},DeliveryGameJobSystem.prototype._canDeliverToWaypoint=function(e){return!!(e&&e.script&&e.script.pedestrianWaypoint)&&e.script.pedestrianWaypoint.supportsSpawns},DeliveryGameJobSystem.prototype._calculateTip=function(e,t,i,o){let a=0,s=this.app.playerStats.skills.jobSize,n=1+this.app.skills.jobSize[s].tipBonus,r=5+5*t*(this.app.regions[e.name].tipStars/3)*n;return a+=parseInt(pc.math.random(5,r)),a+=10*i,o&&(a*=1.5),parseInt(a)},DeliveryGameJobSystem.prototype._calculateStartingTime=function(e){let t=this.app.globals.currentVehicle.getPosition().x,i=this.app.globals.currentVehicle.getPosition().z;this.app.globals.isHomeScreenOpen&&(t=this.app.globals.restorePosition.x,i=this.app.globals.restorePosition.z);let o=-1;for(let a in e.waypoints){let s=e.waypoints[a].getPosition(),n=Math.abs(s.x-t)+Math.abs(s.z-i);e.totalDistance+=n,(-1==o||n<o)&&(o=n)}let a=15+o/4;return a*=1-.15*e.urgencyLevel,a},DeliveryGameJobSystem.prototype._calculateExtraTime=function(e){let t=this.app.globals.currentVehicle.getPosition().x,i=this.app.globals.currentVehicle.getPosition().z,o=-1;for(let a in e.waypoints){let s=e.waypoints[a].getPosition(),n=Math.abs(s.x-t)+Math.abs(s.z-i);e.totalDistance+=n,(-1==o||n<o)&&(o=n)}let a=10+o/5;return a*=1-.1*e.urgencyLevel,a},DeliveryGameJobSystem.prototype._resetCurrentJob=function(){this.app.globals.currentJob=null,this._resetDeliveryTargets()},DeliveryGameJobSystem.prototype._cancelCurrentJob=function(){this._resetCurrentJob(),this.previewFirstJob()},DeliveryGameJobSystem.prototype._restartCurrentJob=function(){this._resetDeliveryTargets(),this.app.globals.currentJob.isTimeUp=!1,this.app.globals.currentJob.isComplete=!1,this.app.globals.currentJob.timeRemainingS=this.app.globals.currentJob.startingTimeS,this.app.globals.currentJob.numDeliveriesRemaining=this.app.globals.currentJob.numPizzas;for(let e in this.app.globals.currentJob.waypoints){let t=this.app.globals.currentJob.waypoints[e];this.deliveryTargets[e].script.deliveryTarget.activate(t)}if(this._jobStartRegionName==this.app.globals.currentMapChunk.name)this.app.globals.currentVehicle.rigidbody.teleport(this._jobStartPosition,this._jobStartRotation);else for(let e in this.mapChunks){let t=this.mapChunks[e];if(this.mapChunks[e].name==this._jobStartRegionName){t.script.mapChunk.load(function(){this.app.globals.currentVehicle.rigidbody.teleport(this._jobStartPosition,this._jobStartRotation)}.bind(this));break}}},DeliveryGameJobSystem.prototype._resetDeliveryTargets=function(){for(let e in this.deliveryTargets){this.deliveryTargets[e].script.deliveryTarget.deactivate()}},DeliveryGameJobSystem.prototype._showJobPreview=function(e){for(let t in this._availableJobs){let i=this._availableJobs[t];i.id==e?(i.uiRow.button.active=!1,this._previewingJob=this._availableJobs[t]):i.uiRow.button.active=!0}this.app.fire("job:preview",this._previewingJob)},DeliveryGameJobSystem.prototype._takePreviewingJob=function(){this._takeJob(this._previewingJob);for(let e=this._availableJobs.length-1;e>=0;--e){let t=this._availableJobs[e];t.id==this._previewingJob.id&&(this.jobUIContainer.removeChild(t.uiRow),t.uiRow.destroy(),this._availableJobs.splice(e,1))}},DeliveryGameJobSystem.prototype._takeJob=function(e){this._resetDeliveryTargets(),this.app.globals.currentJob=e,this.app.globals.currentJob.isTimeUp=!1,this.app.globals.currentJob.isComplete=!1,this.app.globals.currentJob.startingTimeS=this._calculateStartingTime(e),this.app.globals.currentJob.timeRemainingS=this.app.globals.currentJob.startingTimeS,this.app.globals.currentJob.numDeliveriesRemaining=this.app.globals.currentJob.numPizzas,this._jobStartRegionName=this.app.globals.currentMapChunk.name,this._jobStartPosition.copy(this.app.globals.restorePosition),this._jobStartRotation.copy(this.app.globals.restoreRotation);for(let t in e.waypoints){let i=e.waypoints[t];this.deliveryTargets[t].script.deliveryTarget.activate(i)}this.app.fire("job:start",this.app.globals.currentJob)},DeliveryGameJobSystem.prototype._loadDowntown=function(){for(let e in this.mapChunks)"Downtown"==this.mapChunks[e].name?this.mapChunks[e].script.mapChunk.load():this.mapChunks[e].script.mapChunk.unload()},DeliveryGameJobSystem.prototype._updateJobProgress=function(e){let t=this.app.globals.currentJob;if(t)if(t.numDeliveriesRemaining-=1,t.numDeliveriesRemaining<=0)t.isComplete=!0,this.entity.sound.play("job-complete"),this._saveCompletedJob(t),this.app.fire("job:complete");else if(this.entity.sound.play("job-progress"),t.hasTimeLimit&&!this.app.globals.isTutorialRunning){let e=this._calculateExtraTime(t);t.timeRemainingS+=e,this.app.fire("job:time:added",e)}},DeliveryGameJobSystem.prototype._saveCompletedJob=function(e){this._pastCompletedJobs.push(e),this._pastCompletedJobs.length>this._JOB_STREAK_LENGTH&&this._pastCompletedJobs.shift()},DeliveryGameJobSystem.prototype._regenerateJobList=function(){if(!this.app.globals.isTutorialRunning){for(this._availableJobs=[];this.jobUIContainer.children.length>0;)this.jobUIContainer.removeChild(this.jobUIContainer.children[0]);this._generateJobs()}},DeliveryGameJobSystem.prototype.update=function(e){if(this.hasActiveJob()&&(!this.app.globals.currentJob.hasTimeLimit||this.app.globals.isAdPlaying||this.app.globals.currentJob.isPizzaFlying||(this.app.globals.currentJob.timeRemainingS-=e),this.app.globals.currentJob.timeRemainingS<=0&&!this.app.globals.currentJob.isTimeUp&&(this.app.globals.currentJob.isTimeUp=!0,this.app.globals.currentJob.timeRemainingS=0,this.app.fire("job:time:up",{reason:"Out of Time!"}))),this.app.globals.isHomeScreenOpen||this.app.globals.isTutorialRunning||(this._jobUpdateCountdownTimerS-=e),this._isTimeForNewJob()){this._jobUpdateCountdownTimerS=.5;for(let e in this._availableJobs){let t=this._availableJobs[e];this._previewingJob&&this._previewingJob.id==t.id||(t.expiresInS-=.5,t.expiresInS<=0&&(t.expiresInS=0))}for(let e=this._availableJobs.length-1;e>=0;--e){let t=this._availableJobs[e];this._previewingJob&&this._previewingJob.id==t.id||t.expiresInS<=0&&(this.jobUIContainer.removeChild(t.uiRow),t.uiRow.destroy(),this._availableJobs.splice(e,1))}(this._availableJobs.length<=0||this._availableJobs.length<this._targetNumJobs&&1==parseInt(pc.math.random(0,5)))&&this._generateNewJob()}},DeliveryGameJobSystem.prototype.hasActiveJob=function(){return this.app.globals.isDriving&&this.app.globals.currentJob&&this.app.globals.currentJob.numDeliveriesRemaining>0&&!this.app.globals.currentJob.hasFailed},DeliveryGameJobSystem.prototype._isTimeForNewJob=function(){return!this.app.globals.isHomeScreenOpen&&!this.app.globals.isTutorialRunning&&this._jobUpdateCountdownTimerS<=0},DeliveryGameJobSystem.prototype.isReadyForDoublePay=function(){if(this.app.globals.currentJob&&this.app.globals.currentJob.numDeliveriesRemaining>0&&!this.app.globals.currentJob.hasFailed)return!1;if(this._availableJobs.length<=0)return!1;let e=0;for(let t in this._availableJobs){this._availableJobs[t].doubledPay&&(e+=1)}return e/this._availableJobs.length<=.5},DeliveryGameJobSystem.prototype.doublePay=function(){for(let e in this._availableJobs){let t=this._availableJobs[e];if(!t.doubledPay&&(t.doubledPay=!0,t.perPizzaBonus*=2,t.tip*=2,t.uiRow)){t.uiRow.findByName("Coin Icon").script.juicyButton.jiggle();let e=t.numPizzas*t.perPizzaBonus+t.tip;t.uiRow.findByName("Tip").element.text=e.toLocaleString(),t.uiRow.findByName("2x Label").enabled=!0}}};var Helpers=pc.createScript("helpers");Helpers.prototype.initialize=function(){this.app.helpers={formatTime:this._formatTime}},Helpers.prototype._formatTime=function(e){let t=parseInt(e,10),r=Math.floor(t/3600),p=Math.floor((t-3600*r)/60),o=t-3600*r-60*p;return p<10&&r>0&&(p="0"+p),o<10&&(o="0"+o),"00"!=r?r+":"+p+":"+o:p+":"+o};var JobsPage=pc.createScript("jobsPage");JobsPage.attributes.add("jobSystem",{type:"entity"}),JobsPage.attributes.add("driveButton",{type:"entity"}),JobsPage.attributes.add("takeJobButton",{type:"entity"}),JobsPage.attributes.add("jobsMapCamera",{type:"entity"}),JobsPage.attributes.add("jobsListContent",{type:"entity"}),JobsPage.attributes.add("jobsListElement",{type:"entity"}),JobsPage.attributes.add("currentJobGroup",{type:"entity"}),JobsPage.attributes.add("cancelJobButton",{type:"entity"}),JobsPage.attributes.add("confirmCancelGroup",{type:"entity"}),JobsPage.attributes.add("confirmBackButton",{type:"entity"}),JobsPage.attributes.add("confirmCancelButton",{type:"entity"}),JobsPage.attributes.add("doublePayButton",{type:"entity"}),JobsPage.attributes.add("deliveryMap",{type:"entity"}),JobsPage.attributes.add("jobsMap",{type:"entity"}),JobsPage.prototype.initialize=function(){this._selectedUIRow=null,this._timeSUntilDoublePayButton=0,this.entity.on("show",this._show,this),this.entity.on("hide",this._hide,this),this.app.on("job:start",this._showCurrentJob,this),this.app.on("job:cancel",this._showJobsList,this),this.app.on("job:failed",this._showJobsList,this),this.app.on("job:complete",this._showJobsList,this),this.app.on("job:ui:row:click",this._setSelectedUIRow,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this),this.cancelJobButton.button.on("click",this._showConfirmCancel,this),this.takeJobButton.button.on("click",this._takeJob,this),this.driveButton.button.on("click",this._resumeJob,this)},JobsPage.prototype._takeJob=function(){this.app.fire("job:take")},JobsPage.prototype._resumeJob=function(){this.app.fire("job:resume")},JobsPage.prototype._show=function(){this._updateLayout(),this.jobsMapCamera.enabled=!0,this.deliveryMap.script.deliveryMap.showIcons(),this.jobSystem.script.deliveryGameJobSystem.previewFirstJob(),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this),this.app.globals.isTutorialRunning||(this._timeSUntilDoublePayButton=1.8),this.jobSystem.script.deliveryGameJobSystem.getNumAvailableJobs()<=0?this.takeJobButton.button.active=!1:this.takeJobButton.button.active=!0,this._updateCurrentJobData(),this.app.globals.currentJob&&!this.app.globals.currentJob.isComplete?this._showCurrentJob():this._showJobsList()},JobsPage.prototype._hide=function(){this.jobsMapCamera.enabled=!1,this._timeSUntilDoublePayButton=0,this.deliveryMap.script.deliveryMap.hideIcons(),this.app.keyboard.off(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this),this.doublePayButton.script.uiElementAnimation.stop(),this.doublePayButton.enabled=!1,this.doublePayButton.button.off()},JobsPage.prototype._listenForKeyboardInput=function(t){this.app.globals.isAdPlaying||(t.key==pc.KEY_SPACE||t.key==pc.KEY_ENTER?this.takeJobButton.enabled&&this.takeJobButton.button.active?this._takeJob():this.driveButton.enabled&&this.driveButton.button.active&&this._resumeJob():t.key==pc.KEY_UP||t.key==pc.KEY_W?this._previewPrevJob():t.key!=pc.KEY_DOWN&&t.key!=pc.KEY_S||this._previewNextJob())},JobsPage.prototype._previewPrevJob=function(){let t=this.jobsListContent.children.length;if(!(t<=0)){null==this._selectedUIRow&&(this._selectedUIRow=this.jobsListContent.children[0]);for(let e in this.jobsListContent.children){let i=this.jobsListContent.children[e];if(this._selectedUIRow._guid==i._guid){if(0==e){let e=this.jobsListContent.children[t-1];this.app.fire("job:ui:row:click",e)}else{let t=this.jobsListContent.children[e-1];this.app.fire("job:ui:row:click",t)}return}}}},JobsPage.prototype._previewNextJob=function(){let t=this.jobsListContent.children.length;if(!(t<=0)){null==this._selectedUIRow&&(this._selectedUIRow=this.jobsListContent.children[0]);for(let e in this.jobsListContent.children){let i=this.jobsListContent.children[e];if(this._selectedUIRow._guid==i._guid){if(e>=t-1){let t=this.jobsListContent.children[0];this.app.fire("job:ui:row:click",t)}else{let t=this.jobsListContent.children[parseInt(e)+1];this.app.fire("job:ui:row:click",t)}return}}}},JobsPage.prototype._showCurrentJob=function(){this._updateCurrentJobData(),this.driveButton.enabled=!0,this.takeJobButton.enabled=!1,this.jobsListElement.enabled=!1,this.currentJobGroup.enabled=!0,this.app.globals.isTutorialRunning?(this.cancelJobButton.button.active=!1,this.cancelJobButton.findByName("Text").element.opacity=.5):(this.cancelJobButton.button.active=!0,this.cancelJobButton.findByName("Text").element.opacity=1)},JobsPage.prototype._showJobsList=function(){this.driveButton.enabled=!1,this.takeJobButton.enabled=!0,this.jobsListElement.enabled=!0,this.currentJobGroup.enabled=!1},JobsPage.prototype._updateCurrentJobData=function(){let t=this.app.globals.currentJob;if(!t||t.isComplete)return;let e=t.numPizzas-t.numDeliveriesRemaining,i=t.numPizzas;this.currentJobGroup.findByName("Pizzas Remaining").element.text=e+"/"+i;let o=t.numPizzas*t.perPizzaBonus+t.tip;if(this.currentJobGroup.findByName("Job Tips").element.text=o.toLocaleString(),t.hasTimeLimit){this.currentJobGroup.findByName("Clock Icon").enabled=!0,this.currentJobGroup.findByName("Time Remaining").enabled=!0;let e=this.app.helpers.formatTime(t.timeRemainingS);this.currentJobGroup.findByName("Time Remaining").element.text=e}else this.currentJobGroup.findByName("Clock Icon").enabled=!1,this.currentJobGroup.findByName("Time Remaining").enabled=!1;for(let e=1;e<6;e++){let i=this.currentJobGroup.findByName("Urgency "+e.toString());e==t.urgencyLevel?i.enabled=!0:i.enabled=!1,t.hasTimeLimit||(i.enabled=!1)}(!t.urgencyLevel||t.urgencyLevel<=0||!t.hasTimeLimit)&&(this.currentJobGroup.findByName("Urgency Backing").enabled=!1),this.app.fire("job:preview",t)},JobsPage.prototype._showConfirmCancel=function(){this.cancelJobButton.enabled=!1,this.confirmCancelGroup.enabled=!0,this.confirmCancelButton.button.on("click",this._cancelJob,this),this.confirmBackButton.button.on("click",this._hideConfirmCancel,this)},JobsPage.prototype._hideConfirmCancel=function(){this.cancelJobButton.enabled=!0,this.confirmCancelGroup.enabled=!1,this.confirmCancelButton.button.off("click",this._cancelJob,this),this.confirmBackButton.button.off("click",this._hideConfirmCancel,this)},JobsPage.prototype._cancelJob=function(){this.app.fire("job:cancel"),this._hideConfirmCancel()},JobsPage.prototype._setSelectedUIRow=function(t){this._selectedUIRow=t},JobsPage.prototype.update=function(t){this._timeSUntilDoublePayButton>0&&(this._timeSUntilDoublePayButton-=t,this._timeSUntilDoublePayButton<=0&&(this.jobSystem.script.deliveryGameJobSystem.isReadyForDoublePay()?this._showDoublePayButton():this._timeSUntilDoublePayButton=1.8))},JobsPage.prototype._showDoublePayButton=function(){this.doublePayButton.enabled=!0,this.doublePayButton.script.uiElementAnimation.start(),this.doublePayButton.button.once("click",this._watchAdForDoublePay,this)},JobsPage.prototype._watchAdForDoublePay=function(){this.app.fire("poki:rewardedBreak:play",function(){this.jobSystem.script.deliveryGameJobSystem.doublePay()}.bind(this),function(){}.bind(this))},JobsPage.prototype._updateLayout=function(){this.app.globals.isTouchPortrait?this._showPortraitLayout():this._showLandscapeLayout()},JobsPage.prototype._showPortraitLayout=function(){this.jobsListElement.script.pageAnimation.enabled=!1,this.jobsMap.script.pageAnimation.enabled=!1,this.takeJobButton.script.pageAnimation.enabled=!1,this.jobsMap.element.anchor=[.5,1,.5,1],this.jobsMap.setLocalPosition(0,-300,0),this.jobsListElement.setLocalPosition(0,-220,0),this.currentJobGroup.setLocalPosition(0,-220,0),this.takeJobButton.element.anchor=[.5,0,.5,0],this.takeJobButton.setLocalPosition(0,60,0),this.driveButton.element.anchor=[.5,0,.5,0],this.driveButton.setLocalPosition(0,60,0)},JobsPage.prototype._showLandscapeLayout=function(){this.jobsListElement.script.pageAnimation.enabled=!0,this.jobsMap.script.pageAnimation.enabled=!0,this.takeJobButton.script.pageAnimation.enabled=!0,this.jobsListElement.setLocalPosition(-225,-57,0),this.currentJobGroup.setLocalPosition(-227,-57,0),this.jobsMap.element.anchor=[.5,.5,.5,.5],this.jobsMap.setLocalPosition(220,173,0),this.takeJobButton.element.anchor=[.5,.5,.5,.5],this.takeJobButton.setLocalPosition(220,-230,0),this.driveButton.element.anchor=[.5,.5,.5,.5],this.driveButton.setLocalPosition(220,-230,0)};var JobUiRow=pc.createScript("jobUiRow");JobUiRow.prototype.initialize=function(){this.entity.button.on("click",this._emitClickEvent,this),this.entity.on("destroy",(function(){this.entity.button&&this.entity.button.off("click")}),this)},JobUiRow.prototype._emitClickEvent=function(){this.app.fire("job:ui:row:click",this.entity)};var Confetti=pc.createScript("confetti");Confetti.prototype.initialize=function(){this._count=160,this._defaults={left:{origin:{x:.2,y:.75},scalar:1.5,gravity:.7},right:{origin:{x:.8,y:.75},scalar:1.5,gravity:.7}},this.app.on("ui:confetti:fire-cannon",this._fireCannon,this),this.app.on("ui:confetti:fire-stars",this._fireStars,this)},Confetti.prototype._fireCannon=function(){this._fire(.25,{spread:26,startVelocity:55}),this._fire(.2,{spread:60}),this._fire(.35,{spread:100,decay:.91,scalar:.8}),this._fire(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),this._fire(.1,{spread:120,startVelocity:45})},Confetti.prototype._fireStars=function(){const t={spread:360,ticks:50,gravity:0,decay:.94,startVelocity:30,shapes:["star"],colors:["FFE400","FFBD00","E89400","FFCA6C","FDFFB8"]};confetti({...t,particleCount:40,scalar:1.2,shapes:["star"]}),confetti({...t,particleCount:10,scalar:.75,shapes:["circle"]})},Confetti.prototype._fire=function(t,i){confetti(Object.assign({},this._defaults.left,i,{particleCount:Math.floor(this._count*t)})),confetti(Object.assign({},this._defaults.right,i,{particleCount:Math.floor(this._count*t)}))};var DeliveryGameScore=pc.createScript("deliveryGameScore");DeliveryGameScore.attributes.add("homeScreenCoinsElement",{type:"entity"}),DeliveryGameScore.attributes.add("pageCoinsElement",{type:"entity"}),DeliveryGameScore.attributes.add("jobCompleteScreen",{type:"entity"}),DeliveryGameScore.attributes.add("jobFailedScreen",{type:"entity"}),DeliveryGameScore.attributes.add("coinDrops",{type:"entity"}),DeliveryGameScore.attributes.add("graceTimeS",{type:"number",default:10,description:"Time in seconds to unlock extra job time before job:failed fires."}),DeliveryGameScore.prototype.initialize=function(){this._graceTimeSCountdown=0,this._displayedCoinCount=0,this._jobTimeTakenS=0,this._isFirstJob=this.app.playerStats.jobsCompleted<=0,this._firstJobBonus=25,this._COINS_PER_OLD_JUMP=5,this._COINS_PER_NEW_JUMP=25,this._EXTRA_REWARDED_TIME_S=60,this._showStartingCoins(),this.app.on("job:progress",this._giveTip,this),this.app.on("job:complete",this._completeJob,this),this.app.on("job:time:up",this._showContinuation,this),this.app.on("ui:home:show",this._forfeitGrace,this),this.app.on("stats:loaded",this._setStartingValues,this),this.app.on("jump:completed:new",this._awardNewJump,this),this.app.on("jump:completed:old",this._awardOldJump,this),this.app.on("driving:score",this._awardDrivingScore,this),this.app.on("jump:completed:all",this._awardAllJumpsCompleted,this)},DeliveryGameScore.prototype._setStartingValues=function(){this._showStartingCoins(),this._isFirstJob=this.app.playerStats.jobsCompleted<=0},DeliveryGameScore.prototype._showStartingCoins=function(){this._displayedCoinCount=this.app.playerStats.coins;let e=parseInt(Math.round(this._displayedCoinCount));this.coinDrops.script.uiCoinDrops.setStartingCount(e),this._showAmount(e.toLocaleString())},DeliveryGameScore.prototype._addCoins=function(e){this.app.fire("coins:add",e),this.coinDrops.script.uiCoinDrops.setTrueCount(this.app.playerStats.coins)},DeliveryGameScore.prototype.update=function(e){if(this.app.playerStats.coins!=this._displayedCoinCount){this._displayedCoinCount=pc.math.lerp(this._displayedCoinCount,this.app.playerStats.coins,.05);let e=parseInt(Math.round(this._displayedCoinCount)).toLocaleString();this._showAmount(e)}this._graceTimeSCountdown>0&&(this._graceTimeSCountdown-=e,this._graceTimeSCountdown<=0&&(this.app.globals.currentJob.hasFailed=!0,this.app.fire("job:failed")))},DeliveryGameScore.prototype._showAmount=function(e){this.homeScreenCoinsElement.element.text=e,this.pageCoinsElement.element.text=e},DeliveryGameScore.prototype._giveTip=function(){let e=Math.ceil(this.app.globals.currentJob.tip/this.app.globals.currentJob.numPizzas);this._addCoins(e)},DeliveryGameScore.prototype._completeJob=function(){let e=this.app.globals.currentJob,i=0,t=[];t.push({name:"Tips",icon:this.app.assets.find("tips-icon","sprite"),value:e.tip});let o=this._calulateSpeedBonus(e);o>0&&(t.push({name:"Speed",icon:this.app.assets.find("speed-icon","sprite"),value:o}),i+=o);let s=e.numPizzas*e.perPizzaBonus;if(t.push({name:"x"+e.numPizzas+" Pizzas",icon:this.app.assets.find("dough-pizza-icon","sprite"),value:s}),i+=s,this._isFirstJob&&(this._isFirstJob=!1,t.push({name:"First Job",icon:this.app.assets.find("new-icon","sprite"),value:this._firstJobBonus}),i+=this._firstJobBonus),t.length<2){let o=parseInt(pc.math.random(10*e.numPizzas,20*e.numPizzas));t.push({name:"Bonus",icon:this.app.assets.find("bonus-icon","sprite"),value:o}),i+=o}this.jobCompleteScreen.script.deliveryGameJobComplete.setAwards(t),this._addCoins(i),this._offerRewardedCoins(i)},DeliveryGameScore.prototype._offerRewardedCoins=function(e){if(this.app.globals.isTutorialRunning)return;let i=this._calculateBonus(e);this.jobCompleteScreen.script.deliveryGameJobComplete.offerBonus(i,function(){this.app.fire("poki:rewardedBreak:play",function(){this._addCoins(i)}.bind(this),function(){this.jobCompleteScreen.script.deliveryGameJobComplete.hide()}.bind(this))}.bind(this))},DeliveryGameScore.prototype._calculateBonus=function(e){return e<20?20:10*Math.floor(e/10)},DeliveryGameScore.prototype._calulateSpeedBonus=function(e){if(!e.hasTimeLimit)return 0;if(e.urgencyLevel<=0){if(e.timeRemainingS>=15)return parseInt(e.timeRemainingS/5)}else if(1==e.urgencyLevel){if(e.timeRemainingS>=12)return parseInt(e.timeRemainingS/4)}else if(2==e.urgencyLevel){if(e.timeRemainingS>=9)return parseInt(e.timeRemainingS/3)}else if(3==e.urgencyLevel){if(e.timeRemainingS>=5)return parseInt(e.timeRemainingS/2)}else if(4==e.urgencyLevel){if(e.timeRemainingS>0)return parseInt(e.timeRemainingS)}else if(5==e.urgencyLevel&&e.timeRemainingS>0)return parseInt(1.5*e.timeRemainingS);return 0},DeliveryGameScore.prototype._showContinuation=function(){this._graceTimeSCountdown=this.graceTimeS,this._offerMoreTime(this._EXTRA_REWARDED_TIME_S),this._offerRestart()},DeliveryGameScore.prototype._offerMoreTime=function(e){this.jobFailedScreen.off("time:requested"),this.jobFailedScreen.on("time:requested",(function(){this._graceTimeSCountdown=0}),this),this.jobFailedScreen.script.deliveryGameJobFailed.offerMoreTime(e,function(){this.app.fire("poki:rewardedBreak:play",function(){this._addTime(e)}.bind(this),function(){this.app.globals.currentJob.hasFailed||(this.app.globals.currentJob.hasFailed=!0,this.app.fire("job:failed"))}.bind(this))}.bind(this))},DeliveryGameScore.prototype._addTime=function(e){this.app.fire("job:time:extended",e),this.app.globals.currentJob.isTimeUp=!1,this.app.globals.currentJob.timeRemainingS=e},DeliveryGameScore.prototype._offerRestart=function(){this.jobFailedScreen.off("restart:requested"),this.jobFailedScreen.on("restart:requested",(function(){this._graceTimeSCountdown=0}),this),this.jobFailedScreen.script.deliveryGameJobFailed.offerRestart(function(){this.app.fire("poki:commercialBreak:play",function(){this._restart()}.bind(this),function(){this._restart()}.bind(this))}.bind(this))},DeliveryGameScore.prototype._restart=function(){this.app.fire("job:restart")},DeliveryGameScore.prototype._forfeitGrace=function(){this._graceTimeSCountdown>0&&this.app.globals.currentJob&&(this._graceTimeSCountdown=0,this.app.globals.currentJob.hasFailed=!0,this.app.fire("job:failed"))},DeliveryGameScore.prototype._awardNewJump=function(){this._addCoins(this._COINS_PER_NEW_JUMP)},DeliveryGameScore.prototype._awardOldJump=function(){this._addCoins(this._COINS_PER_OLD_JUMP)},DeliveryGameScore.prototype._awardAllJumpsCompleted=function(){this._addCoins(10*this._COINS_PER_NEW_JUMP)},DeliveryGameScore.prototype._awardDrivingScore=function(e){this._addCoins(e)};var ProximityCheck=pc.createScript("proximityCheck");ProximityCheck.attributes.add("triggerDistance",{type:"number",default:6}),ProximityCheck.prototype.initialize=function(){this._isVehicleInside=!1,this._timeSUntilNextProximityCheck=pc.math.random(0,.5)},ProximityCheck.prototype.update=function(i){if(this.app.globals.currentVehicle&&(this._timeSUntilNextProximityCheck-=i,this._timeSUntilNextProximityCheck<=0)){this._timeSUntilNextProximityCheck=.2;let i=this.app.globals.currentVehicle.getPosition().distance(this.entity.getPosition());i<=this.triggerDistance&&!this._isVehicleInside?(this._isVehicleInside=!0,this.entity.fire("vehicle:enter")):this._isVehicleInside&&i>6&&(this._isVehicleInside=!1,this.entity.fire("vehicle:exit"))}};var UiVehicleDamage=pc.createScript("uiVehicleDamage");UiVehicleDamage.attributes.add("bar",{type:"entity"}),UiVehicleDamage.attributes.add("barBacking",{type:"entity"}),UiVehicleDamage.attributes.add("wrenchIcon",{type:"entity"}),UiVehicleDamage.attributes.add("uiContainer",{type:"entity"}),UiVehicleDamage.attributes.add("displayTimeS",{type:"number",default:3}),UiVehicleDamage.attributes.add("fadeOutTimeS",{type:"number",default:1}),UiVehicleDamage.attributes.add("uiFadeCurve",{type:"curve"}),UiVehicleDamage.attributes.add("healthFlashCurve",{type:"curve"}),UiVehicleDamage.prototype.initialize=function(){this._green=new pc.Color(59/256,204/256,38/256),this._yellow=new pc.Color(253/256,253/256,62/256),this._orange=new pc.Color(234/256,.53125,44/256),this._red=new pc.Color(255/256,9/256,9/256),this._defaultWrenchColor=new pc.Color(255/256,179/256,40/256),this._health={actual:100,displayed:100},this._displayTimeLeftS=this.displayTimeS,this._fadeOutTimeLeftS=this.fadeOutTimeS,this._healthFlashAnimationS=0,this._healthFlashIntervalS=.5,this._forceShow=!1,this._barColorName="green",this._healthBarStartWidth=this.bar.element.width,this.app.on("vehicle:player:damage",this._updateHealth,this),this.app.on("vehicle:player:ready",this._setSpawnHealth,this),this.app.on("vehicle:player:repair",this._setRepairHealth,this)},UiVehicleDamage.prototype._updateHealth=function(e){this._health.actual=e,this._isWrecked()?(this.wrenchIcon.element.color=this._red,this.wrenchIcon.script.shakyElement.play()):(this.wrenchIcon.element.color=this._defaultWrenchColor,this.wrenchIcon.script.shakyElement.stop())},UiVehicleDamage.prototype._setSpawnHealth=function(e){let t=e.script.vehicle.getHealth();this._updateHealth(t),this._health.displayed=this._health.actual,this._forceShow=!0},UiVehicleDamage.prototype._setRepairHealth=function(e,t){this.app.globals.currentVehicle&&e==this.app.globals.currentVehicle.vehicleName&&this._updateHealth(t)},UiVehicleDamage.prototype.update=function(e){if((Math.round(this._health.actual)!=Math.round(this._health.displayed)||this._forceShow)&&(this._forceShow=!1,this._health.displayed=pc.math.lerp(this._health.displayed,this._health.actual,.05),this._updateBarGraphics(this._health.displayed),this._displayTimeLeftS=this.displayTimeS,this._fadeOutTimeLeftS=this.fadeOutTimeS,this.bar.enabled=!0,this.barBacking.enabled=!0,this.wrenchIcon.enabled=!0,this.uiContainer.enabled=!0,this.bar.element.opacity=.8,this.barBacking.element.opacity=.8,this.wrenchIcon.element.opacity=.8,this.uiContainer.element.opacity=.8),this._displayTimeLeftS>0&&(this._displayTimeLeftS-=e),this._displayTimeLeftS<=0&&this._fadeOutTimeLeftS>0&&!this._isWrecked()){this._fadeOutTimeLeftS-=e;let t=this._fadeOutTimeLeftS/this.fadeOutTimeS,i=this.uiFadeCurve.value(1-t);this._fadeOutTimeLeftS<0&&(i=0),this.bar.element.opacity=i,this.barBacking.element.opacity=i,this.wrenchIcon.element.opacity=i,this.uiContainer.element.opacity=i}if(this._isHealthCritical()&&this._displayTimeLeftS>0){this._healthFlashAnimationS-=e,this._healthFlashAnimationS<=0&&(this._healthFlashAnimationS=this._healthFlashIntervalS);let t=this._healthFlashAnimationS/this._healthFlashIntervalS,i=this.healthFlashCurve.value(t);this.bar.element.opacity=i}},UiVehicleDamage.prototype._updateBarGraphics=function(e){this.bar.element.width=.01*e*this._healthBarStartWidth;let t=this._getColorName(e);if(this._barColorName!=t)switch(this._barColorName=t,this._barColorName){case"green":this.bar.element.color=this._green;break;case"yellow":this.bar.element.color=this._yellow;break;case"orange":this.bar.element.color=this._orange;break;case"red":this.bar.element.color=this._red}},UiVehicleDamage.prototype._getColorName=function(e){return e>75?"green":e>=50?"yellow":e>=25?"orange":e<25?"red":void 0},UiVehicleDamage.prototype._isHealthCritical=function(){return this._health.actual<=15},UiVehicleDamage.prototype._isWrecked=function(){return this._health.actual<=1};var MapChunk=pc.createScript("mapChunk");MapChunk.attributes.add("startsLoaded",{type:"boolean"}),MapChunk.attributes.add("mapRender",{type:"entity"}),MapChunk.attributes.add("buildings",{type:"entity"}),MapChunk.attributes.add("minimapRender",{type:"entity"}),MapChunk.attributes.add("intersections",{type:"entity"}),MapChunk.attributes.add("vehicleWaypoints",{type:"entity"}),MapChunk.attributes.add("pedestrianWaypointContainer",{type:"entity"}),MapChunk.attributes.add("regionBarriers",{type:"entity",array:!0}),MapChunk.attributes.add("highwayEntrance",{type:"entity"}),MapChunk.attributes.add("highwayExit",{type:"entity"}),MapChunk.prototype.initialize=function(){this._isLoaded=!1,this._isPreloaded=!1,this._isLocked=!0,this._hasLoadFailed=!1,this._hasPreloadFailed=!1,this._numLoadFailures=0,this._pedestrianWaypoints=[],this._loadPedestrianWaypoints(this.pedestrianWaypointContainer),this.startsLoaded&&(this._isLocked=!1),this.app.on("region:unlock",this._attemptToUnlock,this),this.app.on("game:loaded",this._setRegionLockStates,this)},MapChunk.prototype.isLoaded=function(){return this._isLoaded},MapChunk.prototype._loadPedestrianWaypoints=function(t){for(let e in t.children){let i=t.children[e];i.script&&i.script.pedestrianWaypoint&&this._pedestrianWaypoints.push(i),i.children&&this._loadPedestrianWaypoints(i)}},MapChunk.prototype.getPedestrianWaypoints=function(){return this._pedestrianWaypoints},MapChunk.prototype.isLocked=function(){return this._isLocked},MapChunk.prototype._attemptToUnlock=function(t){this.entity.name==t&&this._unlock()},MapChunk.prototype._unlock=function(){let t=this.app.assets.get(this.mapRender.render.asset);t.ready((function(t){this.mapRender.collision.renderAsset=t.id,this.minimapRender.enabled=!0,this._isLocked=!1;for(let t in this.regionBarriers)this.regionBarriers[t].enabled=!1}),this),this.app.assets.load(t)},MapChunk.prototype._setRegionLockStates=function(){this.app.playerStats.regions[this.entity.name].isUnlocked&&this._unlock()},MapChunk.prototype.postInitialize=function(){this.startsLoaded&&this.load()},MapChunk.prototype.load=function(t=null){if(!this._isLocked&&!this._isLoaded)try{this.mapRender.enabled=!0,this.buildings.enabled=!0,this.intersections.enabled=!0,this._isLoaded=!0,this.app.globals.currentMapChunk&&this.app.globals.currentMapChunk.script.mapChunk.unload(),this.app.globals.currentMapChunk=this.entity,this.app.fire("map:chunk:load",this.entity),this._hasLoadFailed=!1,t&&(t(),this._savedLoadSuccessCallback=null)}catch(e){this._hasLoadFailed=!0,this.mapRender.enabled=!1,this.buildings.enabled=!1,this.intersections.enabled=!1,this._isLoaded=!1,this._savedLoadSuccessCallback=t,console.error(this.entity.name+" Map chunk load failed",e)}},MapChunk.prototype.preload=function(t=null){if(this._isLoaded)return this._hasPreloadFailed=!1,void(t&&(t(),this._savedPreLoadSuccessCallback=null));try{this.mapRender.enabled=!0,this.buildings.enabled=!0,this.intersections.enabled=!0,this._isPreloaded=!0,this._hasPreloadFailed=!1,this.app.fire("map:chunk:preload",this.entity),t&&(t(),this._savedPreLoadSuccessCallback=null),this.mapRender.enabled=!1,this.buildings.enabled=!1,this.intersections.enabled=!1}catch(e){this._hasPreloadFailed=!0,this.mapRender.enabled=!1,this.buildings.enabled=!1,this.intersections.enabled=!1,this._isPreloaded=!1,this._savedPreLoadSuccessCallback=t}},MapChunk.prototype.unload=function(){!this._isLocked&&this._isLoaded&&(this.mapRender.enabled=!1,this.buildings.enabled=!1,this.intersections.enabled=!1,this.app.fire("map:chunk:unload",this.entity),this._isLoaded=!1)},MapChunk.prototype.update=function(){this._hasLoadFailed&&this.load(this._savedLoadSuccessCallback),this._hasPreloadFailed&&this.preload(this._savedPreLoadSuccessCallback)};var MapChunkTrigger=pc.createScript("mapChunkTrigger");MapChunkTrigger.attributes.add("loadChunk",{type:"entity"}),MapChunkTrigger.attributes.add("unloadChunk",{type:"entity"}),MapChunkTrigger.prototype.initialize=function(){this.boundingBox=new pc.BoundingBox(this.entity.getPosition(),this.entity.collision.halfExtents)},MapChunkTrigger.prototype.update=function(i){if(!this.loadChunk.script.mapChunk.isLocked()&&this.app.globals.isDriving&&this.app.globals.currentVehicle){let i=this.app.globals.currentVehicle.getPosition();this.boundingBox.containsPoint(i)&&(this.loadChunk.script.mapChunk.load(),this.unloadChunk.script.mapChunk.unload())}};var RegionButton=pc.createScript("regionButton");RegionButton.attributes.add("regionName",{type:"string"}),RegionButton.attributes.add("lockIcon",{type:"entity"}),RegionButton.attributes.add("nameElement",{type:"entity"}),RegionButton.attributes.add("dependants",{type:"entity",array:!0,description:"These region buttons have to be unlocked first before this one is unlocked"}),RegionButton.prototype.initialize=function(){this.isUnlocked=!1,this._selectedOpacity=.5,this._selectedColor=new pc.Color(237/256,198/256,133/256),this._unselectedColor=new pc.Color(.53125,.53125,.53125),this._selectedHoverColor=new pc.Color(237/256,198/256,133/256,this._selectedOpacity),this._unselectedHoverColor=new pc.Color(237/256,198/256,133/256,72/256),this._addButtonListeners()},RegionButton.prototype._addButtonListeners=function(){this.entity.button.on("click",(function(){this.entity.fire("inspect",this.app.regions[this.regionName]),this.nameElement.script.juicyButton.jiggle()}),this)},RegionButton.prototype.updateDisplayState=function(t){this._dependantsUnlocked()?(this.isUnlocked=this.app.playerStats.regions[this.app.regions[this.regionName].name].isUnlocked,this.isUnlocked?this._showUnlockedState():this._showLockedState(),t==this.regionName?this._showSelectedColor():this._hideSelectedColor()):this._showInaccessibleState()},RegionButton.prototype._dependantsUnlocked=function(){if(this.dependants.length<=0)return!0;for(let t in this.dependants){let e=this.dependants[t].script.regionButton.regionName;if(!this.app.playerStats.regions[e].isUnlocked)return!1}return!0},RegionButton.prototype._showUnlockedState=function(){this.nameElement.enabled=!0,this.entity.element.opacity=0,this.entity.button.enabled=!0,this.lockIcon&&(this.lockIcon.enabled=!1)},RegionButton.prototype._showLockedState=function(){this.nameElement.enabled=!0,this.entity.element.opacity=.5,this.entity.button.enabled=!0,this.lockIcon&&(this.lockIcon.enabled=!0)},RegionButton.prototype._showInaccessibleState=function(){this.nameElement.enabled=!1,this.entity.button.enabled=!1,this.entity.element.opacity=.9},RegionButton.prototype._showSelectedColor=function(){this.entity.element.opacity=this._selectedOpacity,this.entity.element.color=this._selectedColor,this.entity.button.hoverTint=this._selectedHoverColor},RegionButton.prototype._hideSelectedColor=function(){this.entity.element.color=this._unselectedColor,this.entity.button.hoverTint=this._unselectedHoverColor};var LocalStorage=pc.createScript("localStorage");LocalStorage.prototype.initialize=function(){this._isLocalStorageAvailable=this._isAvailable(),this.app.localStorage=this},LocalStorage.prototype._isAvailable=function(){try{localStorage.setItem("vtLocalStorage",!0),localStorage.removeItem("vtLocalStorage")}catch(e){return!1}return!0},LocalStorage.prototype.getItem=function(e){if(this._isLocalStorageAvailable)try{return localStorage.getItem("vortellis-pizza-delivery:"+e)}catch(e){return""}else this._getCookie(e)},LocalStorage.prototype.setItem=function(e,t){if(this._isLocalStorageAvailable)try{localStorage.setItem("vortellis-pizza-delivery:"+e,t)}catch(e){return}else this._setCookie(e,t)},LocalStorage.prototype._removeItem=function(e){if(this._isLocalStorageAvailable)try{localStorage.removeItem("vortellis-pizza-delivery:"+e)}catch(e){return}else this._setCookie(e,"")},LocalStorage.prototype._getCookie=function(e){let t="vortellis-pizza-delivery:"+e+"=",o=decodeURIComponent(document.cookie).split(";");for(let e=0;e<o.length;e++){let r=o[e];for(;" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""},LocalStorage.prototype._setCookie=function(e,t){const o=new Date;o.setTime(o.getTime()+5184e6);let r="expires="+o.toUTCString();document.cookie="vortellis-pizza-delivery:"+e+"="+t+";"+r+";path=/"};var LoadingBlockAnimation=pc.createScript("loadingBlockAnimation");LoadingBlockAnimation.attributes.add("scaleCurve",{type:"curve"}),LoadingBlockAnimation.attributes.add("animationSpeed",{type:"number",default:1}),LoadingBlockAnimation.attributes.add("blocks",{type:"entity",array:!0}),LoadingBlockAnimation.prototype.initialize=function(){this._animCountdown=this.animationSpeed},LoadingBlockAnimation.prototype.update=function(i){this._animCountdown-=i,this._animCountdown<=0&&(this._animCountdown=this.animationSpeed);for(let i in this.blocks){let t=this._animCountdown/this.animationSpeed;t+=1/this.blocks.length*i,t>1&&(t-=1);let n=this.scaleCurve.value(t);this.blocks[i].setLocalScale(n,n,n)}};var Garage=pc.createScript("garage");Garage.attributes.add("garagePage",{type:"entity"}),Garage.attributes.add("loadingState",{type:"entity"}),Garage.attributes.add("vehicleGroupContainerNames",{type:"string",array:!0}),Garage.prototype.initialize=function(){this.app.on("vehicle:purchase",this._spawnVehicle,this),this.app.on("vehicle:select",this._selectVehicle,this),this.app.on("game:loaded",this._spawnStartingVehicle,this),this.garagePage.on("show",this._loadVehicleGroups,this)},Garage.prototype._spawnVehicle=function(e){this.app.globals.firstInputGiven?this.app.fire("poki:gameplayStart",function(){this.app.fire("vehicle:player:spawn",e)}.bind(this)):this.app.fire("vehicle:player:spawn",e)},Garage.prototype._selectVehicle=function(e){this.app.globals.currentVehicle.vehicleName==e.name?this.app.globals.currentVehicle.wasJustRepaired?(this.app.globals.currentVehicle.wasJustRepaired=!1,this._spawnVehicle(e)):this.app.fire("job:roam"):this._spawnVehicle(e)},Garage.prototype._spawnStartingVehicle=function(){window.carNameSelected&&(this.app.playerStats.selectedVehicleName=window.carNameSelected);let e=!1,a=this.app.vehicles;for(let t in a)a[t].name==this.app.playerStats.selectedVehicleName&&(this.garagePage.script.vehicleShowroom.setViewingVehicleId(t),this._spawnVehicle(a[t]),e=!0);e||(console.error("Tried to spawn a vehicle we don't know about!",this.app.playerStats.selectedVehicleName),this.garagePage.script.vehicleShowroom.setViewingVehicleId(0),this._spawnVehicle(a[0]))},Garage.prototype._loadVehicleGroups=function(){this.loadingState.enabled=!0,this._numGroupsLoaded=0,this._numGroupsToLoad=this.vehicleGroupContainerNames.length;for(let e in this.vehicleGroupContainerNames){let a=this.vehicleGroupContainerNames[e];const t=this.app.assets.find(a,"container");t.ready((function(e){this._setGroupLoaded()}),this),this.app.assets.load(t)}},Garage.prototype._setGroupLoaded=function(){this._numGroupsLoaded+=1,this._numGroupsLoaded>=this._numGroupsToLoad&&(this.loadingState.enabled=!1)};var VehicleShowroom=pc.createScript("vehicleShowroom");VehicleShowroom.attributes.add("nextButton",{type:"entity"}),VehicleShowroom.attributes.add("prevButton",{type:"entity"}),VehicleShowroom.attributes.add("spawnPoint",{type:"entity"}),VehicleShowroom.attributes.add("driveButton",{type:"entity"}),VehicleShowroom.attributes.add("buyButton",{type:"entity"}),VehicleShowroom.attributes.add("coinIcon",{type:"entity"}),VehicleShowroom.attributes.add("vehiclePrice",{type:"entity"}),VehicleShowroom.attributes.add("confirmBuyButton",{type:"entity"}),VehicleShowroom.attributes.add("cancelBuyButton",{type:"entity"}),VehicleShowroom.attributes.add("showroomCamera",{type:"entity"}),VehicleShowroom.attributes.add("watchAdButton",{type:"entity"}),VehicleShowroom.prototype.initialize=function(){this._vehicle=null,this._spawnPosition=this.spawnPoint.getPosition(),this._showRoomLayer=this.app.scene.layers.getLayerByName("Showroom World"),this.entity.on("show",this._openShowroom,this),this.entity.on("hide",this._closeShowroom,this),this.nextButton.button.on("click",this._nextVehicle,this),this.prevButton.button.on("click",this._prevVehicle,this),this.driveButton.button.on("click",this._selectVehicle,this),this.watchAdButton.button.on("click",this._watchAdToUnlockVehicle,this)},VehicleShowroom.prototype.getViewingVehicleId=function(){return this._viewingVehicleId},VehicleShowroom.prototype.setViewingVehicleId=function(e){this._viewingVehicleId=parseInt(e)},VehicleShowroom.prototype._openShowroom=function(){this.showroomCamera.enabled=!0,this._setViewingVehicleToCurrentVehicle(),this._showVehicle(this._viewingVehicleId),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this)},VehicleShowroom.prototype._setViewingVehicleToCurrentVehicle=function(){if(this.app.globals.currentVehicle)for(let e in this.app.vehicles)if(this.app.globals.currentVehicle.vehicleName==this.app.vehicles[e].name)return void(this._viewingVehicleId=parseInt(e))},VehicleShowroom.prototype._closeShowroom=function(){this.showroomCamera.enabled=!1,this._destroyVehicle(this._vehicle),this.app.keyboard.off(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this)},VehicleShowroom.prototype._listenForKeyboardInput=function(e){this.app.globals.isAdPlaying||(e.key==pc.KEY_SPACE||e.key==pc.KEY_ENTER?this.driveButton.enabled&&this._selectVehicle():e.key==pc.KEY_LEFT||e.key==pc.KEY_A?this._prevVehicle():e.key!=pc.KEY_RIGHT&&e.key!=pc.KEY_D||this._nextVehicle())},VehicleShowroom.prototype._showVehicle=function(e){this._vehicle&&this._destroyVehicle(this._vehicle),this._viewingVehicleId=e,this._vehicle=this.app.vehicles[e].template.resource.instantiate(),this.spawnPoint.addChild(this._vehicle),this._vehicle.name=this.app.vehicles[e].name,this.entity.script.vehicleRepairUi.showVehicle(this.app.vehicles[e]),this._vehicle.sound.enabled=!1;let t=this.app.vehicles[e].displayPosition;this._vehicle.setPosition(this._spawnPosition.x+t.x,this._spawnPosition.y+t.y,this._spawnPosition.z+t.z),this._vehicle.rigidbody.teleport(this._vehicle.getPosition(),this._vehicle.getRotation()),this.app.isVehicleOwned(this.app.vehicles[e].name)?(this.buyButton.enabled=!1,this.cancelBuyButton.enabled=!1,this.confirmBuyButton.enabled=!1,this.watchAdButton.enabled=!1,this.coinIcon.enabled=!1,this.vehiclePrice.enabled=!1,this.driveButton.enabled=!0):(this.driveButton.enabled=!1,this.cancelBuyButton.enabled=!1,this.confirmBuyButton.enabled=!1,this.app.vehicles[e].watchAdToUnlock?(this.watchAdButton.enabled=!0,this.buyButton.enabled=!1,this.coinIcon.enabled=!1,this.vehiclePrice.enabled=!1):(this.watchAdButton.enabled=!1,this.buyButton.enabled=!0,this.coinIcon.enabled=!0,this.vehiclePrice.enabled=!0,this.app.vehicles[e].price>0?this.vehiclePrice.element.text=this.app.vehicles[e].price.toLocaleString():this.vehiclePrice.element.text="Free",this.app.playerStats.coins>=this.app.vehicles[e].price?(this.buyButton.button.active=!0,this.buyButton.button.on("click",this._attemptToBuy,this)):(this.buyButton.button.active=!1,this.buyButton.button.off("click",this._attemptToBuy,this)))),this.entity.script.vehicleStatsUi.showStats(this._vehicle),this.entity.fire("showroom:show",this.app.vehicles[e])},VehicleShowroom.prototype._destroyVehicle=function(){this.spawnPoint.removeChild(this._vehicle),this._vehicle.destroy()},VehicleShowroom.prototype._attemptToBuy=function(){if(this.app.vehicles[this._viewingVehicleId].price<=0){let e=this.app.vehicles[this._viewingVehicleId];this._buyVehicle(e)}else this._showBuyConfirmation()},VehicleShowroom.prototype._showBuyConfirmation=function(){this.buyButton.enabled=!1,this.driveButton.enabled=!1,this.coinIcon.enabled=!1,this.confirmBuyButton.enabled=!0,this.cancelBuyButton.enabled=!0,this.vehiclePrice.enabled=!1,this.confirmBuyButton.button.on("click",this._buyViewingVehicle,this),this.cancelBuyButton.button.on("click",this._cancelBuy,this),this.buyButton.button.off("click",this._attemptToBuy,this)},VehicleShowroom.prototype._buyVehicle=function(e){this.app.isVehicleOwned(e.name)||(this.app.fire("coins:spend",e.price),e.health=100,this.buyButton.enabled=!1,this.driveButton.enabled=!0,this.confirmBuyButton.enabled=!1,this.cancelBuyButton.enabled=!1,this.vehiclePrice.enabled=!0,this.coinIcon.enabled=!1,this.vehiclePrice.enabled=!1,this.confirmBuyButton.button.off(),this.buyButton.button.off(),this.app.fire("vehicle:purchase",e))},VehicleShowroom.prototype._cancelBuy=function(){this.buyButton.enabled=!0,this.confirmBuyButton.enabled=!1,this.cancelBuyButton.enabled=!1,this.driveButton.enabled=!1,this.coinIcon.enabled=!0,this.vehiclePrice.enabled=!0,this.confirmBuyButton.button.off(),this.cancelBuyButton.button.off(),this.buyButton.button.on("click",this._attemptToBuy,this)},VehicleShowroom.prototype._buyViewingVehicle=function(){this._buyVehicle(this.app.vehicles[this._viewingVehicleId])},VehicleShowroom.prototype._watchAdToUnlockVehicle=function(){this.app.keyboard.off(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this);let e=this.app.vehicles[this._viewingVehicleId];this.app.isVehicleOwned(e.name)||this.app.fire("poki:rewardedBreak:play",function(){this._unlockVehicle(e),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForKeyboardInput,this)}.bind(this),function(){}.bind(this))},VehicleShowroom.prototype._unlockVehicle=function(e){this.app.isVehicleOwned(e.name)||(e.health=100,this.watchAdButton.enabled=!1,this.driveButton.enabled=!0,this.app.fire("vehicle:purchase",e))},VehicleShowroom.prototype._nextVehicle=function(){this._viewingVehicleId+=1,this._viewingVehicleId>=this.app.vehicles.length&&(this._viewingVehicleId=0),this._showVehicle(this._viewingVehicleId)},VehicleShowroom.prototype._prevVehicle=function(){this._viewingVehicleId-=1,this._viewingVehicleId<0&&(this._viewingVehicleId=this.app.vehicles.length-1),this._showVehicle(this._viewingVehicleId)},VehicleShowroom.prototype._selectVehicle=function(){let e=this.app.vehicles[this._viewingVehicleId];this.app.fire("vehicle:select",e)},VehicleShowroom.prototype.update=function(e){if(this._vehicle){this._vehicle.rotate(0,1,0);let e=this._vehicle.getPosition();this._vehicle.setPosition(this._spawnPosition.x,e.y,this._spawnPosition.z),this._vehicle.rigidbody.teleport(this._vehicle.getPosition(),this._vehicle.getRotation())}};var VehicleRepairUi=pc.createScript("vehicleRepairUi");VehicleRepairUi.attributes.add("repairButton",{type:"entity"}),VehicleRepairUi.attributes.add("costLabel",{type:"entity"}),VehicleRepairUi.attributes.add("coinIcon",{type:"entity"}),VehicleRepairUi.attributes.add("healthBar",{type:"entity"}),VehicleRepairUi.attributes.add("watchAdRepairButton",{type:"entity"}),VehicleRepairUi.prototype.initialize=function(){this._repairCost=0,this._COST_FACTOR=.1,this._showingVehicle=null,this.entity.on("hide",this._hide,this),this.repairButton.button.on("click",this._payToRepair,this)},VehicleRepairUi.prototype._hide=function(){this.watchAdRepairButton.button.off()},VehicleRepairUi.prototype._payToRepair=function(){this.app.fire("coins:spend",this._repairCost),this._repair()},VehicleRepairUi.prototype._repair=function(){this.app.globals.currentVehicle.vehicleName==this._showingVehicle.name&&(this.app.globals.currentVehicle.wasJustRepaired=!0),this.app.playerStats.vehicles[this._showingVehicle.name].health=100,this.app.fire("vehicle:player:repair",this._showingVehicle.name,100),this.showVehicle(this._showingVehicle),this.healthBar.script.progressBar.setPercentage(1)},VehicleRepairUi.prototype.showVehicle=function(t){if(this._showingVehicle=t,this.app.isVehicleOwned(t.name)){let e=this.app.playerStats.vehicles[t.name].health;if(e>=99)this.repairButton.button.active=!1,this.repairButton.script.pulsingElement.stop(),this.costLabel.element.opacity=.6,this.costLabel.element.text="N/A",this.repairButton.element.opacity=.6,this.repairButton.findByName("Repair Coin Icon").element.opacity=.6,this._hideWatchAdRepairButton();else{this.repairButton.button.active=!0,this.watchAdRepairButton.button.active=!0,this.repairButton.element.opacity=1,this.watchAdRepairButton.element.opacity=1,this.watchAdRepairButton.script.shakyElement.play(),this.watchAdRepairButton.findByName("Text").element.opacity=1,this.watchAdRepairButton.findByName("Icon").element.opacity=1,this.repairButton.findByName("Repair Coin Icon").element.opacity=1,this._repairCost=this._calculateRepairCost(t);let i=parseInt(this._repairCost);this._repairCost<=0&&(i="Free"),this.costLabel.element.opacity=1,this.costLabel.element.text=i,this.app.playerStats.coins<this._repairCost?(this.repairButton.button.active=!1,this.repairButton.script.pulsingElement.stop()):(this.repairButton.button.active=!0,e<=1?this.repairButton.script.pulsingElement.play():this.repairButton.script.pulsingElement.stop()),this._repairCost<=0?this._hideWatchAdRepairButton():this._calculateRepairCost(this._showingVehicle)>0&&!this.app.globals.isTutorialRunning&&this._showWatchAdRepairButton()}}},VehicleRepairUi.prototype._calculateRepairCost=function(t){let e=this.app.playerStats.vehicles[t.name].health;return parseInt(t.price*this._COST_FACTOR*(100-e)/100)},VehicleRepairUi.prototype._showWatchAdRepairButton=function(){this.watchAdRepairButton.button.off(),this.watchAdRepairButton.script.shakyElement.play(),this.watchAdRepairButton.button.once("click",this._watchAdToRepair,this)},VehicleRepairUi.prototype._hideWatchAdRepairButton=function(){this.watchAdRepairButton.button.off(),this.watchAdRepairButton.element.opacity=.6,this.watchAdRepairButton.button.active=!1,this.watchAdRepairButton.script.shakyElement.stop(),this.watchAdRepairButton.findByName("Text").element.opacity=.6,this.watchAdRepairButton.findByName("Icon").element.opacity=.6},VehicleRepairUi.prototype._watchAdToRepair=function(){this.app.fire("poki:rewardedBreak:play",function(){this._repair()}.bind(this),function(){}.bind(this))};var Controls=pc.createScript("controls");Controls.attributes.add("touchControlGroup",{type:"entity"}),Controls.attributes.add("leftButton",{type:"entity",title:"Left Button"}),Controls.attributes.add("rightButton",{type:"entity",title:"Right Button"}),Controls.attributes.add("forwardButton",{type:"entity",title:"Forward Button"}),Controls.attributes.add("eBrakeButton",{type:"entity",title:"E-Brake Button"}),Controls.attributes.add("reverseButton",{type:"entity",title:"Reverse Button"}),Controls.prototype.initialize=function(){this.app.leftButtonPressed=!1,this.app.rightButtonPressed=!1,this.app.forwardButtonPressed=!1,this.app.eBrakeButtonPressed=!1,this.app.reverseButtonPressed=!1,this.app.keyboard.on(pc.EVENT_KEYDOWN,function(t){this.app.isUsingTouch&&this._disableTouchControls(),this.app.isUsingTouch=!1}.bind(this)),window.onblur=this._onBlur.bind(this),document.addEventListener("contextmenu",(t=>t.preventDefault())),window.addEventListener("keydown",(t=>{["ArrowDown","ArrowUp"," "].includes(t.key)&&t.preventDefault()})),window.addEventListener("wheel",(t=>t.preventDefault()),{passive:!1})},Controls.prototype.postInitialize=function(){pc.platform.touch?pc.platform.mobile?(this.app.isUsingTouch=!0,this._enableTouchControls()):this.app.touch.on(pc.EVENT_TOUCHSTART,function(t){t.event.preventDefault(),this.app.isUsingTouch||this.app.globals.isHomeScreenOpen||(this._enableTouchControls(),this.app.isUsingTouch=!0)}.bind(this)):this._disableTouchControls()},Controls.prototype._enableTouchControls=function(){this.app.graphicsDevice.height>this.app.graphicsDevice.width?this.app.globals.isTouchPortrait=!0:this.app.graphicsDevice.width>=this.app.graphicsDevice.height&&(this.app.globals.isTouchPortrait=!1),this.app.fire("ui:touch:enable"),this.touchControlGroup.enabled=!0,this.leftButton.button.on("pressedstart",function(t){this.app.leftButtonPressed=!0}.bind(this)),this.leftButton.button.on("pressedend",function(t){this.app.leftButtonPressed=!1}.bind(this)),this.rightButton.button.on("pressedstart",function(t){this.app.rightButtonPressed=!0}.bind(this)),this.rightButton.button.on("pressedend",function(t){this.app.rightButtonPressed=!1}.bind(this)),this.forwardButton.button.on("pressedstart",function(t){this.app.forwardButtonPressed=!0}.bind(this)),this.forwardButton.button.on("pressedend",function(t){this.app.forwardButtonPressed=!1}.bind(this)),this.eBrakeButton.button.on("pressedstart",function(t){this.app.eBrakeButtonPressed=!0}.bind(this)),this.eBrakeButton.button.on("pressedend",function(t){this.app.eBrakeButtonPressed=!1}.bind(this)),this.reverseButton.button.on("pressedstart",function(t){this.app.reverseButtonPressed=!0}.bind(this)),this.reverseButton.button.on("pressedend",function(t){this.app.reverseButtonPressed=!1}.bind(this))},Controls.prototype._disableTouchControls=function(){this.app.fire("ui:touch:disable"),this.touchControlGroup.enabled=!1,this.leftButton.button.off("pressedstart"),this.leftButton.button.off("pressedend"),this.rightButton.button.off("pressedstart"),this.rightButton.button.off("pressedend"),this.forwardButton.button.off("pressedstart"),this.forwardButton.button.off("pressedend"),this.eBrakeButton.button.off("pressedstart"),this.eBrakeButton.button.off("pressedend"),this.reverseButton.button.off("pressedstart"),this.reverseButton.button.off("pressedend")},Controls.prototype._onBlur=function(){this.app.leftButtonPressed=!1,this.app.rightButtonPressed=!1,this.app.forwardButtonPressed=!1,this.app.eBrakeButtonPressed=!1,this.app.reverseButtonPressed=!1,this.app.fire("window:blur")};var GameHud=pc.createScript("gameHud");GameHud.attributes.add("coins",{type:"entity"}),GameHud.attributes.add("miniMap",{type:"entity"}),GameHud.attributes.add("eBrakeIcon",{type:"entity"}),GameHud.attributes.add("homeButton",{type:"entity"}),GameHud.attributes.add("jobsButton",{type:"entity"}),GameHud.attributes.add("regionName",{type:"entity"}),GameHud.attributes.add("boostButton",{type:"entity"}),GameHud.attributes.add("damageGroup",{type:"entity"}),GameHud.attributes.add("deliverButton",{type:"entity"}),GameHud.attributes.add("regionsButton",{type:"entity"}),GameHud.attributes.add("offerBoostButton",{type:"entity"}),GameHud.attributes.add("touchControlGroup",{type:"entity"}),GameHud.prototype.initialize=function(){this._jobsButtonVisible=!0,this.app.on("job:roam",this._showTouchControlGroup,this),this.app.on("job:start",this._showTouchControlGroup,this),this.app.on("ui:touch:disable",this._enableDesktopHUD,this),this.app.on("ui:touch:enable",this._enableMobileHUD,this)},GameHud.prototype.update=function(t){if(!this.app.isUsingTouch&&this.app.globals.isDriving&&this.app.globals.currentVehicle){let t=this.app.globals.currentVehicle.script.vehicleControls.shiftKeyPressed;this.eBrakeIcon.element.opacity=t?.7:.001}},GameHud.prototype._showTouchControlGroup=function(){this.app.isUsingTouch&&(this.touchControlGroup.enabled=!0)},GameHud.prototype._hideTouchControlGroup=function(){this.touchControlGroup.enabled=!1},GameHud.prototype.hide=function(){this.coins.enabled=!1,this.miniMap.enabled=!1,this.regionName.enabled=!1,this.homeButton.enabled=!1,this.jobsButton.enabled=!1,this.boostButton.enabled=!1,this.damageGroup.enabled=!1,this.regionsButton.enabled=!1,this.offerBoostButton.enabled=!1,this.touchControlGroup.enabled=!1},GameHud.prototype.show=function(){this.coins.enabled=!0,this.miniMap.enabled=!0,this.regionName.enabled=!0,this.homeButton.enabled=!0,this.boostButton.enabled=!0,this.damageGroup.enabled=!0,this.app.isUsingTouch&&(this.touchControlGroup.enabled=!0),this._jobsButtonVisible&&(this.jobsButton.enabled=!0)},GameHud.prototype._enableDesktopHUD=function(){this.eBrakeIcon.enabled=!0,this.eBrakeIcon.opacity=.001,this.miniMap.element.anchor=[0,0,0,0],this.miniMap.element.pivot=[0,0],this.miniMap.element.left=0,this.miniMap.element.bottom=180,this.miniMap.element.top=0,this.regionName.element.anchor=[0,0,0,0],this.regionName.element.pivot=[0,0],this.regionName.element.alignment=[0,.5],this.regionName.setLocalPosition(10,180,0),this.homeButton.element.anchor=[0,1,0,1],this.homeButton.setLocalPosition(60,-60,0),this.jobsButton.element.anchor=[0,1,0,1],this.jobsButton.setLocalPosition(165,-60,0),this.coins.element.pivot=[1,1],this.coins.element.anchor=[1,1,1,1],this.coins.setLocalPosition(0,0,0),this.deliverButton.element.pivot=[.5,.5],this.deliverButton.element.anchor=[.5,.5,.5,.5],this.deliverButton.setLocalPosition(0,-150,0),this.boostButton.setLocalPosition(-100,100,0),this.damageGroup.setLocalPosition(0,32,0),this.entity.script.deliveryGameOfferRewardedBoost.setDesktopMode()},GameHud.prototype._enableMobileHUD=function(){this.eBrakeIcon.enabled=!1,this.miniMap.element.anchor=[1,1,1,1],this.miniMap.element.pivot=[1,1],this.miniMap.element.right=0,this.miniMap.element.top=180,this.miniMap.element.bottom=0,this.regionName.element.anchor=[1,1,1,1],this.regionName.element.pivot=[1,1],this.regionName.element.alignment=[1,.5],this.regionName.setLocalPosition(-10,-180,0),this.homeButton.element.anchor=[1,1,1,1],this.homeButton.setLocalPosition(-310,-60,0),this.jobsButton.element.anchor=[1,1,1,1],this.jobsButton.setLocalPosition(-420,-60,0),this.coins.element.pivot=[0,1],this.coins.element.anchor=[0,1,0,1],this.coins.setLocalPosition(120,0,0),this.deliverButton.element.pivot=[0,.5],this.deliverButton.element.anchor=[0,.5,0,.5],this.deliverButton.setLocalPosition(15,0,0),this.boostButton.setLocalPosition(-280,320,0),this.damageGroup.setLocalPosition(-100,32,0)},GameHud.prototype.showJobsButton=function(){this._jobsButtonVisible=!0,this.jobsButton.enabled=!0},GameHud.prototype.hideJobsButton=function(){this._jobsButtonVisible=!1,this.jobsButton.enabled=!1};var TouchUiLayout=pc.createScript("touchUiLayout");TouchUiLayout.attributes.add("steeringGroup",{type:"entity"}),TouchUiLayout.attributes.add("leftButton",{type:"entity"}),TouchUiLayout.attributes.add("rightButton",{type:"entity"}),TouchUiLayout.attributes.add("forwardButton",{type:"entity"}),TouchUiLayout.attributes.add("reverseButton",{type:"entity"}),TouchUiLayout.attributes.add("eBrakeButton",{type:"entity"}),TouchUiLayout.attributes.add("coins",{type:"entity"}),TouchUiLayout.attributes.add("pageBackButton",{type:"entity"}),TouchUiLayout.attributes.add("pageScreenName",{type:"entity"}),TouchUiLayout.attributes.add("pageScreenCoins",{type:"entity"}),TouchUiLayout.attributes.add("damageGroup",{type:"entity"}),TouchUiLayout.attributes.add("boostButton",{type:"entity"}),TouchUiLayout.attributes.add("activeJob",{type:"entity"}),TouchUiLayout.attributes.add("gameHud",{type:"entity"}),TouchUiLayout.attributes.add("jobFailedGroup",{type:"entity"}),TouchUiLayout.attributes.add("jobCompleteGroup",{type:"entity"}),TouchUiLayout.attributes.add("homeScreenCamera",{type:"entity"}),TouchUiLayout.attributes.add("homeRegionsButton",{type:"entity"}),TouchUiLayout.attributes.add("homeJobsButton",{type:"entity"}),TouchUiLayout.attributes.add("homeSkillsButton",{type:"entity"}),TouchUiLayout.attributes.add("homeGarageButton",{type:"entity"}),TouchUiLayout.prototype.initialize=function(){this.app.on("ui:touch:disable",this._updateLayout,this),this.app.on("ui:touch:enable",this._updateLayout,this),this.app.on("vehicle:player:ready",this._updateLayout,this),this.app.on("ui:home:page:show",this._setHomePageLayout,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this)},TouchUiLayout.prototype._updateLayout=function(){this.app.isUsingTouch&&(this.app.graphicsDevice.height>this.app.graphicsDevice.width?this.app.globals.isTouchPortrait=!0:this.app.graphicsDevice.width>=this.app.graphicsDevice.height&&(this.app.globals.isTouchPortrait=!1),this.app.globals.isTouchPortrait?this._setPortraitMode():this._setLandscapeMode(),this._setHomePageLayout())},TouchUiLayout.prototype._setPortraitMode=function(){this.steeringGroup.element.bottom=220,this.coins.element.pivot=[1,1],this.coins.element.anchor=[1,1,1,1],this.coins.setLocalPosition(-16,-210,0),this.damageGroup.setLocalPosition(-100,164,0),this.boostButton.setLocalPosition(-80,460,0),this.activeJob.setLocalPosition(-120,-120,0),this.jobFailedGroup.setLocalPosition(0,-300,0),this.jobCompleteGroup.setLocalPosition(0,-300,0),this.gameHud.script.deliveryGameOfferRewardedBoost.setMobilePortraitMode(),this.homeRegionsButton.setLocalPosition(181.344,-250,0),this.homeJobsButton.setLocalPosition(181.344,-365,0),this.homeSkillsButton.setLocalPosition(181.344,-480,0),this.homeGarageButton.setLocalPosition(181.344,-595,0)},TouchUiLayout.prototype._setLandscapeMode=function(){this.steeringGroup.element.bottom=0,this.coins.element.pivot=[0,1],this.coins.element.anchor=[0,1,0,1],this.coins.setLocalPosition(120,0,0),this.damageGroup.setLocalPosition(-100,32,0),this.boostButton.setLocalPosition(-280,320,0),this.activeJob.setLocalPosition(-132,0,0),this.jobFailedGroup.setLocalPosition(-100,0,0),this.jobCompleteGroup.setLocalPosition(0,-120,0),this.gameHud.script.deliveryGameOfferRewardedBoost.setMobileLandscapeMode(),this.homeRegionsButton.setLocalPosition(181.344,-180,0),this.homeJobsButton.setLocalPosition(181.344,-295,0),this.homeSkillsButton.setLocalPosition(181.344,-410,0),this.homeGarageButton.setLocalPosition(181.344,-525,0)},TouchUiLayout.prototype._setHomePageLayout=function(){this.app.isUsingTouch&&this.app.globals.isTouchPortrait?(this.pageScreenName.script.pageAnimation.enabled=!1,this.pageScreenCoins.script.pageAnimation.enabled=!1,this.pageBackButton.element.pivot=[.5,.5],this.pageBackButton.element.anchor=[0,.5,0,.5],this.pageBackButton.setLocalPosition(156,36,0),this.pageScreenName.element.pivot=[0,.5],this.pageScreenName.element.anchor=[0,.5,0,.5],this.pageScreenName.setLocalPosition(270,36,0),this.pageScreenCoins.element.pivot=[0,.5],this.pageScreenCoins.element.anchor=[0,.5,0,.5],this.pageScreenCoins.setLocalPosition(250,-48,0),this.homeScreenCamera.camera.fov=70,this.homeScreenCamera.setLocalPosition(32.5,-33.66,-804.197)):this.app.isUsingTouch&&!this.app.globals.isTouchPortrait&&(this.pageScreenName.script.pageAnimation.enabled=!0,this.pageScreenCoins.script.pageAnimation.enabled=!0,this.pageBackButton.element.pivot=[.5,.5],this.pageBackButton.element.anchor=[0,.5,0,.5],this.pageBackButton.setLocalPosition(250,0,0),this.pageScreenName.element.pivot=[0,.5],this.pageScreenName.element.anchor=[0,.5,0,.5],this.pageScreenName.setLocalPosition(320,0,0),this.pageScreenCoins.element.pivot=[1,.5],this.pageScreenCoins.element.anchor=[1,.5,1,.5],this.pageScreenCoins.setLocalPosition(-204,0,0),this.homeScreenCamera.camera.fov=53,this.homeScreenCamera.setLocalPosition(31.624,-35.515,-804.197))};var Despawner=pc.createScript("despawner");Despawner.attributes.add("vehicleTrafficSystem",{type:"entity"}),Despawner.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},Despawner.prototype.onTriggerEnter=function(e){e.tags.has("npc-car")&&this.vehicleTrafficSystem.script.vehicleTraffic.despawn(e)};var RegionData=pc.createScript("regionData");RegionData.prototype.initialize=function(){this.app.regions={Docks:{name:"Docks",description:"A busy port, where ships dock and unload cargo. Towering cranes and warehouses line the waterfront.",population:2500,tipStars:3,unlockCost:1500,isUnlocked:!1},"The Cove":{name:"The Cove",description:"Where the wealthy elite reside in privacy and luxury. Sprawling mansions and yachts are a common sight.",population:800,tipStars:5,unlockCost:3e3,isUnlocked:!1},"South Beach":{name:"South Beach",description:"A beachside district with waterfront restaurants, hotels, and a vibrant social scene.",population:5500,tipStars:3,unlockCost:2e3,isUnlocked:!1},Middleport:{name:"Middleport",description:"A middle-class neighborhood with tree-lined streets and well-maintained houses.",population:3500,tipStars:2,unlockCost:750,isUnlocked:!1},Downtown:{name:"Downtown",description:"The heart of the city. Home to towering skyscrapers, shops, cafes, and Vortelli's Pizza.",population:5e3,tipStars:1,unlockCost:0,isUnlocked:!1}}};var GameLoader=pc.createScript("gameLoader");GameLoader.attributes.add("mapChunks",{array:!0,type:"entity"}),GameLoader.prototype.initialize=function(){this._isGameLoaded=!1,this._statsLoaded=!1,this._firstMapChunkLoaded=!1,this.app.on("stats:loaded",this._setStatsLoaded,this),this.app.on("map:chunk:load",this._setMapChunkLoaded,this)},GameLoader.prototype._setStatsLoaded=function(){this._statsLoaded=!0,this._checkGameLoaded(),this._preloadMapChunks()},GameLoader.prototype._setMapChunkLoaded=function(a){this._firstMapChunkLoaded=!0,this._checkGameLoaded()},GameLoader.prototype._checkGameLoaded=function(){this._isGameLoaded||this._statsLoaded&&this._firstMapChunkLoaded&&(this._isGameLoaded=!0,this.app.fire("game:loaded"))},GameLoader.prototype._preloadMapChunks=function(){for(const[a,e]of Object.entries(this.app.playerStats.regions))e.isUnlocked&&this.preloadMapChunk(a)},GameLoader.prototype.preloadMapChunk=function(a,e){for(let t in this.mapChunks){let o=this.mapChunks[t].script.mapChunk;o.isLoaded()||a==this.mapChunks[t].name&&(o.preload(e),o.unload())}};var GearBox=pc.createScript("gearBox");GearBox.attributes.add("acceleration",{array:!0,type:"json",schema:[{name:"accelerationTime",type:"number",default:3},{name:"rpmCurve",type:"curve"}]}),GearBox.attributes.add("gearShifts",{array:!0,type:"json",schema:[{name:"shiftTime",type:"number",default:.25},{name:"rpmCurve",type:"curve"}]}),GearBox.prototype.initialize=function(){this.numGears=this.acceleration.length,this.rpm=this.acceleration[0].rpmCurve.value(0),this.gear=1,this._shiftSCountdown=0,this._accelerationS=0,this._isSlowing=!1},GearBox.prototype.getSoundPitch=function(){return this.rpm/4e3},GearBox.prototype.applyInput=function(t,e,i,s){if(i>0)if(this._isSlowing&&(this._isSlowing=!1,this._pickAGear()),this.isShifting()){this._shiftSCountdown-=t;let e=this.gear-1;e>=this.gearShifts.length&&(e=this.gearShifts.length-1);let i=this.gearShifts[e].shiftTime,s=1-this._shiftSCountdown/i;this.rpm=this.gearShifts[e].rpmCurve.value(s),this._shiftSCountdown<=0&&(this._shiftSCountdown=0,this.gear+=1,this._accelerationS=0)}else try{this._accelerationS+=t;let e=this.acceleration[this.gear-1].accelerationTime;if(this._accelerationS>=e)this._shiftUp();else{let t=this._accelerationS/e;this.rpm=this.acceleration[this.gear-1].rpmCurve.value(t)}}catch(t){}else i<0?this.entity.script.vehicle.speed<0&&(this.gear=-1):(this._isSlowing=!0,this.rpm*=.95)},GearBox.prototype._pickAGear=function(){if(this.entity.script.vehicle.speed<0)this.gear=1;else{let t=Math.abs(this.entity.script.vehicle.speed)/this.entity.script.vehicle.maxSpeed;this.gear=1+Math.floor(t*this.numGears),this.gear>this.numGears&&(this.gear=this.numGears)}this.rpm=this.acceleration[this.gear-1].rpmCurve.value(0),this._accelerationS=0},GearBox.prototype._shiftUp=function(){this.gear<this.acceleration.length&&(this._accelerationS=0,this._shiftSCountdown=this.gearShifts[this.gear-1].shiftTime)},GearBox.prototype._shiftDown=function(){this.gear>1?(this._shiftSCountdown=this.gearShifts[this.gear-2].shiftTime,this._accelerationS=this.acceleration[this.gear-2].accelerationTime):this._accelerationS=0},GearBox.prototype.isShifting=function(){return this._shiftSCountdown>0};var DestructibleGroup=pc.createScript("destructibleGroup");DestructibleGroup.attributes.add("dependants",{type:"entity",array:!0}),DestructibleGroup.prototype.initialize=function(){};var HomeScreen=pc.createScript("homeScreen");HomeScreen.attributes.add("showroomCamera",{type:"entity"}),HomeScreen.attributes.add("pageCanvas",{type:"entity"}),HomeScreen.attributes.add("driveButton",{type:"entity"}),HomeScreen.attributes.add("pageButtons",{array:!0,type:"entity"}),HomeScreen.prototype.initialize=function(){for(let e in this.pageButtons)this.pageButtons[e].on("show",this.showPage,this);this.driveButton.button.on("click",this._drive,this),this.pageCanvas.on("back",this.hideCurrentPage,this),this.pageCanvas.on("drive",this._drive,this),this.showroomCamera.enabled=!0},HomeScreen.prototype.showPage=function(e){this.app.fire("ui:home:page:show",e),this.pageCanvas.enabled=!0,this.pageCanvas.script.pageCanvas.show(e)},HomeScreen.prototype.hideCurrentPage=function(){this.app.fire("ui:home:page:hide"),this.pageCanvas.script.pageCanvas.hide(),this.pageCanvas.enabled=!1},HomeScreen.prototype._drive=function(){this.entity.fire("drive")},HomeScreen.prototype.show=function(){this.app.globals.isHomeScreenOpen=!0,this.app.fire("ui:home:show"),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForDriveKeys,this)},HomeScreen.prototype.hide=function(){this.hideCurrentPage(),this.app.globals.isHomeScreenOpen=!1,this.app.fire("ui:home:hide"),this.app.keyboard.off(pc.EVENT_KEYDOWN,this._listenForDriveKeys,this)},HomeScreen.prototype._listenForDriveKeys=function(e){this.pageCanvas.enabled||e.key!=pc.KEY_SPACE&&e.key!=pc.KEY_ENTER||this.app.globals.isAdPlaying||this._drive()};var PageButton=pc.createScript("pageButton");PageButton.attributes.add("page",{type:"entity"}),PageButton.attributes.add("icon",{type:"entity"}),PageButton.attributes.add("lockIcon",{type:"entity"}),PageButton.attributes.add("textLabel",{type:"entity"}),PageButton.prototype.initialize=function(){this.entity.button.on("click",this._showPage,this)},PageButton.prototype._showPage=function(){this.entity.fire("show",this.page)},PageButton.prototype.lock=function(){this.entity.button.active=!1,this.entity.button.opacity=.66,this.icon.element.opacity=.5,this.textLabel.element.opacity=.5,this.lockIcon.enabled=!0},PageButton.prototype.unlock=function(){this.entity.button.active=!0,this.entity.button.opacity=1,this.icon.element.opacity=1,this.textLabel.element.opacity=1,this.lockIcon.enabled=!1};var Page=pc.createScript("page");Page.attributes.add("name",{type:"string"}),Page.attributes.add("animatedEntities",{type:"entity",array:!0}),Page.attributes.add("showCoinCount",{type:"boolean",default:!0}),Page.attributes.add("returnToDrive",{type:"boolean",default:!1,description:"Page returns to driving state instead of home screen"}),Page.prototype.initialize=function(){this.entity.on("show",this._show,this)},Page.prototype._show=function(){for(let t in this.animatedEntities){let e=this.animatedEntities[t];e.script.pageAnimation&&e.script.pageAnimation.play()}};var PageAnimation=pc.createScript("pageAnimation");PageAnimation.attributes.add("animTimeS",{type:"number",default:.25,description:"Length of animation in seconds."}),PageAnimation.attributes.add("position",{type:"curve",curves:["x","y"]}),PageAnimation.attributes.add("opacity",{type:"curve",default:{keys:[0,1,1,1],type:pc.CURVE_SPLINE}}),PageAnimation.prototype.initialize=function(){this._animTimeCountdownS=0},PageAnimation.prototype.play=function(){this._animTimeCountdownS=this.animTimeS},PageAnimation.prototype.update=function(i){if(this._animTimeCountdownS>0){this._animTimeCountdownS-=i;let t=1-this._animTimeCountdownS/this.animTimeS;this.entity.element.opacity=this.opacity.value(t);let n=this.position.value(t),e=this.entity.getLocalPosition();this.entity.setLocalPosition(n[0],n[1],e.z)}};var RegionsPage=pc.createScript("regionsPage");RegionsPage.attributes.add("mapElement",{type:"entity"}),RegionsPage.attributes.add("mapLoading",{type:"entity"}),RegionsPage.attributes.add("assetsLoading",{type:"entity"}),RegionsPage.attributes.add("gameLoader",{type:"entity"}),RegionsPage.attributes.add("regionName",{type:"entity"}),RegionsPage.attributes.add("population",{type:"entity"}),RegionsPage.attributes.add("populationLabel",{type:"entity"}),RegionsPage.attributes.add("unlockCost",{type:"entity"}),RegionsPage.attributes.add("unlockButton",{type:"entity"}),RegionsPage.attributes.add("coinIcon",{type:"entity"}),RegionsPage.attributes.add("tipLabel",{type:"entity"}),RegionsPage.attributes.add("tipStars",{type:"entity"}),RegionsPage.attributes.add("blurb",{type:"entity"}),RegionsPage.attributes.add("regionButtons",{type:"entity",array:!0}),RegionsPage.attributes.add("defaultSelected",{type:"entity"}),RegionsPage.attributes.add("confirmGroup",{type:"entity"}),RegionsPage.attributes.add("confirmButton",{type:"entity"}),RegionsPage.attributes.add("confirmCost",{type:"entity"}),RegionsPage.attributes.add("cancelButton",{type:"entity"}),RegionsPage.attributes.add("firstVisitButton",{type:"entity"}),RegionsPage.attributes.add("infoContainer",{type:"entity"}),RegionsPage.attributes.add("mapContainer",{type:"entity"}),RegionsPage.prototype.initialize=function(){this._currentRegionInfo=null,this.entity.on("show",this._show,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this);let t=this.mapElement.element.textureAsset;this.app.assets.get(t).ready(function(){this.mapLoading.enabled=!1;for(let t in this.regionButtons){this.regionButtons[t].enabled=!0}}.bind(this));for(let t in this.regionButtons)this.regionButtons[t].on("inspect",this.showRegionInfo,this);this.unlockButton.button.on("click",this._unlockConfirm,this),this.confirmButton.button.on("click",this._unlockRegion,this),this.cancelButton.button.on("click",this._hideUnlockConfirm,this)},RegionsPage.prototype._show=function(){this._updateLayout(),this._updateRegionMap(),null!=this.app.globals.proximityMapChunk?this.showRegionInfo(this.app.regions[this.app.globals.proximityMapChunk.name]):this.showRegionInfo(this.app.regions.Downtown)},RegionsPage.prototype._unlockConfirm=function(){this._currentRegionInfo.unlockCost>0?(this.confirmGroup.enabled=!0,this.unlockCost.enabled=!1,this.unlockButton.enabled=!1,this.coinIcon.enabled=!1):this._unlockRegion()},RegionsPage.prototype._hideUnlockConfirm=function(){this.confirmGroup.enabled=!1,this.unlockCost.enabled=!0,this.unlockButton.enabled=!0,this.coinIcon.enabled=!0},RegionsPage.prototype._unlockRegion=function(){this.app.playerStats.coins>=this._currentRegionInfo.unlockCost&&(this.app.playerStats.regions[this._currentRegionInfo.name].isUnlocked=!0,this.app.fire("coins:spend",this._currentRegionInfo.unlockCost),this.app.fire("region:unlock",this._currentRegionInfo.name),this._hideUnlockConfirm(),this._updateRegionMap(),this.showRegionInfo(this._currentRegionInfo),"Downtown"!=this._currentRegionInfo.name&&(this._showLoadingState(),this.app.fire("ui:home:back:lock"),this.gameLoader.script.gameLoader.preloadMapChunk(this._currentRegionInfo.name,function(){this.showRegionInfo(this._currentRegionInfo),this.app.fire("ui:home:back:unlock"),this.app.fire("highway:pass:add"),this.firstVisitButton.enabled=!0,this.firstVisitButton.button.on("click",function(){this.app.fire("region:travel",this.app.regions[this._currentRegionInfo.name])}.bind(this),this)}.bind(this))))},RegionsPage.prototype.showRegionInfo=function(t){this._hideUnlockConfirm(),this.assetsLoading.enabled=!1,this._currentRegionInfo=t,this.regionName.element.text=t.name,this.blurb.enabled=!0,this.population.enabled=!0,this.populationLabel.enabled=!0,this.firstVisitButton.enabled=!1,this.firstVisitButton.button.off(),this.population.element.text=t.population.toLocaleString(),t.unlockCost>0?(this.unlockCost.element.text=t.unlockCost.toLocaleString(),this.confirmCost.enabled=!0,this.confirmCost.element.text=t.unlockCost.toLocaleString()+"?"):this.unlockCost.element.text="Free",this.blurb.element.text=t.description,this.tipLabel.enabled=!0,this.tipStars.enabled=!0;for(let e in this.tipStars.children){let i=this.tipStars.children[e];e<t.tipStars?i.element.opacity=1:i.element.opacity=.2}this.app.playerStats.regions[t.name].isUnlocked?(this.coinIcon.enabled=!1,this.unlockCost.enabled=!1,this.unlockButton.enabled=!1):(this.coinIcon.enabled=!0,this.unlockCost.enabled=!0,this.unlockButton.enabled=!0,this.app.playerStats.coins>=t.unlockCost?(this.unlockButton.element.opacity=1,this.unlockButton.button.active=!0):(this.unlockButton.element.opacity=.5,this.unlockButton.button.active=!1));for(let e in this.regionButtons)this.regionButtons[e].script.regionButton.updateDisplayState(t.name)},RegionsPage.prototype._showLoadingState=function(){this.assetsLoading.enabled=!0,this.regionName.enabled=!0,this.population.enabled=!1,this.populationLabel.enabled=!1,this.coinIcon.enabled=!1,this.unlockCost.enabled=!1,this.confirmCost.enabled=!1,this.unlockButton.enabled=!1,this.tipLabel.enabled=!1,this.tipStars.enabled=!1,this.blurb.enabled=!1},RegionsPage.prototype._updateRegionMap=function(){for(let t in this.regionButtons)this.regionButtons[t].script.regionButton.updateDisplayState()},RegionsPage.prototype._updateLayout=function(){this.app.globals.isTouchPortrait?this._showPortraitLayout():this._showLandscapeLayout()},RegionsPage.prototype._showPortraitLayout=function(){this.infoContainer.script.pageAnimation.enabled=!1,this.mapContainer.script.pageAnimation.enabled=!1,this.infoContainer.setLocalPosition(300,-250,0),this.mapContainer.setLocalPosition(-140,250,0)},RegionsPage.prototype._showLandscapeLayout=function(){this.infoContainer.script.pageAnimation.enabled=!0,this.mapContainer.script.pageAnimation.enabled=!0,this.infoContainer.setLocalPosition(0,0,0),this.mapContainer.setLocalPosition(0,0,0)};var DeliveryGameJobComplete=pc.createScript("deliveryGameJobComplete");DeliveryGameJobComplete.attributes.add("awardTemplate",{type:"asset",assetType:"template"}),DeliveryGameJobComplete.attributes.add("awardsContainer",{type:"entity"}),DeliveryGameJobComplete.attributes.add("watchAdButton",{type:"entity"}),DeliveryGameJobComplete.attributes.add("animatedElements",{type:"entity",array:!0}),DeliveryGameJobComplete.prototype.initialize=function(){this.app.on("ui:home:show",this.hide,this),this._waitingAwards=[],this._timeSUntilShowWatchAdButton=0},DeliveryGameJobComplete.prototype.isVisible=function(){return this._waitingAwards.length>0||this._timeSUntilShowWatchAdButton>0||this.watchAdButton.enabled},DeliveryGameJobComplete.prototype.setAwards=function(t){this._waitingAwards=t,this._timeSUntilNextAward=.05},DeliveryGameJobComplete.prototype.offerBonus=function(t,e){this._timeSUntilShowWatchAdButton=2.5;let i=parseInt(t).toLocaleString();this.watchAdButton.findByName("Bonus Amount").element.text="+"+i,this.watchAdButton.button.off("click"),this.watchAdButton.button.once("click",e,this)},DeliveryGameJobComplete.prototype.show=function(){for(let t in this.animatedElements)this.animatedElements[t].enabled=!0,this.animatedElements[t].script.uiElementAnimation.start();this.watchAdButton.script.uiElementAnimation.isRunning&&(this.watchAdButton.enabled=!0)},DeliveryGameJobComplete.prototype.hide=function(){this._clear(),this._timeSUntilShowWatchAdButton=0,this.watchAdButton.script.uiElementAnimation.stop(),this.watchAdButton.enabled=!1;for(let t in this.animatedElements)this.animatedElements[t].script.uiElementAnimation.stop(),this.animatedElements[t].enabled=!1},DeliveryGameJobComplete.prototype._clear=function(){this._waitingAwards=[],this._timeSUntilNextAward=0;for(let t=this.awardsContainer.children.length-1;t>=0;t--){let e=this.awardsContainer.children[t];this.awardsContainer.removeChild(e),e.destroy()}},DeliveryGameJobComplete.prototype.update=function(t){this._timeSUntilNextAward>0&&(this._timeSUntilNextAward-=t,this._timeSUntilNextAward<0&&this._waitingAwards.length>0&&(this._renderNewAward(),this._timeSUntilNextAward=.8+pc.math.random(.2,.4))),this._timeSUntilShowWatchAdButton>0&&(this._timeSUntilShowWatchAdButton-=t,this._timeSUntilShowWatchAdButton<=0&&(this.watchAdButton.enabled=!0,this.watchAdButton.script.uiElementAnimation.start()))},DeliveryGameJobComplete.prototype._renderNewAward=function(){let t=this._waitingAwards.shift(),e=this.awardTemplate.resource.instantiate();this.awardsContainer.addChild(e),e.setLocalPosition(0,0,0),e.script.deliveryGameAward.populate(t);let i=this.awardsContainer.element.width,a=1.1*e.element.width,n=(i-this.awardsContainer.children.length*a)/2-400;for(let t in this.awardsContainer.children){let e=n+t*a;this.awardsContainer.children[t].script.deliveryGameAward.setTargetPosition(e,0,0)}};var DeliveryGameAward=pc.createScript("deliveryGameAward");DeliveryGameAward.attributes.add("background",{type:"entity"}),DeliveryGameAward.attributes.add("awardName",{type:"entity"}),DeliveryGameAward.attributes.add("awardIcon",{type:"entity"}),DeliveryGameAward.attributes.add("awardValue",{type:"entity"}),DeliveryGameAward.attributes.add("scaleTimeS",{type:"number",default:.5}),DeliveryGameAward.attributes.add("scaleCurve",{type:"curve"}),DeliveryGameAward.prototype.initialize=function(){this._scaleCountdownS=this.scaleTimeS,this._targetPosition=new pc.Vec3},DeliveryGameAward.prototype.populate=function(e){this.awardName.element.text=e.name,this.awardIcon.element.spriteAsset=e.icon,this.awardValue.element.text="+"+e.value,"dough-pizza-icon"==e.icon.name&&(this.awardIcon.element.color=new pc.Color(1,1,1,1))},DeliveryGameAward.prototype.setTargetPosition=function(e,t,a){this._targetPosition.set(e,t,a)},DeliveryGameAward.prototype.update=function(e){if(this._scaleCountdownS>0){this._scaleCountdownS-=e;let t=1-this._scaleCountdownS/this.scaleTimeS,a=this.scaleCurve.value(t);this.entity.setLocalScale(a,a,a)}let t=this.entity.getLocalPosition();t.x!=this._targetPosition.x&&(t.x=pc.math.lerp(t.x,this._targetPosition.x,.08),this.entity.setLocalPosition(t))};var ShakyElement=pc.createScript("shakyElement");ShakyElement.attributes.add("rotationTimeS",{type:"number",default:2}),ShakyElement.attributes.add("rotationCurve",{type:"curve"}),ShakyElement.attributes.add("rotationMultiplier",{type:"number",default:1}),ShakyElement.attributes.add("continuous",{type:"boolean",default:!1}),ShakyElement.attributes.add("autoPlay",{type:"boolean",default:!1}),ShakyElement.prototype.initialize=function(){this._rotationCountdownS=0,this.autoPlay&&(this._rotationCountdownS=this.rotationTimeS)},ShakyElement.prototype.play=function(){this._rotationCountdownS=this.rotationTimeS},ShakyElement.prototype.stop=function(){this._rotationCountdownS=0;let t=1-this._rotationCountdownS/this.rotationTimeS,o=this.rotationCurve.value(t),e=this.entity.getEulerAngles();e.z=o,this.entity.setEulerAngles(e)},ShakyElement.prototype.update=function(t){if(this._rotationCountdownS>0){this._rotationCountdownS-=t;let o=1-this._rotationCountdownS/this.rotationTimeS,e=this.rotationCurve.value(o)*this.rotationMultiplier,n=this.entity.getEulerAngles();n.z=e,this.entity.setEulerAngles(n),this.continuous&&this._rotationCountdownS<=0&&(this._rotationCountdownS=this.rotationTimeS)}};var DeliveryGameResultsScreen=pc.createScript("deliveryGameResultsScreen");DeliveryGameResultsScreen.attributes.add("jobComplete",{type:"entity"}),DeliveryGameResultsScreen.attributes.add("jobFailed",{type:"entity"}),DeliveryGameResultsScreen.prototype.initialize=function(){this.app.on("job:roam",this._hide,this),this.app.on("job:time:up",this._showJobTimeUp,this),this.app.on("job:complete",this._showJobComplete,this)},DeliveryGameResultsScreen.prototype.isVisible=function(){return this.jobComplete.script.deliveryGameJobComplete.isVisible()||this.jobFailed.script.deliveryGameJobFailed.isVisible()},DeliveryGameResultsScreen.prototype._hide=function(){this.jobFailed.script.deliveryGameJobFailed.hide(),this.jobComplete.script.deliveryGameJobComplete.hide()},DeliveryGameResultsScreen.prototype._showJobTimeUp=function(){this.jobFailed.script.deliveryGameJobFailed.showJobTimeUp()},DeliveryGameResultsScreen.prototype._showJobComplete=function(){this.app.fire("ui:confetti:fire-cannon"),this.jobComplete.script.deliveryGameJobComplete.show()};var DeliveryGameJobFailed=pc.createScript("deliveryGameJobFailed");DeliveryGameJobFailed.attributes.add("watchAdButton",{type:"entity"}),DeliveryGameJobFailed.attributes.add("restartButton",{type:"entity"}),DeliveryGameJobFailed.attributes.add("animatedElements",{type:"entity",array:!0}),DeliveryGameJobFailed.prototype.initialize=function(){this._timeSUntilButtons=0,this.app.on("job:restart",this.hide,this),this.app.on("ui:home:show",this.hide,this)},DeliveryGameJobFailed.prototype.isVisible=function(){return this._timeSUntilButtons>0||this.watchAdButton.enabled||this.restartButton.enabled},DeliveryGameJobFailed.prototype.showJobTimeUp=function(){for(let t in this.animatedElements)this.animatedElements[t].enabled=!0,this.animatedElements[t].script.uiElementAnimation.start()},DeliveryGameJobFailed.prototype.offerMoreTime=function(t,e){this._timeSUntilButtons=1.25;let i=this.app.helpers.formatTime(t);this.watchAdButton.findByName("Time Label").element.text="+"+i,this.watchAdButton.button.off("click"),this.watchAdButton.button.once("click",this._requestMoreTime.bind(this,e),this)},DeliveryGameJobFailed.prototype._requestMoreTime=function(t){t(),this.hide(),this.watchAdButton.script.uiElementAnimation.stop(),this.watchAdButton.enabled=!1,this.entity.fire("time:requested")},DeliveryGameJobFailed.prototype.offerRestart=function(t){this._timeSUntilButtons=1.25,this.restartButton.button.once("click",this._requestRestart.bind(this,t),this)},DeliveryGameJobFailed.prototype._requestRestart=function(t){t(),this.hide(),this.restartButton.script.uiElementAnimation.stop(),this.restartButton.enabled=!1,this.entity.fire("restart:requested")},DeliveryGameJobFailed.prototype.hide=function(){this._timeSUntilButtons=0,this.watchAdButton.script.uiElementAnimation.stop(),this.watchAdButton.enabled=!1,this.restartButton.script.uiElementAnimation.stop(),this.restartButton.enabled=!1;for(let t in this.animatedElements)this.animatedElements[t].script.uiElementAnimation.stop(),this.animatedElements[t].enabled=!1},DeliveryGameJobFailed.prototype.update=function(t){this._timeSUntilButtons>0&&(this._timeSUntilButtons-=t,this._timeSUntilButtons<=0&&(this.watchAdButton.enabled=!0,this.restartButton.enabled=!0,this.watchAdButton.script.uiElementAnimation.start(),this.restartButton.script.uiElementAnimation.start()))};var FollowEntity=pc.createScript("followEntity");FollowEntity.attributes.add("postFollowTranslation",{type:"vec3",description:"The position translation applied after we've copied the position and rotation."}),FollowEntity.prototype.initialize=function(){},FollowEntity.prototype.update=function(t){let o=this.app.globals.currentVehicle;o&&(this.entity.setPosition(o.getPosition()),this.entity.setRotation(o.getRotation()),this.entity.translate(this.postFollowTranslation))};var SkillsPage=pc.createScript("skillsPage");SkillsPage.attributes.add("jobSizeGroup",{type:"entity"}),SkillsPage.attributes.add("jobUrgencyGroup",{type:"entity"}),SkillsPage.attributes.add("jobSizeMaxedLabel",{type:"entity"}),SkillsPage.attributes.add("jobSizeUpgradeButton",{type:"entity"}),SkillsPage.attributes.add("jobUrgencyMaxedLabel",{type:"entity"}),SkillsPage.attributes.add("jobUrgencyUpgradeButton",{type:"entity"}),SkillsPage.attributes.add("jobSizeUpgradeConfirmGroup",{type:"entity"}),SkillsPage.attributes.add("jobUrgencyUpgradeConfirmGroup",{type:"entity"}),SkillsPage.attributes.add("cancelJobSizeUpgradeButton",{type:"entity"}),SkillsPage.attributes.add("cancelJobUrgencyUpgradeButton",{type:"entity"}),SkillsPage.attributes.add("confirmJobSizeUpgradeButton",{type:"entity"}),SkillsPage.attributes.add("confirmJobUrgencyUpgradeButton",{type:"entity"}),SkillsPage.prototype.initialize=function(){this._jobSizeUpgradeCost=0,this._jobUrgencyUpgradeCost=0,this.entity.on("show",this._updateFormState,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this),this.jobSizeUpgradeButton.button.on("click",this._attemptUpgrade,this),this.jobUrgencyUpgradeButton.button.on("click",this._showJobUrgencyConfirm,this),this.cancelJobSizeUpgradeButton.button.on("click",this._hideJobSizeConfirm,this),this.cancelJobUrgencyUpgradeButton.button.on("click",this._hideUrgencyConfirm,this),this.confirmJobSizeUpgradeButton.button.on("click",this._upgradeJobSize,this),this.confirmJobUrgencyUpgradeButton.button.on("click",this._upgradeJobUrgency,this)},SkillsPage.prototype._updateFormState=function(){this._updateLayout(),this._setUpgradeCosts(),this._setUpgradeGroupStates()},SkillsPage.prototype._setUpgradeCosts=function(){let t=this.app.playerStats.skills.jobSize;t<10&&(this._jobSizeUpgradeCost=this.app.skills.jobSize[t+1].unlockCost);let e=this.app.playerStats.skills.jobUrgency;e<5&&(this._jobUrgencyUpgradeCost=this.app.skills.jobUrgency[e+1].unlockCost)},SkillsPage.prototype._formatCost=function(t){return t<=0?"Free":t.toLocaleString()},SkillsPage.prototype._setUpgradeGroupStates=function(){let t=this.app.playerStats.skills.jobSize,e=this.app.playerStats.skills.jobUrgency;this.jobSizeGroup.findByName("Title").element.text="Job Size: "+t,this.jobUrgencyGroup.findByName("Title").element.text="Time Crunch: "+e;for(let t=1;t<6;t++)this.jobUrgencyGroup.findByName("Urgency "+t).enabled=t==e;let i=(100*this.app.skills.jobSize[t].tipBonus).toString()+"%";this.jobSizeGroup.findByName("Tip Bonus").element.text="+"+i;let o=(100*this.app.skills.jobUrgency[e].tipBonus).toString()+"%";this.jobUrgencyGroup.findByName("Tip Bonus").element.text="+"+o;let a=(100*this.app.skills.jobUrgency[e].timeCrunch).toString()+"%",s=e<=0?"-":"";if(this.jobUrgencyGroup.findByName("Time Crunch").element.text=s+a,this._setBarColors(this.jobSizeGroup,t),this._setBarColors(this.jobUrgencyGroup,e),t>=10)this.jobSizeMaxedLabel.enabled=!0,this.jobSizeUpgradeButton.enabled=!1;else{this.jobSizeMaxedLabel.enabled=!1;let t=this._formatCost(this._jobSizeUpgradeCost);this.jobSizeUpgradeButton.findByName("Cost").element.text=t,this.jobSizeUpgradeConfirmGroup.findByName("Cost").element.text=t,this.app.playerStats.coins<this._jobSizeUpgradeCost?(this.jobSizeUpgradeButton.button.active=!1,this.jobSizeUpgradeButton.element.opacity=.5,this.jobSizeUpgradeButton.findByName("Coin Icon").element.opacity=.5):(this.jobSizeUpgradeButton.button.active=!0,this.jobSizeUpgradeButton.element.opacity=1,this.jobSizeUpgradeButton.findByName("Coin Icon").element.opacity=1)}if(e>=5)this.jobUrgencyMaxedLabel.enabled=!0,this.jobUrgencyUpgradeButton.enabled=!1;else{this.jobUrgencyMaxedLabel.enabled=!1;let t=this._formatCost(this._jobUrgencyUpgradeCost);this.jobUrgencyUpgradeButton.findByName("Cost").element.text=t,this.jobUrgencyUpgradeConfirmGroup.findByName("Cost").element.text=t,this.app.playerStats.coins<this._jobUrgencyUpgradeCost?(this.jobUrgencyUpgradeButton.button.active=!1,this.jobUrgencyUpgradeButton.element.opacity=.5,this.jobUrgencyUpgradeButton.findByName("Coin Icon").element.opacity=.5):(this.jobUrgencyUpgradeButton.button.active=!0,this.jobUrgencyUpgradeButton.element.opacity=1,this.jobUrgencyUpgradeButton.findByName("Coin Icon").element.opacity=1)}},SkillsPage.prototype._attemptUpgrade=function(){this._jobSizeUpgradeCost<=0?this._upgradeJobSize():(this.jobSizeUpgradeButton.enabled=!1,this.jobSizeUpgradeConfirmGroup.enabled=!0)},SkillsPage.prototype._showJobUrgencyConfirm=function(){this.jobUrgencyUpgradeButton.enabled=!1,this.jobUrgencyUpgradeConfirmGroup.enabled=!0},SkillsPage.prototype._hideJobSizeConfirm=function(){this.jobSizeUpgradeButton.enabled=!0,this.jobSizeUpgradeConfirmGroup.enabled=!1},SkillsPage.prototype._hideUrgencyConfirm=function(){this.jobUrgencyUpgradeButton.enabled=!0,this.jobUrgencyUpgradeConfirmGroup.enabled=!1},SkillsPage.prototype._upgradeJobSize=function(){this.app.playerStats.skills.jobSize+=1,this.app.fire("coins:spend",this._jobSizeUpgradeCost),this.app.fire("skills:upgrade",this.app.playerStats.skills),this._setBarColors(this.jobSizeGroup,this.app.playerStats.skills.jobSize),this._hideJobSizeConfirm(),this._updateFormState()},SkillsPage.prototype._upgradeJobUrgency=function(){this.app.playerStats.skills.jobUrgency+=1,this.app.fire("coins:spend",this._jobUrgencyUpgradeCost),this.app.fire("skills:upgrade",this.app.playerStats.skills),this._setBarColors(this.jobUrgencyGroup,this.app.playerStats.skills.jobUrgency),this._hideUrgencyConfirm(),this._updateFormState()},SkillsPage.prototype._setBarColors=function(t,e){let i=t.findByTag("upgrade-bar");for(let t in i)t<e?(i[t].element.opacity=1,i[t].element.color=new pc.Color(.79,.33,.11,1)):(i[t].element.opacity=.33,i[t].element.color=new pc.Color(.46,.34,.17,1)),i[t].script.juicyButton.jiggleFrom(t/i.length)},SkillsPage.prototype._updateLayout=function(){this.app.globals.isTouchPortrait?this._showPortraitLayout():this._showLandscapeLayout()},SkillsPage.prototype._showPortraitLayout=function(){this.jobSizeGroup.setLocalScale(.5,.5,.5),this.jobUrgencyGroup.setLocalScale(.5,.5,.5)},SkillsPage.prototype._showLandscapeLayout=function(){this.jobSizeGroup.setLocalScale(1,1,1),this.jobUrgencyGroup.setLocalScale(1,1,1)};var SkillsData=pc.createScript("skillsData");SkillsData.prototype.initialize=function(){this.app.skills={jobSize:{1:{isUnlocked:!0,unlockCost:0,tipBonus:.05},2:{isUnlocked:!1,unlockCost:0,tipBonus:.1},3:{isUnlocked:!1,unlockCost:400,tipBonus:.15},4:{isUnlocked:!1,unlockCost:600,tipBonus:.2},5:{isUnlocked:!1,unlockCost:900,tipBonus:.25},6:{isUnlocked:!1,unlockCost:1300,tipBonus:.3},7:{isUnlocked:!1,unlockCost:1800,tipBonus:.35},8:{isUnlocked:!1,unlockCost:2400,tipBonus:.4},9:{isUnlocked:!1,unlockCost:3100,tipBonus:.45},10:{isUnlocked:!1,unlockCost:3900,tipBonus:.5}},jobUrgency:{0:{isUnlocked:!0,unlockCost:0,tipBonus:0,timeCrunch:-0},1:{isUnlocked:!1,unlockCost:250,tipBonus:.1,timeCrunch:-.05},2:{isUnlocked:!1,unlockCost:500,tipBonus:.2,timeCrunch:-.1},3:{isUnlocked:!1,unlockCost:750,tipBonus:.3,timeCrunch:-.15},4:{isUnlocked:!1,unlockCost:1e3,tipBonus:.4,timeCrunch:-.2},5:{isUnlocked:!1,unlockCost:1250,tipBonus:.5,timeCrunch:-.25}}}};var VehicleData=pc.createScript("vehicleData");VehicleData.attributes.add("vehicles",{type:"json",array:!0,schema:[{name:"name",type:"string"},{name:"price",type:"number"},{name:"watchAdToUnlock",type:"boolean",default:!1},{name:"displayPosition",type:"vec3",description:"Adjusts the showroom/homescreen position to accommodate all ride heights"},{name:"template",type:"asset",assetType:"template"}]}),VehicleData.prototype.initialize=function(){this.app.vehicles=this.vehicles};var UiCoinDrops=pc.createScript("uiCoinDrops");UiCoinDrops.attributes.add("displayTimeS",{type:"number",default:3}),UiCoinDrops.attributes.add("fadeTimeS",{type:"number",default:1}),UiCoinDrops.attributes.add("uiFadeCurve",{type:"curve"}),UiCoinDrops.attributes.add("coinIcon",{type:"entity"}),UiCoinDrops.attributes.add("coinTemplate",{type:"asset",assetType:"template"}),UiCoinDrops.attributes.add("movementPath",{type:"curve",curves:["x","y"]}),UiCoinDrops.attributes.add("scalePath",{type:"curve"}),UiCoinDrops.attributes.add("movementTimeS",{type:"number",default:1.5}),UiCoinDrops.attributes.add("timeSBetweenCoins",{type:"number",default:.1}),UiCoinDrops.attributes.add("displayedCoinAmount",{type:"entity"}),UiCoinDrops.prototype.initialize=function(){this._trueCount=0,this._movingCoinsValue=0,this._displayTimeLeftS=this.displayTimeS,this._fadeTimeLeftS=this.fadeTimeS,this._fadeDirection="in",this._timeSUntilNextCoin=0,this._movingCoins=[],this._displayedNumCoins=this.app.playerStats.coins,this._black=new pc.Color(0,0,0,1),this._halfVisible=new pc.Color(0,0,0,.5),this._quarterVisible=new pc.Color(0,0,0,.25),this._invisible=new pc.Color(0,0,0,0),this.app.on("job:start",this._resetAnimation,this),this.app.on("coins:update",this._updateCoinCount,this),this.app.on("coins:spend",this._resetAnimation,this),this.app.on("stats:loaded",this._setStartingValues,this)},UiCoinDrops.prototype._resetAnimation=function(){for(let t in this._movingCoins){let i=this._movingCoins[t];this.entity.removeChild(i),i.destroy()}this._movingCoins=[],this._movingCoinsValue=0,this._timeSUntilNextCoin=0,this._trueCount=this.app.playerStats.coins,this._displayedNumCoins=this._trueCount,this.displayedCoinAmount.element.text=parseInt(Math.round(this._trueCount)).toLocaleString()},UiCoinDrops.prototype.setStartingCount=function(t){this._trueCount=t,this.displayedCoinAmount.element.text=t.toLocaleString()},UiCoinDrops.prototype.setTrueCount=function(t){this._trueCount=t,this._timeSUntilNextCoin=this.timeSBetweenCoins,this._fadeDirection="in"},UiCoinDrops.prototype._updateCoinCount=function(t){this.setTrueCount(t),this._fadeTimeLeftS=this.fadeTimeS},UiCoinDrops.prototype.update=function(t){this._updateFade(t),this._createNewCoins(t),this._updateMovingCoins(t),this._updateCoinCount()},UiCoinDrops.prototype._updateFade=function(t){if(this._displayTimeLeftS>0&&(this._displayTimeLeftS-=t,this._displayTimeLeftS<=0&&(this._fadeDirection="out"),this.coinIcon.element.opacity=1,this.displayedCoinAmount.element.outlineThickness=.5,this.displayedCoinAmount.element.opacity=1,this.displayedCoinAmount.element.shadowColor=this._black),this._displayTimeLeftS<=0&&this._fadeTimeLeftS>0){this._fadeTimeLeftS-=t;let i=this._fadeTimeLeftS/this.fadeTimeS;"out"==this._fadeDirection&&(i=1-i);let e=this.uiFadeCurve.value(i);this._fadeTimeLeftS<0&&(e=0),this.coinIcon.element.opacity=e,this.displayedCoinAmount.element.outlineThickness=.5*e,this.displayedCoinAmount.element.opacity=e,this.displayedCoinAmount.element.shadowColor=e<=.02?this._invisible:e<=.25?this._quarterVisible:e<=.5?this._halfVisible:this._black}},UiCoinDrops.prototype._createNewCoins=function(t){let i=this._trueCount-this._displayedNumCoins-this._movingCoinsValue;if(this._timeSUntilNextCoin>0&&i>0&&(this._timeSUntilNextCoin-=t,this._timeSUntilNextCoin<=0)){let t=parseInt(.1*i);t=t>0?t:1;let e=this.coinTemplate.resource.instantiate();e.age=this.movementTimeS,e.value=t,this._movingCoinsValue+=t,this.entity.addChild(e),this._movingCoins.push(e),i-=t,i>0&&(this._timeSUntilNextCoin=this.timeSBetweenCoins)}},UiCoinDrops.prototype._updateMovingCoins=function(t){if(!(this._movingCoins.length<=0)){this._movingCoins.length>0&&(this._displayTimeLeftS=this.displayTimeS,this._fadeTimeLeftS=this.fadeTimeS);for(let i in this._movingCoins){let e=this._movingCoins[i];e.age-=t;let s=1-e.age/this.movementTimeS,o=this.movementPath.value(s),n=this.scalePath.value(s),a=e.getLocalPosition();this.app.isUsingTouch?a.x=-o[0]-150:a.x=o[0],a.y=o[1],e.setLocalPosition(a),e.setLocalScale(n,n,n),e.age<=0&&(this.coinIcon.script.juicyButton.jiggle(),this._displayedNumCoins+=e.value,this._movingCoinsValue-=e.value,this.displayedCoinAmount.element.text=parseInt(Math.round(this._displayedNumCoins)).toLocaleString(),this.entity.removeChild(e),e.destroy())}this._movingCoins=this._movingCoins.filter((function(t){return t.age>0})),this._movingCoins.length<=0&&(this.displayedCoinAmount.element.text=parseInt(Math.round(this._trueCount)).toLocaleString())}},UiCoinDrops.prototype._updateCoinCount=function(){if(parseInt(Math.round(this.app.playerStats.coins))<parseInt(Math.round(this._displayedNumCoins))){this._displayedNumCoins=pc.math.lerp(this._displayedNumCoins,this.app.playerStats.coins,.05);let t=parseInt(Math.round(this._displayedNumCoins)).toLocaleString();this.displayedCoinAmount.element.text=t,this._displayTimeLeftS=this.displayTimeS,this._fadeTimeLeftS=this.fadeTimeS}},UiCoinDrops.prototype._setStartingValues=function(t){this._displayedNumCoins=this.app.playerStats.coins};var HudNotification=pc.createScript("hudNotification");HudNotification.attributes.add("lifetimeS",{type:"number"}),HudNotification.attributes.add("scaleCurve",{type:"curve"}),HudNotification.attributes.add("opacityCurve",{type:"curve"}),HudNotification.attributes.add("yPosCurve",{type:"curve"}),HudNotification.prototype.initialize=function(){this._lifeRemainingS=this.lifetimeS},HudNotification.prototype.update=function(t){if(this._lifeRemainingS-=t,this._lifeRemainingS<=0)return this.entity.hasExpired=!0,void(this.entity.element.enabled=!1);let i=1-this._lifeRemainingS/this.lifetimeS,e=this.opacityCurve.value(i);this.entity.element.opacity=e;let a=this.scaleCurve.value(i);this.entity.setLocalScale(a,a,a);let o=this.yPosCurve.value(i),n=this.entity.getLocalPosition();this.entity.setLocalPosition(n.x,o,n.z)};var CounterBadge=pc.createScript("counterBadge");CounterBadge.attributes.add("hideEvents",{type:"string",array:!0,description:"Event that hides the badge when fired"}),CounterBadge.attributes.add("showEvents",{type:"string",array:!0,description:"Event that shows the badge when fired"}),CounterBadge.attributes.add("resetEvent",{type:"string",description:"Event that resets the count when fired"}),CounterBadge.attributes.add("increaseEvent",{type:"string",description:"Event that increases the count when fired"}),CounterBadge.attributes.add("numberElement",{type:"entity"}),CounterBadge.prototype.initialize=function(){this._count=0,this._isHidden=!1,this.numberElement.enabled=!1,this.entity.element.enabled=!1;for(let e in this.hideEvents)this.app.on(this.hideEvents[e],this._hideBadge,this);for(let e in this.showEvents)this.app.on(this.showEvents[e],this._showBadge,this);this.app.on(this.resetEvent,this._resetCount,this),this.app.on(this.increaseEvent,this._increaseCount,this)},CounterBadge.prototype._hideBadge=function(){this._isHidden=!0,this._hideElement()},CounterBadge.prototype._showBadge=function(){this._isHidden=!1,this._count>0&&this._showElement()},CounterBadge.prototype._showElement=function(){this.entity.element.enabled||this.entity.fire("badge:shown"),this.numberElement.enabled=!0,this.entity.element.enabled=!0},CounterBadge.prototype._hideElement=function(){this.entity.element.enabled&&this.entity.fire("badge:hidden"),this.numberElement.enabled=!1,this.entity.element.enabled=!1},CounterBadge.prototype._resetCount=function(e){this._count=0,this.numberElement.element.text=this._count,this._hideElement()},CounterBadge.prototype._increaseCount=function(e){this._count+=1,this.numberElement.element.text=this._count,this._isHidden||this._showElement()};var TouchAnimation=pc.createScript("touchAnimation");TouchAnimation.attributes.add("handIcon",{type:"entity"}),TouchAnimation.attributes.add("impactIcon",{type:"entity"}),TouchAnimation.attributes.add("handScaleCurve",{type:"curve",curves:["x","y"]}),TouchAnimation.attributes.add("impactScaleCurve",{type:"curve"}),TouchAnimation.attributes.add("impactOpacityCurve",{type:"curve"}),TouchAnimation.attributes.add("animTime",{type:"number",default:1}),TouchAnimation.prototype.initialize=function(){this._animCountdownS=this.animTime},TouchAnimation.prototype.update=function(t){this._animCountdownS-=t,this._animCountdownS<=0&&(this._animCountdownS=this.animTime);let i=1-this._animCountdownS/this.animTime,a=this.handScaleCurve.value(i);this.handIcon.setLocalScale(a[0],a[1],1);let n=this.impactScaleCurve.value(i);this.impactIcon.setLocalScale(n,n,n);let e=this.impactOpacityCurve.value(i);this.impactIcon.element.opacity=e};var ArrowInputAnimation=pc.createScript("arrowInputAnimation");ArrowInputAnimation.attributes.add("forwardKey",{type:"entity"}),ArrowInputAnimation.attributes.add("animTime",{type:"number",default:1}),ArrowInputAnimation.attributes.add("scaleCurve",{type:"curve"}),ArrowInputAnimation.prototype.initialize=function(){this._animCountdownS=this.animTime},ArrowInputAnimation.prototype.update=function(t){this._animCountdownS-=t,this._animCountdownS<=0&&(this._animCountdownS=this.animTime);let i=this._animCountdownS/this.animTime,n=this.scaleCurve.value(i);this.forwardKey.setLocalScale(n,n,n)};var MiniMapArrows=pc.createScript("miniMapArrows");MiniMapArrows.attributes.add("arrowTemplate",{type:"asset",assetType:"template"}),MiniMapArrows.prototype.initialize=function(){this._batchGroup=this.app.batcher.getGroupByName("Minimap"),this._material=this.app.assets.find("Minimap Arrow","material"),this.app.on("job:complete",this.clear,this)},MiniMapArrows.prototype.clear=function(){for(let t=this.entity.children.length;t>0;t--){let i=this.entity.children[t-1];this.entity.removeChild(i),i.destroy()}},MiniMapArrows.prototype.add=function(t){this.clear();for(let i in t){let e=t[i],r=this.arrowTemplate.resource.instantiate(),a=e.getPosition();r.setPosition(a),r.setRotation(e.getRotation()),r.translate(0,-64,0),r.render.materialAssets=[this._material],r.render.batchGroupId=this._batchGroup.id,this.entity.addChild(r),r.script.directionArrow.scaleMultiplier=1.5,t[i].on("vanish",this._vanish.bind(this,t[i],r),this)}},MiniMapArrows.prototype._vanish=function(t,i){t.off("vanish"),i.script.directionArrow.vanish()};var StuckCheck=pc.createScript("stuckCheck");StuckCheck.prototype.initialize=function(){this._lastPosition=new pc.Vec3,this._distanceTimeSamples=[],this._distanceOverLastInterval=0,this._lastIntervalTime=0,this._isStuck=!1,this.app.on("vehicle:player:respawn",(function(){this._isStuck=!1}),this)},StuckCheck.prototype.update=function(t){let i=this.entity.getPosition(),s=i.distance(this._lastPosition),e=this.entity.script.vehicle.engineForce;if(e>0||e<0){if(this._distanceTimeSamples.push({dist:s,delta:t}),this._distanceOverLastInterval+=s,this._lastIntervalTime+=t,this._lastIntervalTime>=3){let i=this._distanceTimeSamples.shift();this._distanceOverLastInterval-=i.dist,this._lastIntervalTime-=t}this._lastIntervalTime>2.5&&this._distanceOverLastInterval<=.25&&!this._isStuck?(this._isStuck=!0,this._distanceTimeSamples=[],this._distanceOverLastInterval=0,this._lastIntervalTime=0,this.app.fire("vehicle:player:stuck")):this._distanceOverLastInterval>1&&this._isStuck&&this.app.fire("poki:gameplayStart",function(){this._isStuck=!1,this.app.fire("vehicle:player:unstuck")}.bind(this))}this._lastPosition.copy(i)};var ActiveJobHud=pc.createScript("activeJobHud");ActiveJobHud.attributes.add("pizzaIcon",{type:"entity"}),ActiveJobHud.attributes.add("numDeliveriesElement",{type:"entity"}),ActiveJobHud.attributes.add("content",{type:"entity"}),ActiveJobHud.attributes.add("timer",{type:"entity"}),ActiveJobHud.attributes.add("clockIcon",{type:"entity"}),ActiveJobHud.attributes.add("notificationTemplate",{type:"asset",assetType:"template"}),ActiveJobHud.prototype.initialize=function(){this.app.on("job:start",this._showJobElements,this),this.app.on("job:cancel",this._hideJobElements,this),this.app.on("job:restart",this._showJobElements,this),this.app.on("job:failed",this._hideJobElements,this),this.app.on("job:time:up",this._hideJobElements,this),this.app.on("job:complete",this._hideJobElements,this),this.app.on("job:time:added",this._addNotification,this),this.app.on("job:time:extended",this._addNotification,this),this.app.on("tutorial:start",this._hideJobElements,this),this.app.on("job:progress",this._updateNumDeliveries,this),this.app.on("job:time:extended",this._showJobElements,this),this.app.on("tutorial:start",this._showJobElements,this),this._notifications=[]},ActiveJobHud.prototype._showJobElements=function(){this.app.globals.currentJob&&(this.content.enabled=!0,this._updateTimerLayout(),this._updateNumDeliveries())},ActiveJobHud.prototype._hideJobElements=function(t){this.content.enabled=!1},ActiveJobHud.prototype._updateTimerLayout=function(){this.app.globals.currentJob&&this.app.globals.currentJob.hasTimeLimit?(this.timer.enabled=!0,this.clockIcon.enabled=!0,this.pizzaIcon.setLocalPosition(56,-20,0),this.numDeliveriesElement.setLocalPosition(186,-20,0)):(this.timer.enabled=!1,this.clockIcon.enabled=!1,this.pizzaIcon.setLocalPosition(-36,-20,0),this.numDeliveriesElement.setLocalPosition(94,-20,0),this.app.globals.isTouchPortrait&&(this.pizzaIcon.setLocalPosition(52,-6,0),this.numDeliveriesElement.setLocalPosition(182,-6,0)))},ActiveJobHud.prototype._updateNumDeliveries=function(){if(this.app.globals.currentJob)if(this.app.globals.currentJob.isComplete||this.app.globals.currentJob.hasFailed)this.numDeliveriesElement.element.text="-";else{let t=this.app.globals.currentJob.numPizzas-this.app.globals.currentJob.numDeliveriesRemaining,e=this.app.globals.currentJob.numPizzas;this.numDeliveriesElement.element.text=t+"/"+e}else this.numDeliveriesElement.element.text="-"},ActiveJobHud.prototype._addNotification=function(t){let e=this.notificationTemplate.resource.instantiate();this.entity.addChild(e);let i=e.getLocalPosition();i.x-=50,e.setLocalPosition(i),e.element.text="+"+this.app.helpers.formatTime(t),this._notifications.push(e)},ActiveJobHud.prototype.update=function(t){this._updateCurrentJob(t),this._updateNotifications(t)},ActiveJobHud.prototype._updateCurrentJob=function(t){this.app.globals.currentJob?this.app.globals.currentJob.isComplete?this.timer.element.text="":this.app.globals.currentJob.hasTimeLimit?this.timer.element.text=this.app.helpers.formatTime(this.app.globals.currentJob.timeRemainingS):this.timer.element.text="":this.content.enabled=!1},ActiveJobHud.prototype._updateNotifications=function(t){for(let t in this._notifications){let e=this._notifications[t];e.hasExpired&&(this.entity.removeChild(e),e.destroy())}this._notifications=this._notifications.filter((function(t){return!t.hasExpired}))};var UiElementAnimation=pc.createScript("uiElementAnimation");UiElementAnimation.attributes.add("animTimeS",{type:"number",default:.25,description:"Length of animation in seconds."}),UiElementAnimation.attributes.add("position",{type:"curve",curves:["x","y"]}),UiElementAnimation.attributes.add("scale",{type:"curve",default:{keys:[0,1,1,1],type:pc.CURVE_SPLINE}}),UiElementAnimation.attributes.add("opacity",{type:"curve",default:{keys:[0,1,1,1],type:pc.CURVE_SPLINE}}),UiElementAnimation.attributes.add("continuous",{type:"boolean",default:!1}),UiElementAnimation.attributes.add("disableOnFinish",{type:"boolean",default:!1,description:"Entity will set enabled to false when animation is complete."}),UiElementAnimation.attributes.add("staticOpacity",{type:"boolean",default:!1,description:"Script will not modify opacity (useful for button hover states)."}),UiElementAnimation.prototype.initialize=function(){this._animTimeCountdownS=0},UiElementAnimation.prototype.start=function(){this._animTimeCountdownS=this.animTimeS},UiElementAnimation.prototype.stop=function(){this._animTimeCountdownS=0},UiElementAnimation.prototype.isRunning=function(){return this._animTimeCountdownS>0},UiElementAnimation.prototype.update=function(t){this._animTimeCountdownS>0&&(this._animTimeCountdownS-=t,this._animTimeCountdownS<=0&&(this.disableOnFinish?(this._animTimeCountdownS=0,this.entity.enabled=!1):this.continuous&&(this._animTimeCountdownS=this.animTimeS)));let i=1-this._animTimeCountdownS/this.animTimeS,n=this.position.value(i),e=this.entity.getLocalPosition();this.entity.setLocalPosition(n[0],n[1],e.z);let o=this.scale.value(i);if(this.entity.setLocalScale(o,o,o),!this.staticOpacity){let t=this.opacity.value(i);this.entity.element.opacity=t}};var HighwayEntrance=pc.createScript("highwayEntrance");HighwayEntrance.attributes.add("exit",{type:"entity"}),HighwayEntrance.prototype.initialize=function(){this.entity.collision.on("triggerenter",(function(i){this._isPlayerVehicle(i)&&this.app.fire("highway:enter",this.entity)}),this)},HighwayEntrance.prototype._isPlayerVehicle=function(i){return(!i.script||!i.script.aiDriver)&&!(!i.script||!i.script.vehicle)};var HighwayPage=pc.createScript("highwayPage");HighwayPage.attributes.add("mapElement",{type:"entity"}),HighwayPage.attributes.add("mapLoading",{type:"entity"}),HighwayPage.attributes.add("regionButtons",{type:"entity",array:!0}),HighwayPage.attributes.add("lockedState",{type:"entity"}),HighwayPage.attributes.add("youAreHere",{type:"entity"}),HighwayPage.attributes.add("travelButton",{type:"entity"}),HighwayPage.attributes.add("unlockButton",{type:"entity"}),HighwayPage.attributes.add("destinationName",{type:"entity"}),HighwayPage.attributes.add("numPassesLabel",{type:"entity"}),HighwayPage.attributes.add("confirmGroup",{type:"entity"}),HighwayPage.attributes.add("confirmTravelButton",{type:"entity"}),HighwayPage.attributes.add("cancelTravelButton",{type:"entity"}),HighwayPage.attributes.add("getPassButton",{type:"entity"}),HighwayPage.attributes.add("homeScreen",{type:"entity"}),HighwayPage.attributes.add("regionsButton",{type:"entity"}),HighwayPage.attributes.add("map",{type:"entity"}),HighwayPage.attributes.add("infoContainer",{type:"entity"}),HighwayPage.prototype.initialize=function(){let t=this.mapElement.element.textureAsset;this.app.assets.get(t).ready(function(){this.mapLoading.enabled=!1,this._setRegionButtonUnlockStates()}.bind(this)),this._activeRegionInfo=null,this.getPassButton.button.on("click",this._getPass,this),this.travelButton.button.on("click",this._showConfirm,this),this.unlockButton.button.on("click",this._goToRegionsPage,this),this.cancelTravelButton.button.on("click",this._hideConfirm,this),this.confirmTravelButton.button.on("click",this._travel,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this),this._showHighwayPasses();for(let t in this.regionButtons)this.regionButtons[t].on("inspect",this._showRegionInfo,this);this.entity.on("show",this._populateForm,this)},HighwayPage.prototype._populateForm=function(){this._updateLayout(),this._showDefaultRegionInfo(),this._setRegionButtonUnlockStates(),this._showHighwayPasses()},HighwayPage.prototype._setRegionButtonUnlockStates=function(){let t=0;for(let e in this.regionButtons){let i=this.regionButtons[e].script.regionButton.regionName;this.app.playerStats.regions[i].isUnlocked&&(t+=1)}t<=1?(this.getPassButton.button.active=!1,this.getPassButton.script.shakyElement.stop(),this.getPassButton.findByName("Watch Ad Icon").element.opacity=.5,this.getPassButton.findByName("Text").element.opacity=.5):(this.getPassButton.button.active=!0,this.getPassButton.script.shakyElement.play(),this.getPassButton.findByName("Watch Ad Icon").element.opacity=1,this.getPassButton.findByName("Text").element.opacity=1)},HighwayPage.prototype._getPass=function(){this.app.fire("poki:rewardedBreak:play",function(){this._addPass()}.bind(this),function(){}.bind(this))},HighwayPage.prototype._addPass=function(){this.app.fire("highway:pass:add"),this._showHighwayPasses(),this.numPassesLabel.script.juicyButton.jiggle()},HighwayPage.prototype._showHighwayPasses=function(){this.numPassesLabel.element.text="Passes: "+this.app.playerStats.highwayPasses,this.app.playerStats.highwayPasses<=0?this.travelButton.button.active=!1:this.travelButton.button.active=!0},HighwayPage.prototype._showConfirm=function(){this.confirmGroup.enabled=!0,this.travelButton.enabled=!1},HighwayPage.prototype._hideConfirm=function(){this.confirmGroup.enabled=!1,this.travelButton.enabled=!0},HighwayPage.prototype._goToRegionsPage=function(){this.homeScreen.script.homeScreen.hideCurrentPage();let t=this.regionsButton.script.pageButton.page;this.homeScreen.script.homeScreen.showPage(t),t.script.regionsPage.showRegionInfo(this._activeRegionInfo)},HighwayPage.prototype._travel=function(){this.app.playerStats.highwayPasses>=1&&(this.app.fire("region:travel",this._activeRegionInfo),this._hideConfirm(),this._showHighwayPasses())},HighwayPage.prototype._showDefaultRegionInfo=function(){this._showRegionInfo(this.app.regions.Downtown)},HighwayPage.prototype._showRegionInfo=function(t){this._hideConfirm(),this._activeRegionInfo=t,this.destinationName.element.text=t.name;let e=this.app.playerStats.regions[t.name].isUnlocked,i=this._activeRegionInfo.name==this.app.globals.currentMapChunk.name;e?(this.travelButton.enabled=!0,this.lockedState.enabled=!1,this.unlockButton.enabled=!1,i?(this.youAreHere.enabled=!0,this.travelButton.enabled=!1):this.youAreHere.enabled=!1):(this.travelButton.enabled=!1,this.lockedState.enabled=!0,this.unlockButton.enabled=!0,this.youAreHere.enabled=!1);for(let e in this.regionButtons)this.regionButtons[e].script.regionButton.updateDisplayState(t.name)},HighwayPage.prototype._updateLayout=function(){this.app.globals.isTouchPortrait?this._showPortraitLayout():this._showLandscapeLayout()},HighwayPage.prototype._showPortraitLayout=function(){this.map.script.pageAnimation.enabled=!1,this.infoContainer.script.pageAnimation.enabled=!1,this.map.element.anchor=[.5,1,.5,1],this.map.element.pivot=[.5,1],this.map.setLocalPosition(0,-440,0),this.map.setLocalScale(.8,.8,.8),this.infoContainer.element.anchor=[.5,0,.5,0],this.infoContainer.element.pivot=[.5,0],this.infoContainer.setLocalPosition(300,240,0)},HighwayPage.prototype._showLandscapeLayout=function(){this.map.script.pageAnimation.enabled=!0,this.infoContainer.script.pageAnimation.enabled=!0,this.map.element.anchor=[.5,.5,.5,.5],this.map.element.pivot=[.5,.5],this.map.setLocalPosition(160,-70,0),this.map.setLocalScale(1,1,1),this.infoContainer.element.anchor=[.5,.5,.5,.5],this.infoContainer.element.pivot=[.5,.5],this.infoContainer.setLocalPosition(0,0,0)};var HighwayExit=pc.createScript("highwayExit");HighwayExit.prototype.initialize=function(){},HighwayExit.prototype.update=function(i){};var HighwaySystem=pc.createScript("highwaySystem");HighwaySystem.attributes.add("chunks",{type:"json",array:!0,schema:[{name:"name",type:"string"},{name:"entrance",type:"entity"},{name:"exit",type:"entity"},{name:"mapChunk",type:"entity"}]}),HighwaySystem.prototype.initialize=function(){this.app.on("region:travel",this._travel,this)},HighwaySystem.prototype._travel=function(t){for(let e in this.chunks){let i=this.chunks[e];if(this.chunks[e].name==t.name){i.mapChunk.script.mapChunk.load(function(){this.app.globals.restorePosition=i.exit.getPosition(),this.app.globals.restoreRotation=i.exit.getRotation(),this.app.fire("highway:exit")}.bind(this));break}}};pc.script.createLoadingScreen((function(A){var C,Q;C=["body, html {","    height: 100%;","    background-color: #f6dcb8;","}","","#application-splash-wrapper {","    display: flex;","    top: 0;","    left: 0;","    height: 100%;","    background-color: #f6dcb8;","    justify-content: center;","    align-items: center;",'    background-image: url("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAQEBAQEBAQEBAQGBgUGBggHBwcHCAwJCQkJCQwTDA4MDA4MExEUEA8QFBEeFxUVFx4iHRsdIiolJSo0MjRERFwBBAQEBAQEBAQEBAYGBQYGCAcHBwcIDAkJCQkJDBMMDgwMDgwTERQQDxAUER4XFRUXHiIdGx0iKiUlKjQyNEREXP/CABEIBDgHgAMBIgACEQEDEQH/xAAYAAEBAQEBAAAAAAAAAAAAAAAAAQYFB//aAAgBAQAAAAD3YAAAAAAAAAAAAAAAAAEICCEIIEECEECECEECCCCCCBECCCBBBBCGhAAAAAAAAAAAAAAAAAEEECECCEECECCCBCBBCCCCBBCCCBCCBBBBoQAAAAAAAAAAAAAAAACCCCBCCCBCCECCBCCAhBBCBBAghCBAhBAgmiAAAAAAAAAAAAAAAABAggQQggIgQQggQQQEQIIQQQIIIQQQIIIEEaIAAAAAAAAAAAAAAAACEEECEEEECICCCBBCCCCCCCBAhCCCCBAgghogAAAAAAAAAAAAAAABAgiBBAggghBAghAgQQQggggIIQQIQgQQQQJowAAAAAAAAAAAAAAAECCBCCCEWEEIEECIEIICCCEECCCCEBBEBBCCGjAAAAAAAAAAAAAAAAIQIgQQQQIQgIIQQgIIIQIIQIIIIIEEEIICEGjAAAAAAAAAAAAAAAAiBBBBAgghAghAgQgQgQQgQQgQgQQIIQQQQQRpAAAAAAAAAAAAAAAAhBBAgRAQggQQQghAgQIggQIQgQQgQQIIgQIQaQAAAAAAAAAAAAAABAgRAhAQQIgggQQggQQQgQQQIIIQQIIIIEIIIGkAAAAAAAAAAAAAAAgQhAQgQQgQQIQQgQIIIIIEIQIIQIEEEIIIEICaUAAAAAAAAAAAAAAEEEIIEECECEIECCECCAiCCCBCCCBAhBCAhAhBBpQAAAAAAAAAAAAABAhBAgQghAhBAghAggQgQQQggIQIQIIQIIQQQEJpgAAAAAAAAAAAAAEBBBCCBBCCBAgiBBBBBBAhAhBBBAghBAggQQQIRpgAAAAAAAAAAAAAIEEECECEICEECCBECEBCCCBCCBBCCCBCBCBCBBBpgAAAAAAAAAAAAAQQgQIQQIQQQIEEIIIIEIEIEIIIIIEEEIICCCCEBpgAAAAAAAAAAAABBBBAggQggQgQQggQQQggQQQQQQIQIIIIIQEIQEQacAAAAAAAAAAAABAhBAQQQQQQQQIQIQIQQEIIIQIQQIIIIIIQEIIEEJqAAAAAAAAAAAAAEEQIICEECCEEECEEBBCEECCCAiBEBCBBBBAghBBBGoAAAAAAAAAAAAAhBBBBAhAQhAggghAQQQgQQgQQgQgIIIQQQIQIQIQagAAAAAAAAAAAAQQQIQQIEIIIIIEEEICEECECEBCCECEBEECCCCCECBqAAAAAAAAAAAACCBCCCBBBBCCBAghBBBCBBAhAQRAggQgQgQgQQgggGoAAAAAAAAAAAAgQQQQIgQQIQQQIQIIEIIQEIEIEIIIIEEIEIEECIEAagAAAAAAAAAAAECCEEEsIIIIQEEIIEIIIEEEIEEIECEEEEEECECECEAGoAAAAAAAAAAAECCCCBEBBBCCAhAhBAhBAhAgQgggRBAgRAggQgQgQAagAAAAAAAAAAAQQggIgQgQQgQIIIQlgiBAQgQggghAggggggQQQQgIAGoAAAAAAAAAAAQQIQQQQQQIIIIIQQIEIIIEQEEEICIICCIEBICCCEAAagAAAAAAAAAAECECEEEECBCCCCCCBBBBCAiCCAgghBBAhBAgghBBAABqAAAAAAAAAABAgggggQgQhBAQQIgQIQQQIQQIEIQIIIIQEEEIIIEAAGoAAAAAAAAAAEEEEIECEIEECCECECCCCCEBBEEBBCCBCCCAhAhCAgAAagAAAAAAAAACAiBAggQghBBARAhAgRAgQgggggIQQQIQQQQQQIIQAABqAAAAAAAAAAIIQIQIEEIIIEIEIEIEIEEEECCCCIBCECCCBECBCBAAAGoAAAAAAAAACCCBCAhCWIEECCEEIEBCECCCCBBECECCBCBCBBBCBAAABqAAAAAAAAABCBBBBCBAhAgQghAgggQgQgQggQQQQgQQIQQIQgQIAAAGoAAAAAAAAAIQIIEIIQEIIIEIQECIIIECECEEIEECECEEBECCCCAAAAagAAAAAAAACCBBCCBCCCCBBBBCAhBAgghCAQggQgghAhAgQQggIAAABqAAAAAAAAAggQgQQQgIgQQIQQIQIQQQIQIIIQIEIIICEIEIIEEAAAAGoAAAAAAAAIEIIECCCBCECCCCBBCEBCBAghBBCAgghBBBBAhAhAAAAAagAAAAAAAAgRBAgggggRBAgIIggQggQQIgQQQIIIIIQQIEEIEIAAAABqAAAAAAAAIEIIIIEEECEEEEIECCCECCECBCCECCECCCECCBBCAAAAAGoAAAAAAACBBBBBAhBBBAghAhBBAggQQgQQQggQgQgQQQQQQIgAAAAAagAAAAAAAgIQQIQIIIIIQIIQIICIIIIQEEEICCIEIECECCEEEEoAAAAGoAAAAAAAQQIQQIEIQIIIEIEIIEEICEECECEICCCCCCBBCECCAAAAAAagAAAAAACCBBCCBBBBBBAhAhBAhBAghBAQRBAQQhAggggQQggAAAAABqAAAAAAAgQgIQQQQQIgQIIIIQIQIIEIEQEQIIEEIIEIEEECEAAAAAAGoAAAAAAEEECEECCECECCCCCCCCCCBCBBAhCCBAhAhBCAgghAAAAAAAagAAAAAAghAgQgggQQQgQQQgQQQQQQQQIEIQEIIQQIIIIIIEAAAAAABqAAAAAAECEIIIECEEECEECCCCCECEEBCCCCCBBBCCBCBBBBAAAAAAAGoAAAAACBCBAhBBBAiBBAgghAQgggQQgghAQgQgggQQQgIIgAAAAAAAagAAAAAIIQgIIQIEIIIEIQIEEEEIEIICEECEIIEECCCCEECAAAAAAABqAAAAAEBECBEBEEBCCAhBBCBBAhBBBBBBAghAggRAgQRAgQAAAAAAAGoAAAAAQQgQgQgQIQgIIQQIIQEQQQQIIIIQEIIEIIICCIEIAAAAAAAAagAAAAIEEECECEEEECBCCCECECCBCCBCEBBCCBBCBBAhBAgAAAAAAABqAAAABAhCBBAggggggQQhAQggQQIQQgQQgQIIgIQIIEEQIAAAAAAAAGoAAAAIIIIEEEIIIEECECEEEEECCEECEECCECECCCCBCCEAAAAAAAAAagAAABBCBCCAhBBCAhAggggghAggQgRBAgggggQQQQQgggAAAAAAAABqAAAAIQIIQIQQIIIIIIIIIIEEIIIEIEEEEICEEEIBECCEAAAAAAAAAGoAAACCCCCCCECCECCBBEBBBBCAiAhBBBAghBBBAgRAgggAAAAAAAAAagAAAgQgggQQggRAgQIQQQIIQIIgEQQIIEIEEQIIIIEICAAAAAAAAABqAAAEEIIEEEECEEECCEEBEEEBCECBCBCBBCAhBBBASAiAAAAAAAAAAGoAAAghBBBAhAgQgggggQggQhAQgQQgQgIQQQQQQIIQQIAAAAAAAAAAagAAQIQEQQEQIEIEEEIIEEICCECEEECECCCEECCCCBBBAAAAAAAAAABqAACBCCBCAhBCAhBBAhBBAghAggghAghBAgQQgQQgQQQAAAAAAAAAAGoAAQQggQIEQIIQQIIEIQEIQIEEEICICIECECCECCIEEAAAAAAAAAAAagACCCCCBCBECCCCBCBCCCBCBCBBCCBAghAggghAgQhAAAAAAAAAAABqAAgggggggIggQgQIQgIQQQQQQIEIQIEEIEIIEIIIICAAAAAAAAAAAGoAEEECIEEECCECCEECCCCCCCBCCCBCBCBCCBBBBCBBAAAAAAAAAAAAagAghCBBAggghAgQQgQQggQggIQQgQIQIQQIQIIQIQQAAAAAAAAAAABqAIIgIIIIEQEIIEIICIEICEEICEECCCEBCCCBCCBCCAAAAAAAAAAAAGoCBCCBBBBBBCBAghAhAhAhBAggggggghAggggQQgQIAAAAAAAAAAAAagQIgggQQIQIIgEIQEQEEIIIICEIIIEEEEEEICEEEEAAAAAAAAAAAABqCCEECCBCCBECCCBCCCBBBCCBCAhBAQQiBBBAgRBAQAAAAAAAAAAAAGnEEEECCCBBCEBAhBBBBBBAghBBAhAQghAQQgggQQgAAAAAAAAAAAABpyCCBBBAiAiBBAhAggQhBAhAQgRAggQgQQggQQQQIAAAAAAAAAAAAAadBBBAgghBBAggghAghAgggQQghAgQQQQQgIQQIQQAAAAAAAAAAAAAGmCCCECCCCCECBEEBBCEBAiBAhCBBBAiAhBBAggggAAAAAAAAAAAAAGmIIIEIIIEICCEIEICICEEIEECCCCECCCCCCCCCCAAAAAAAAAAAAAAGmggggQIQIIQIIIgIIIEQQIIEIIQIEIIEECEIIECAAAAAAAAAAAAAAGlECBCCECECBECCCCCCBBCEBBAkBASBBBBAhAhCVAAAAAAAAAAAAAABpSCCBCBCCCCCCBBCBBCBBCBBAhAghBAhAgggghAAAAAAAAAAAAAAAGlgIggggQQIIQggQIQgIQQQIIQIIIEEIIEIIIEEAAAAAAAAAAAAAAAaQQQQQQQQQIIQIIEIEIIQEIQQIIEICIEJYQIQgQAAAAAAAAAAAAAAAaQhBBAhAiVBCBCCBCBCCCAhAhCBCBAiAgggggggAAAAAAAAAAAAAAAaSBCBBBCCBBCCBCCCCBCAghAhAhBAhBBAQhBAQAAAAAAAAAAAAAAAGjECCIEIIEEIEEEIECCECBCCCCBCCECCCCBBBAAAAAAAAAAAAAAAAGjQQQQIQgQIIIIEIQQQQIIIQIEIIIEEIIEEIEAAAAAAAAAAAAAAAAGiCECECEBCCAiCBEBBBAiCAhBBAghBAhBBAggAAAAAAAAAAAAAAAAaIQgggQgQQggQQQgQQIQIIgQQIEIQEIEIIEEAAAAAAAAAAAAAAAABokEEIIEIEEECCCCECEECCBEBECBCCBBCBBBAAAAAAAAAAAAAAAAAGhECCECCEECECBECCCCCCCCAiBCCCCAghAggAAAAAAAAAAAAAAAABoSCCEEECCBCBAiCBBBBBBBAhBBAggghAhBAAAAAAAAAAAAAAAAAAaGECCBBBBCCBAhBBAgghCWECECEBECBBEBCAAAAAAAAAAAAAAAAAAaAgQQIIIQQIQQIQIIQIIQIIEEEIIEIIIEQAAAAAAAAAAAAAAAAAAaBAhAQhARAgQQQggQQgQQgQIQQQQIQQQQIAAAAAAAAAAAAAAAAAAd8QIIICCIEEEEECEEEIEECCECECEEECCCAAAAAAAAAAAAAAAAAABoIgQQIQQIIIQIIIQIEQQIIIIEIEIEIIIIAAAAAAAAAAAAAAAAAAB3xCBCECCCBCECCCBCCCBCBBBAhBBCCBAgAAAAAAAAAAAAAAAAAAHfgggghAQgQQIIgQQgQgIQQQQgQIIIQIEAAAAAAAAAAAAAAAAAAAd4QgQgggQQQIQIQQQIQEIQIIIIIEEIQIAAAAAAAAAAAAAAAAAAAHegQIQQIQIIQQQIEIEEIEEEIIIECEIICAAAAAAAAAAAAAAAAAAAB3QgghAggQggQggQhAgQQgQIIQIQQgQIAAAAAAAAAAAAAAAAAAAB3SCCBBCCAiAiBAhCCBAQgiAiAQgQhAgAAAAAAAAAAAAAAAAAAAB3UEEEICEECECECEEICBCEBBECCCBCBCUAAAAAAAAAAAAAAAAAAAHcCCEEECCBCCEEAiCCCBBBAiBBBCAhAAAAAAAAAAAAAAAAAAAAAdxAggggggggQgQQggQQQQgQQIIIQQQAAAAAAAAAAAAAAAAAAAAB3IIIIEIICEEIEECECEEEEEEECECCCAAAAAAAAAAAAAAAAAAAAAHbICEECECEIJYQQIIIIEIIEIIIIEIEAAAAAAAAAAAAAAAAAAAAAHbQQQIIQEIIEIEEEIIIEEIIIEEIEEAAAAAAAAAAAAAAAAAAAAAB20QIIEIIEEIICIIIECEECIBEEEEEAAAAAAAAAAAAAAAAAAAAAAdogggQIQQQgIIQQIQQEIQEQIEEIIAAAAAAAAAAAAAAAAAAAAAAdpCAhAiBBAggQhAhAggQgQQgQggQAAAAAAAAAAAAAAAAAAAAAAdqBCCCEBCCBCBBCCBAhAiCAhBAggAAAAAAAAAAAAAAAAAAAAAAdkggQgQgQIQggIQQQIIgIIIIQIIAAAAAAAAAAAAAAAAAAAAAAB2YCCICEEECCEICCEECBCBCCCBCAAAAAAAAAAAAAAAAAAAAAAAHYECECBCEECBEEBBCBBCCCBCCAgAAAAAAAAAAAAAAAAAAAAAAB2BCBBBCEBBCBBCBAhBAhBBBAggAAAAAAAAAAAAAAAAAAAAAAAdiBBBBBBCBBBBAhAhAhAgQhBBAAAAAAAAAAAAAAAAAAAAAAAAHXCIEEEECCCCECCCCCEBECBECAAAAAAAAAAAAAAAAAAAAAAAAHXIIIQIQEIIEIEIEEIIEIEJYgIAAAAAAAAAAAAAAAAAAAAAAAAdeCCCCCCBCBCBAhAhBAhAghBAAAAAAAAAAAAAAAAAAAAAAAAAdYQggQIQIIgQIQQQQIEEIIIIAAAAAAAAAAAAAAAAAAAAAAAAB1iEEEECBECCCEEBBEsEIIIQEAAAAAAAAAAAAAAAAAAAAAAAAAdZCECCCCBCCCCCBBCBBBBBBAAAAAAAAAAAAAAAAAAAAAAAAAB1SCBBBBBCBAhAhBCBBAgghAAAAAAAAAAAAAAAAAAAAAAAAAAdVBBBCCBAhBBAhAiAgQgRAgAAAAAAAAAAAAAAAAAAAAAAAAAHVhBAggghAghAQhAgQQQggQAAAAAAAAAAAAAAAAAAAAAAAAAB1CCECCCCCCCBAiBCBCBBBAAAAAAAAAAAAAAAAAAAAAAAAAAB1EEIECCECECEEECECEBCBAAAAAAAAAAAAAAAAAAAAAAAAAAB0xBAghAggQgQQggQQQQQgAAAAAAAAAAAAAAAAAAAAAAAAAAHTIEIIIIIIEIIIQIEEEEEAAAAAAAAAA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tt6NtvRttvRttvRtvwtVVVVVVVVVVVVVVJtt6Ntt6Nt6LRtt6Ntt6Ntt6Ntt6NtvRttvRtt6NttvR+Eaqqqqqqqqqqqqq6no223o223o2229G23o223o223o229G229Fo23o229G22/BtVVVVVVVVVVVVUm223o229G229G23o2229G23o223o223o223o229G229G34Iqqqqqqqqqqqqrqbb0bbb0bb0bbbejbb0bbb0bbb0bbb0bbejbbb0bbejbb0fgOqqqqqqqqqqqq69G229G229G229G23o2229G23o223o229G229G229G229G2/n/VVVVVVVVVVVU223o2229G23o229G229G229G229G23o223o223o223o222+/P2qqqqqqqqqqq623o23o223o223o223o223o229G229G229G229G23o223o21Xz9qqqqqqqqqqqWjbbejbbejbb0bbbejbejbbejbbb0bbejbbejbb0bbbejbb7V8/aqqqqqqqqqrrbb0bbb0bb0bbbejbbejbbejbb0bbb0bbb0bbejbbejbbejVVfP2qqqqqqqqqpPRtt6NttvRttvRtt6NttvRtt6NtvRttvRttvRttt6NtvRtvtVXz9qqqqqqqqquttt6NttvRtt6NtvRttvRttvRttvRttvRtt6Ntt6Ntt6Nttuqqvn7VVVVVVVVUm29G23o229G229G229G229G229G23o223o223o223o229G32qqr5+1VVVVVVVXVo223o223o223o223o23o223o223o223o223o223o229G226qqq+ftVVVVVVVSbbejbbejbb0bbb0bbb0bbejbbejbbejbbejbb0bbb0bbb0faqqqvn7VVVVVVVdT0bbb0bbb0bbb0bbb0bbb0bbejbbejbbejbbejbb0bbb0ba7VVVVfP2qqqqqqpNttvRtt6Ntt6NtvRttvRttvRttvRtt6Ntt6Ntt6Ntt6Nttqqqqqr5+1VVVVVXU23o23o2229G229G23o223o223o223o229G229G229G23o2u1VVVVXz9qqqqqqS0bbb0bbb0bbb0bbejbbejbbejbb0bbb0bbb0bbb0bbejbbVVVVVVXz9qqqqqpttvRttvRtt6Ntt6Ntt6Ntt6Ntt6NtvRttvRtt6Ntt6Nttt9qqqqqqvn7VVVVV1tvRtvRttvRttvRttvRttvRtt6Ntt6Ntt6Nt6NttvRttvRtqqqqqqqr5+1VVVU2223o229G229G229G229G229G23o223o229G223o229G22+1VVVVVVXz9qqqq6229G23o229G223o229G223o229G23o2229G23o223o223o1VVVVVVVV8/aqqqT0bbb0bbb0bbb0bbejbbejbb0bbb0bbb0bbb0bbb0bbb0bb7VVVVVVVVfP2qqrrbbejbbejbbejbejbbb0bbb0bbb0bbb0bbb0bb0bbb0bbbbqqqqqqqqq+ftVVJtvRtvRttt6NtvRttvRttvRtt6Ntt6Ntt6NtvRttvRttvRt9qqqqqqqqqvn7VV1aNtt6NtvRttvRtt6Ntt6Ntt6Ntt6Ntt6Ntt6NtvRttvRttuqqqqqqqqqr5+1Um23o223o23o2229G229G23o223o229G223o229G223o23o32qqqqqqqqqq+ftXU9G229G229G229G23o223o229G223o223o229G229G229G26qqqqqqqqqqvn7Sbbb0bbb0bbb0bbejbbejbb0bbbejbb0bbb0bbb0bbejbbbVVVVVVVVVVVV8/eptvRtvRttvRttvRttvRttvRttvRtt6Ntt6Ntt6NtvRttvRtdqqqqqqqqqqqr5/PRtt6NttvRtt6Ntt6NtvRttvRttvRttvRttvRttvRttvRttVVVVVVVVVVVVXgNtvRttvRttvRtt6Ntt6NtvRttvRttvRttvRtt6Ntt6Ntt6LtVVVVVVVVVVVVeB9G23o2229G229G29G223o23o2229G23o223o223o223o21VVVVVVVVVVVVVeDG3o223o229G229G23o223o223o229G223o223o229G22+1VVVVVVVVVVVVV4Rbbb0bbejbb0bbb0bbb0bbbejbb0bbejbbejbbejbb0bVVVVVVVVVVVVVVV4Vejbbejbb0bbejbbbejbb0bbejbbejbbejbbejbb0bbfaqqqqqqqqqqqqqq8NNt6Ntt6NtvRtt6NttvRtt6Ntt6Ntt6Ntt6Ntt6NtvRVVVVVVVVVVVVVVVXh9ttvRttvRttvRtt6Ntt6NtvRttt6NtvRttvRttvRt9qqqqqqqqqqqqqqqrxG3o223o223o229G229G229G229G23o2229G23o223VVVVVVVVVVVVVVVVeKG29G229G223o229G229G23o2229G23o223o223o+1VVVVVVVVVVVVVVVV4s0bbbejbb0bbbejbejbbb0bbejbbejbbejbb0bbdVVVVVVVVVVVVVVVVV4xbb0bbb0bb0bbbejbbejbbejbb0bbb0bbb0bbenaqqqqqqqqqqqqqqqqq8a6NtvRttvRttvRtt6NttvRtt6NtvRttvRttvRtdqqqqqqqqqqqqqqqqqq8dN6Ntt6NtvRttvRttvRtt6Ntt6NttvRtt6NttVVVVVVVVVVVVVVVVVVV4/bbejbb0bbb0bbb0bbb0bbb0bbejbbejbb0a7VVVVVVVVVVVVVVVVVVV5Dejbb0bbbejbejbbb0bbejbb0bbbejbbejbVVVVVVVVVVVVVVVVVVVVeSG9G223o229G229G229G229G23o223o222+1VVVVVVVVVVVVVVVVVVVeTW229G229G23o223o223o223o223o229G1VVVVVVVVVVVVVVVVVVVVXlFvRtt6Ntt6Ntt6Ntt6Ntt6NtvRttvRtt9qqqqqqqqqqqqqqqqqqqqq8rNt6Ntt6Ntt6Ntt6NtvRttvRttvRttvRVVVVVVVVVVVVVVVVVVVVVV5aejbejbbb0bbb0bbejbbejbbejbbejb7VVVVVVVVVVVVVVVVVVVVVV5fbejbbejbbejbejbbbejbb0bbb0bbbqqqqqqqqqqqqqqqqqqqqqqrzHo23o223o2229G229G29G223o229G+1VVVVVVVVVVVVVVVVVVVVVVeaG9G229G229G23o223o229G223o23VVVVVVVVVVVVVVVVVVVVVVVXm1tt6Ntt6NtvRttvRtt6Ntt6NtttVVVVVVVVVVVVVVVVVVVVVVVVecXo223o229G229G229G23o223o2u1VVVVVVVVVVVVVVVVVVVVVVVXnZvRttt6Ntt6Ntt6NtvRttvRttqqqqqqqqqqqqqqqqqqqqqqqqqrz2223o229G229G229G223o23o12qqqqqqqqqqqqqqqqqqqqqqqqq8/vRttt6NtvRttvRtt6Ntt6Ntqqqqqqqqqqqqqqqqqqqqqqqqqqr8Ebb0bbb0bbb0bbb0bbejbbb7VVVVVVVVVVVVVVVVVVVVVVVVVVfhGjbbejbbejbejbbejbbb0bVVVVVVVVVVVVVVVVVVVVVVVVVVVX4Y9G23o2229G23o223o223p2qqqqqqqqqqqqqqqqqqqqqqqqqqq//xAAYEAEBAAMAAAAAAAAAAAAAAAARwJCw0P/aAAgBAQABPwCYCcd7YFunhZfR5N//AP/EABwRAAIDAQEBAQAAAAAAAAAAABEwAVBgQHAAgP/aAAgBAgEBAgC/FvF+LYXwoAqFjKigGUHi4xMcw1YUOUYkauFhQ5RlBQBcLFnHMFQsKhkWgoIWFBQsxQQweAC+CgoKCoZGJEVgULMKFsIvx+AgoKjQwscosxVhQ2wvhywsKChoBlByhULCoWNAFC+CgocojbDlF8FhQ1Q5RlAoc0ZWKEcsYoaCOYKCgoKi1HIKwWYoBzDKDlChlByjwyLQKCh4AFAcsWgVCwoUIz45RfBULHKIxQqxiY+jwEKCgoBIyg2w5oz45oyoqwM/CwoYkeGBQygoQqNAFBQyg5o1YVHq4VHgMfRoI5hGfFDGgHhg9O//xAAUEQEAAAAAAAAAAAAAAAAAAADA/9oACAECAQM/AH8H/8QAGBEBAQEBAQAAAAAAAAAAAAAAAVAAYBH/2gAIAQMBAQIAqgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAApAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAngAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABK8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAieAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAieAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAieAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAETwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADyOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeWgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxQAAAAAAAAAAAAAAAAAAAAAAAAAAAABxgAAAAAAAAAAAAAAAAAAAAAAAAAAAAcaAAAAAAAAAAAAAAAAAAAAAAAAAAAceAAAAAAAAAAAAAAAAAAAAAAAAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAHJAYAMYxgADGADAYwAYDGMBjAYwGMYOT/8QAFBEBAAAAAAAAAAAAAAAAAAAAwP/aAAgBAwEDPwB/B//Z");',"    background-position: center;","    background-repeat: no-repeat;","    background-size: cover;","    z-index:1;","}","","#application-game-logo {","    position: absolute;","    text-align: center;","    width: 95vmin;","    height: 95vmin;","    max-width: 880px;","    max-height: 880px;","    background-size: contain;","    background-position: center;","    background-repeat: no-repeat;",'    background-image: url("data:image/png;base64,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cVlEJb7BDLAqwRMFUf7Elvwt+OQl4GwVaa444FKWKoaOk0SUkjOzpJ9KFRHsSSugAkbc2xV+J4goCxWvGGbqI0bXkA98SuJ/WSSy6fgNax8nEuiV19945ZVXEZsq+QRa2NqSD8lp/jmeYJkLlkoxziYrC+6kz8SmgkERcBlaARWi0wVTurfr7bBrFWEicQJWnBt023G3JejM2yji4+65TLyub8PGjSvlibW1v12nnCBcfYk6l/dnXi94wp0JNDtys7OzF/JUr4xlpmhN2W1EYJkAWLihsbhYSZMmYELzblLMCjCNgPkXdSkIEt0F3ZGgN98846srvv7yo7kHqK68+v6rrjr//LMvevSee0BoI681jFMMu1cy4EkNmtX+DXhKOAlNGc5UHQvoEZaZCVsXKEyTaXyuTQQqMkzKoDgyWqhVM2BKRkF0sKdZLZgnnHLBDXfefR/IvUz0yivg99XXX3/95ZdffgR9/vnnH3744QeS3n331VeffPLee+994IGHH374ppvufvQeinXNNZ7yvgU8+YKo6pvEWKsHTaoVBFwVfo8aTCXx5jS1lb/xmnhdmATSJMJUtbdmmvQFgMngEJHGRbZD0+keXc78KzBPuQAc77rj5cefevzpl9/86msKb/fuD6lef/2TTz555plnnn/+2Wefe+65FyE8Pfvs888888knrxPClOuTTYTrTWAKpGsY5x/snV1oW2UYxyta8bso6FAEwQ/UIX5/zS9EvWorVp2LdRynbWxTexJPstRDqY11WqmabkLxphCaQFroqtILLzoV2rXiB1IcvfDjxjspXuiVIhUE/8/zvu95zslJ0qY6PYX9p1u3JF3Zr8/3875B3XL13hckITru4UyCTC2eYqBhlv4erOE5/AfawrgubAp/h982Pe2Nf9K2t/+d919swzAs+fmJzz/Xrdk+DfOS7ZGERQJk98svv5wYAciFKcApzszm51PZdMZ1bMtqtUit7e1PPtkeUCsesR03k04RVqb6jiEa2Qm2qVv4X507RAqn0KztcOvbpW+H863fj5jba76syjP5ybMHkv1v4r6aL+PJoY9eOQHb/Icwz9gFkrkOgOzuyLWApAI5n8oAYitoETLLjeUL09PThXws7fKfQgGmLGAlqjDVsbH7iChMNKrWqesWIqI6RNyo7QOd2jjF4QrLYcCrri/PVw1ETFbF4fqg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");',"}","#progress-bar-container {","    position:fixed;","    bottom:0;","    left:0;","    width:100%;","    z-index:2;","    margin: 20px auto 0 auto;","    height: 40px;","    background-color: #1F2933;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    z-index:2;","    background-color: #ffa000;","}"].join("\n"),(Q=document.createElement("style")).type="text/css",Q.styleSheet?Q.styleSheet.cssText=C:Q.appendChild(document.createTextNode(C)),document.head.appendChild(Q),function(){var A=document.createElement("div");A.id="application-splash-wrapper",document.body.appendChild(A);var C=document.createElement("div");C.id="application-game-logo",A.appendChild(C);var Q=document.createElement("div");Q.id="progress-bar-container",A.appendChild(Q);var B=document.createElement("div");B.id="progress-bar",Q.appendChild(B);let I=document.getElementById("application-canvas");I&&(I.style.zIndex=-1)}(),A.on("preload:end",(function(){A.off("preload:progress")})),A.on("preload:progress",(function(A){var C=document.getElementById("progress-bar");C&&(A=Math.min(1,Math.max(0,A)),C.style.width=100*A+"%")})),A.on("poki:ready",(function(){let A=document.getElementById("application-canvas");A&&A.style.removeProperty("z-index");var C=document.getElementById("application-splash-wrapper");C&&C.parentElement.removeChild(C),document.body.style.backgroundColor="#1d292c"}))}));var AudioSystem=pc.createScript("audioSystem");AudioSystem.attributes.add("chorusLoop",{type:"entity"}),AudioSystem.prototype.initialize=function(){this.app.on("region:unlock",this._playUnlockSound,this),this.app.on("skills:upgrade",this._playUnlockSound,this),this.app.on("vehicle:purchase",this._playUnlockSound,this),this.app.on("vehicle:player:spawn",this._playChorusLoop,this)},AudioSystem.prototype._playUnlockSound=function(){this.entity.sound.play("unlock")},AudioSystem.prototype._playChorusLoop=function(){this.app.playerStats.settings.musicMuted||(this.chorusLoop.enabled=!0,this.chorusLoop.sound.slots["chorus-loop"].off("load"),this.chorusLoop.sound.slots["chorus-loop"].on("load",function(o){this.chorusLoop.fire("audio:load"),this.chorusLoop.sound.play("chorus-loop")}.bind(this)))},AudioSystem.prototype.muteMusic=function(){this.chorusLoop.sound.pause("chorus-loop"),this.chorusLoop.enabled=!1},AudioSystem.prototype.unmuteMusic=function(){this.chorusLoop.enabled=!0,this.chorusLoop.sound.play("chorus-loop")};var AudioFade=pc.createScript("audioFade");AudioFade.attributes.add("fadeInEvent",{type:"string",description:"Fade in will start as soon as this event is fired upon the entity"}),AudioFade.attributes.add("fadeInCurve",{type:"curve",description:"Shape of the fade in curve",default:{keys:[0,0,1,1],type:pc.CURVE_SMOOTHSTEP}}),AudioFade.attributes.add("fadeDuration",{type:"number",default:3,description:"Duration in seconds to fade the audio in"}),AudioFade.prototype.initialize=function(){this._fadeCountdownMs=0,this.entity.on(this.fadeInEvent,this._fadeIn,this)},AudioFade.prototype._fadeIn=function(){this._fadeCountdownMs=this.fadeDuration},AudioFade.prototype.update=function(t){if(this._fadeCountdownMs>0){this._fadeCountdownMs-=t,this._fadeCountdownMs<0&&(this._fadeCountdownMs=0);let e=1-this._fadeCountdownMs/this.fadeDuration,d=this.fadeInCurve.value(e);this.entity.sound.volume=d}};var ProgressBar=pc.createScript("progressBar");ProgressBar.attributes.add("scaleTimeS",{type:"number",default:.33}),ProgressBar.attributes.add("scaleCurve",{type:"curve",default:{keys:[0,0,1,1],type:pc.CURVE_SMOOTHSTEP}}),ProgressBar.prototype.initialize=function(){this._scaleTimeCountdownS=0,this._MAX_WIDTH=this.entity.element.width},ProgressBar.prototype.setPercentage=function(e){e<0?e=0:e>1&&(e=1),this._scaleTimeCountdownS=this.scaleTimeS,this._targetWidth=this._MAX_WIDTH*e},ProgressBar.prototype.update=function(e){if(this._scaleTimeCountdownS>0){this._scaleTimeCountdownS-=e;let t=1-this._scaleTimeCountdownS/this.scaleTimeS,s=this.scaleCurve.value(t),i=this._targetWidth*s;this.entity.element.width=i}};var VehicleStatsUi=pc.createScript("vehicleStatsUi");VehicleStatsUi.attributes.add("nameLabel",{type:"entity"}),VehicleStatsUi.attributes.add("topSpeedBar",{type:"entity"}),VehicleStatsUi.attributes.add("accelerationBar",{type:"entity"}),VehicleStatsUi.attributes.add("turnBar",{type:"entity"}),VehicleStatsUi.attributes.add("boostIcon",{type:"entity"}),VehicleStatsUi.attributes.add("boostLabel",{type:"entity"}),VehicleStatsUi.attributes.add("watchAdForBoostButton",{type:"entity"}),VehicleStatsUi.attributes.add("healthLabel",{type:"entity"}),VehicleStatsUi.attributes.add("healthBar",{type:"entity"}),VehicleStatsUi.attributes.add("healthBarContainer",{type:"entity"}),VehicleStatsUi.attributes.add("repairWarning",{type:"entity"}),VehicleStatsUi.attributes.add("boostGroup",{type:"entity"}),VehicleStatsUi.attributes.add("healthGroup",{type:"entity"}),VehicleStatsUi.prototype.initialize=function(){this._vehicleName="",this._REWARDED_BOOST_S=9,this._boostValue={actual:0,displayed:0},this.app.on("vehicle:player:repair",this._showHealth,this),this.watchAdForBoostButton.button.on("click",this._watchAdForBoost,this)},VehicleStatsUi.prototype.showStats=function(t){this._vehicleName=t.name,this.nameLabel.element.text=t.name;const e=t.script.vehicle.maxSpeed,i=t.script.vehicle.maxEngineForce,a=t.rigidbody.mass,s=t.script.vehicle.maxSteering,h=(e-45)/30;this.topSpeedBar.script.progressBar.setPercentage(h);const l=i/a/10;if(this.accelerationBar.script.progressBar.setPercentage(l),this.turnBar.script.progressBar.setPercentage(s),this.app.isVehicleOwned(t.name)){this.boostGroup.enabled=!0,this.healthGroup.enabled=!0;let e=this.app.playerStats.vehicles[t.name].boostTime;e||(e=0),this._boostValue.actual=e,this._boostValue.displayed=e,this.boostLabel.element.text=Math.round(this._boostValue.displayed/3)+"x",this._showHealth(this._vehicleName)}else this.boostGroup.enabled=!1,this.healthGroup.enabled=!1,this.repairWarning.script.flashingElement.stop(),this.repairWarning.enabled=!1},VehicleStatsUi.prototype._showHealth=function(t){if(this.app.isVehicleOwned(t)){let e=this.app.playerStats.vehicles[t].health;this.healthBar.enabled=!0,this.healthLabel.enabled=!0,this.healthBarContainer.enabled=!0,this.healthBar.script.progressBar.setPercentage(e/100),e<=1?(this.repairWarning.enabled=!0,this.repairWarning.script.flashingElement.start()):(this.repairWarning.script.flashingElement.stop(),this.repairWarning.enabled=!1)}else this.healthBar.enabled=!1,this.healthLabel.enabled=!1,this.healthBarContainer.enabled=!1,this.repairWarning.script.flashingElement.stop(),this.repairWarning.enabled=!1},VehicleStatsUi.prototype._watchAdForBoost=function(){this.app.fire("poki:rewardedBreak:play",function(){this._addBoost()}.bind(this),function(){}.bind(this))},VehicleStatsUi.prototype._addBoost=function(){this.app.playerStats.vehicles[this._vehicleName].boostTime||(this.app.playerStats.vehicles[this._vehicleName].boostTime=0),this.app.playerStats.vehicles[this._vehicleName].boostTime+=this._REWARDED_BOOST_S;const t=this.app.playerStats.vehicles[this._vehicleName].boostTime;this.app.fire("vehicle:boost:add",this._vehicleName,t),this._boostValue.actual=t,this.boostIcon.script.pulsingElement.play(),this.boostLabel.script.shakyElement.play()},VehicleStatsUi.prototype.update=function(t){this._boostValue.actual!=this._boostValue.displayed&&(this._boostValue.displayed=pc.math.lerp(this._boostValue.displayed,this._boostValue.actual,.05),this.boostLabel.element.text=Math.round(this._boostValue.displayed/3)+"x")};var FlashingElement=pc.createScript("flashingElement");FlashingElement.attributes.add("flashTimeS",{type:"number",default:1}),FlashingElement.attributes.add("continuous",{type:"boolean",default:!0}),FlashingElement.attributes.add("autoStart",{type:"boolean",default:!1}),FlashingElement.attributes.add("opacityCurve",{type:"curve",default:{keys:[0,1,.5,0,1,1],type:pc.CURVE_SMOOTHSTEP}}),FlashingElement.prototype.initialize=function(){this._flashCountdownS=0,this.autoStart&&this.start()},FlashingElement.prototype.start=function(){this._flashCountdownS=this.flashTimeS},FlashingElement.prototype.stop=function(){this._flashCountdownS=0},FlashingElement.prototype.update=function(t){if(this._flashCountdownS>0){if(this._flashCountdownS-=t,this._flashCountdownS<=0){if(!this.continuous)return;this.start()}let e=1-this._flashCountdownS/this.flashTimeS,n=this.opacityCurve.value(e);this.entity.element.opacity=n}};var UiSounds=pc.createScript("uiSounds");UiSounds.prototype.initialize=function(){this.app.on("ui:click",this._playClick,this)},UiSounds.prototype._playClick=function(){this.entity.sound.play("click")};var AudioSettings=pc.createScript("audioSettings");AudioSettings.attributes.add("sfxButton",{type:"entity"}),AudioSettings.attributes.add("musicButton",{type:"entity"}),AudioSettings.prototype.initialize=function(){this.app.on("stats:loaded",this._setStartingValues,this),this.sfxButton.button.on("click",this._toggleSFX,this),this.musicButton.button.on("click",this._toggleMusic,this),this._setStartingValues(),this.app.audioSettings={getSFXVolume:function(){return this.app.playerStats.settings.sfxMuted?0:1}.bind(this),getMusicVolume:function(){return this.app.playerStats.settings.musicMuted?0:1}.bind(this)}},AudioSettings.prototype._setStartingValues=function(){this._setButtonState(this.sfxButton,this.app.playerStats.settings.sfxMuted),this._setButtonState(this.musicButton,this.app.playerStats.settings.musicMuted),this._setSFXVolume(),this._setMusicVolume()},AudioSettings.prototype._toggleSFX=function(){this.app.playerStats.settings.sfxMuted=!this.app.playerStats.settings.sfxMuted,this._setButtonState(this.sfxButton,this.app.playerStats.settings.sfxMuted),this._setSFXVolume(),this.app.fire("settings:change")},AudioSettings.prototype._setSFXVolume=function(){this.app.playerStats.settings.sfxMuted?this.app.systems.sound.volume=0:this.app.systems.sound.volume=1},AudioSettings.prototype._toggleMusic=function(){this.app.playerStats.settings.musicMuted=!this.app.playerStats.settings.musicMuted,this._setButtonState(this.musicButton,this.app.playerStats.settings.musicMuted),this._setMusicVolume(),this.app.fire("settings:change")},AudioSettings.prototype._setMusicVolume=function(){this.app.playerStats.settings.musicMuted?this.entity.script.audioSystem.muteMusic():this.entity.script.audioSystem.unmuteMusic()},AudioSettings.prototype._setButtonState=function(t,s){s?(t.element.opacity=.66,t.findByName("Mute Icon").enabled=!0):(t.element.opacity=1,t.findByName("Mute Icon").enabled=!1)};var UiJobsButton=pc.createScript("uiJobsButton");UiJobsButton.attributes.add("counterBadge",{type:"entity"}),UiJobsButton.prototype.initialize=function(){this.counterBadge.on("badge:shown",function(){this.entity.script.shakyElement.play()}.bind(this)),this.counterBadge.on("badge:hidden",function(){this.entity.script.shakyElement.stop()}.bind(this))};var ProgressRadial=pc.createScript("progressRadial");ProgressRadial.prototype.initialize=function(){this._element=this.entity.element,this._element.material=this._element.material.clone(),this.setProgress(1)},ProgressRadial.prototype.setProgress=function(e){e=pc.math.clamp(e,0,1),this._progress=e,this._element.material.alphaTest=e+.001};var UiBoostButton=pc.createScript("uiBoostButton");UiBoostButton.attributes.add("ringBacking",{type:"entity"}),UiBoostButton.attributes.add("radialBar",{type:"entity"}),UiBoostButton.attributes.add("boostTimer",{type:"entity"}),UiBoostButton.attributes.add("boostIcon",{type:"entity"}),UiBoostButton.attributes.add("hotkey",{type:"entity"}),UiBoostButton.prototype.initialize=function(){this._hotkeyUsed=!1,this.app.isUsingTouch&&(this.hotkey.enabled=!1)},UiBoostButton.prototype._activateBoost=function(){if(this.app.globals.currentVehicle){if(this.hotkey.enabled=!1,this.app.globals.currentVehicle.script.vehicle.isBoosting())return;this.app.globals.currentVehicle.script.vehicle.boost(),this.app.fire("vehicle:boost:use",this.app.globals.currentVehicle.vehicleName,this.app.globals.currentVehicle.script.vehicle.getBoostTime())}},UiBoostButton.prototype._bindBoostKey=function(t){t.key==pc.KEY_E&&(this._hotkeyUsed=!0,this.hotkey.enabled=!1,this._activateBoost())},UiBoostButton.prototype.show=function(){this.entity.button.active=!0,this.entity.element.enabled=!0,this.boostIcon.enabled=!0,this.boostTimer.enabled=!0,this.radialBar.enabled=!0,this.ringBacking.enabled=!0,this.radialBar.script.progressRadial.setProgress(0),this.app.isUsingTouch||this._hotkeyUsed||(this.hotkey.enabled=!0);const t=this.app.globals.currentVehicle.script.vehicle;if(t.getBoostTime()>0){const e=Math.round(t.getBoostTime()/3)+"x";this.boostTimer.element.text=e}this.entity.button.off(),this.entity.button.on("click",this._activateBoost,this),this.app.keyboard.on("keydown",this._bindBoostKey,this)},UiBoostButton.prototype.hide=function(){this.entity.button.active=!1,this.entity.element.enabled=!1,this.boostIcon.enabled=!1,this.boostTimer.element.text="",this.boostTimer.enabled=!1,this.radialBar.enabled=!1,this.ringBacking.enabled=!1,this.hotkey.enabled=!1,this.entity.button.off(),this.app.keyboard.off("keydown",this._bindBoostKey,this)},UiBoostButton.prototype.update=function(t){if(this.app.globals.currentVehicle){let t=this.app.globals.currentVehicle.script.vehicle;if(t.isBoosting()){let e=1-t.getBoostPercentage();this.boostIcon.script.shakyElement.rotationMultiplier=3.6,this.boostIcon.script.shakyElement.rotationTimeS=.1,this.radialBar.script.progressRadial.setProgress(e)}else this.radialBar.script.progressRadial.setProgress(0),this.boostIcon.script.shakyElement.rotationMultiplier=1,this.boostIcon.script.shakyElement.rotationTimeS=.66;const e=t.getBoostTime()+t.getBoostCountdownS(),i=Math.round(e/3)+"x";this.boostTimer.element.text=i,e<=0&&this.entity.element.enabled?this.hide():e>0&&!this.entity.element.enabled&&this.show()}};var JumpBoost=pc.createScript("jumpBoost");JumpBoost.attributes.add("impulseMultiplier",{type:"number",default:1,description:"Adjusts boost impulse."}),JumpBoost.attributes.add("jumpTrigger",{type:"entity"}),JumpBoost.prototype.initialize=function(){this._triggeredEntity=null,this._enterTime=0,this._direction=(new pc.Vec3).sub2(this.jumpTrigger.getPosition(),this.entity.getPosition()),this._direction.normalize(),this.entity.collision.on("triggerenter",function(i){if(i.script&&i.script.vehicle&&i.script.vehicle.isPlayerControlled&&this._isGoingFastEnough(i.script.vehicle)){this._triggeredEntity=i,this._enterTime=performance.now();let t=10*i.rigidbody.mass;i.rigidbody.applyImpulse(this._direction.x*(t*this.impulseMultiplier),0,this._direction.z*(t*this.impulseMultiplier),this._direction.x,0,this._direction.z)}}.bind(this))},JumpBoost.prototype.wasTriggeredBy=function(i){return!(performance.now()-this._enterTime>1e3)&&i._guid==this._triggeredEntity._guid},JumpBoost.prototype._isGoingFastEnough=function(i){return!!i&&i.speed>.9*i.maxSpeed};var JumpTrigger=pc.createScript("jumpTrigger");JumpTrigger.attributes.add("boost",{type:"entity"}),JumpTrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",function(t){this.boost.script.jumpBoost.wasTriggeredBy(t)&&this.app.fire("jump:completed",this.entity.parent)}.bind(this))};var JumpsSystem=pc.createScript("jumpsSystem");JumpsSystem.attributes.add("uiState",{type:"entity"}),JumpsSystem.attributes.add("uiProgress",{type:"entity"}),JumpsSystem.attributes.add("uiStateScaleCurve",{type:"curve"}),JumpsSystem.attributes.add("gameResultScreen",{type:"entity"}),JumpsSystem.prototype.initialize=function(){this.UI_VISIBLE_TIME_S=4,this.UI_DELAY_S=.33,this._uiTimeRemaining=0,this._uiDelayRemaining=0,this.app.on("job:time:up",this._hideUI,this),this.app.on("ui:home:show",this._hideUI,this),this.app.on("jump:completed",this._handleJump,this)},JumpsSystem.prototype._handleJump=function(e){let t=this.app.getNumJumpsCompleted();this.app.hasJumpBeenCompleted(e)?(this.app.fire("jump:completed:old",e),t>=30?(this.uiState.element.text="All Jumps Completed!",this.uiProgress.element.text="Nice!"):(this.uiState.element.text="Jump Completed!",this.uiProgress.element.text=30-t+" Left")):(this.app.fire("jump:completed:new",e),t=this.app.getNumJumpsCompleted(),30==t?(this.app.fire("jump:completed:all"),this.uiState.element.text="All Jumps Completed!",this.uiProgress.element.text="Nice!"):(this.uiState.element.text="Jump Completed!",this.uiProgress.element.text=30-t+" Left"),this.entity.sound.play("new-jump")),this._showUI()},JumpsSystem.prototype._showUI=function(){if(this.gameResultScreen.script.deliveryGameResultsScreen.isVisible())this._hideUI();else{this._uiDelayRemaining=this.UI_DELAY_S;let e=this.uiStateScaleCurve.value(0);this.uiState.setLocalScale(e,e,e)}},JumpsSystem.prototype._hideUI=function(){this._uiDelayRemaining=0,this._uiTimeRemaining=0;let e=this.uiStateScaleCurve.value(0);this.uiState.setLocalScale(e,e,e),this.uiState.enabled=!1},JumpsSystem.prototype.update=function(e){if(this._uiDelayRemaining>0)this._uiDelayRemaining-=e,this._uiDelayRemaining<=0&&(this._uiTimeRemaining=this.UI_VISIBLE_TIME_S,this.uiState.enabled=!0);else if(this._uiTimeRemaining>0){this._uiTimeRemaining-=e,this._uiTimeRemaining<=0&&(this._uiTimeRemaining=0,this.uiState.enabled=!1);let t=this._uiTimeRemaining/this.UI_VISIBLE_TIME_S,i=this.uiStateScaleCurve.value(t);this.uiState.setLocalScale(i,i,i)}};var DeliveryGameOfferRewardedBoost=pc.createScript("deliveryGameOfferRewardedBoost");DeliveryGameOfferRewardedBoost.attributes.add("offerButton",{type:"entity"}),DeliveryGameOfferRewardedBoost.attributes.add("hudBoostButton",{type:"entity"}),DeliveryGameOfferRewardedBoost.prototype.initialize=function(){this._checkCountdownS=0,this._CHECK_INTERVAL_S=3,this._MIN_S_BETWEEN_OFFERS=40,this._timeAtLastOffer=0,this.offerButton.enabled=!1,this.setDesktopMode()},DeliveryGameOfferRewardedBoost.prototype.setDesktopMode=function(){this.offerButton.script.uiElementAnimation.position=new pc.CurveSet([[0,180,.05,-150,.95,-150,1,180],[0,0]])},DeliveryGameOfferRewardedBoost.prototype.setMobileLandscapeMode=function(){this.offerButton.script.uiElementAnimation.position=new pc.CurveSet([[0,180,.05,-330,.95,-330,1,180],[0,-40]])},DeliveryGameOfferRewardedBoost.prototype.setMobilePortraitMode=function(){this.offerButton.script.uiElementAnimation.position=new pc.CurveSet([[0,180,.05,-150,.95,-150,1,180],[0,220,0,220]])},DeliveryGameOfferRewardedBoost.prototype.update=function(t){this.app.globals.isDriving&&!this.app.globals.isTutorialRunning&&(this._checkCountdownS-=t,this._checkCountdownS<=0&&(this._attemptOffer(),this._checkCountdownS=this._CHECK_INTERVAL_S))},DeliveryGameOfferRewardedBoost.prototype._attemptOffer=function(){this.offerButton.enabled&&this.offerButton.script.uiElementAnimation.isRunning()||this._carHasBoost()||(this._isJobTimeLow()?this._showOffer():this._isTooSoon()||this._showOffer())},DeliveryGameOfferRewardedBoost.prototype._carHasBoost=function(){if(this.app.globals.currentVehicle){if(this.app.globals.currentVehicle.script.vehicle.getBoostTime()+this.app.globals.currentVehicle.script.vehicle.getBoostCountdownS()>0)return!0}return!1},DeliveryGameOfferRewardedBoost.prototype._isTooSoon=function(){return performance.now()-this._timeAtLastOffer<1e3*this._MIN_S_BETWEEN_OFFERS},DeliveryGameOfferRewardedBoost.prototype._isJobTimeLow=function(){let t=this.app.globals.currentJob;return!(!t||t.isTimeUp||t.isComplete)&&(!(performance.now()-this._timeAtLastOffer<=3e4)&&(t.numDeliveriesRemaining>0&&t.timeRemainingS>=3&&t.timeRemainingS<=30))},DeliveryGameOfferRewardedBoost.prototype._showOffer=function(){let t=6+3*parseInt(pc.math.random(0,3));this.offerButton.findByName("Bonus Amount").element.text=Math.round(t/3)+"x",this.offerButton.button.active=!0,this.offerButton.script.uiElementAnimation.start(),this.offerButton.enabled=!0,this._timeAtLastOffer=performance.now(),this.offerButton.button.off(),this.offerButton.button.on("click",this._watchAdForBoost.bind(this,t),this)},DeliveryGameOfferRewardedBoost.prototype._watchAdForBoost=function(t){this.app.fire("poki:rewardedBreak:play",function(){let e=this.app.globals.currentVehicle.vehicleName;this.app.playerStats.vehicles[e].boostTime||(this.app.playerStats.vehicles[e].boostTime=0),this.app.playerStats.vehicles[e].boostTime+=t;const o=this.app.playerStats.vehicles[e].boostTime;this.app.globals.currentVehicle.script.vehicle.setBoostTime(o),this.app.fire("vehicle:boost:add",e,o),this.hudBoostButton.enabled=!0,this.hudBoostButton.script.uiBoostButton.show(),this.offerButton.script.uiElementAnimation.stop(),this.offerButton.enabled=!1}.bind(this),function(){}.bind(this))};var DrivingScore=pc.createScript("drivingScore");DrivingScore.attributes.add("microScoreTemplate",{type:"asset",assetType:"template"}),DrivingScore.attributes.add("scaleCurve",{type:"curve"}),DrivingScore.attributes.add("yPosCurve",{type:"curve"}),DrivingScore.attributes.add("opacityCurve",{type:"curve"}),DrivingScore.attributes.add("timings",{type:"json",array:!0,schema:[{name:"scoreName",type:"string"},{name:"displayTimeS",type:"number",default:.7},{name:"scoreIntervalS",type:"number",default:.25},{name:"coinYield",type:"number",default:1},{name:"startPos",type:"vec2"}]}),DrivingScore.prototype.initialize=function(){this._timeSAtMaxSpeed=0,this._timeSInAir=0,this._timeSDrifting=0,this._timeSBoosting=0,this._driftScoreCoinLimit=3,this._driftScoreIntervalLimitS=4,this._driftScoreHistory=[],this._microScores=[],this._rayCastFromPos=new pc.Vec3,this._rayCastToPos=new pc.Vec3,this._green=new pc.Color(79/256,.71875,22/256),this._orange=new pc.Color(1,74/256,0),this._blue=new pc.Color(.1875,143/256,255/256),this._yellow=new pc.Color(255/256,179/256,40/256),this.app.on("jump:completed:old",this._awardOldJump,this),this.app.on("jump:completed:new",this._awardNewJump,this)},DrivingScore.prototype.update=function(i){if(this.app.globals.currentVehicle){let t=this.app.globals.currentVehicle.script.vehicle;this._updateAirTime(i,t),this._updateMaxSpeed(i,t),this._updateDriftHistory(i,t),this._updateDriftTime(i,t),this._updateBoostTime(i,t),this._awardMicroScores(i),this._updateMicroScores(i)}},DrivingScore.prototype._updateAirTime=function(i,t){if(t.ammoVehicle){let e=0,r=t.ammoVehicle.getNumWheels();for(let i=0;i<r;i++){t.ammoVehicle.getWheelInfo(i).m_raycastInfo.m_isInContact&&(e+=1)}e<=0&&t.speed>=.33*t.maxSpeed?this._timeSInAir+=i:this._timeSInAir=0,t.isSubmerged&&(this._timeSInAir=0)}},DrivingScore.prototype._updateMaxSpeed=function(i,t){t.speed>=t.maxSpeed-1?this._timeSAtMaxSpeed+=i:this._timeSAtMaxSpeed=0,t.isSubmerged&&(this._timeSAtMaxSpeed=0)},DrivingScore.prototype._updateDriftHistory=function(i,t){this._driftScoreHistory.length>0&&performance.now()-this._driftScoreHistory[0]>=1e3*this._driftScoreIntervalLimitS&&this._driftScoreHistory.shift()},DrivingScore.prototype._updateDriftTime=function(i,t){t.isDrifting&&t.speed>=.5*t.maxSpeed&&(this._timeSDrifting+=i)},DrivingScore.prototype._updateBoostTime=function(i,t){t.isBoosting()&&!this.app.globals.isHomeScreenOpen&&(this._timeSBoosting+=i)},DrivingScore.prototype._awardMicroScores=function(i){this._timeSInAir>=this.timings[1].scoreIntervalS?(this._timeSInAir=0,this._awardCoins(this.timings[1].coinYield),this._createMicroScore(this.timings[1])):this._timeSDrifting>=this.timings[2].scoreIntervalS&&(this._readyForDriftAward()&&(this._driftScoreHistory.push(performance.now()),this._awardCoins(this.timings[2].coinYield),this._createMicroScore(this.timings[2],this._orange)),this._timeSDrifting=0),this._timeSBoosting>=this.timings[3].scoreIntervalS&&(this._timeSBoosting=0,this._awardCoins(this.timings[3].coinYield),this._createMicroScore(this.timings[3],this._blue)),this._timeSAtMaxSpeed>=this.timings[0].scoreIntervalS&&(this._timeSAtMaxSpeed=0,this._awardCoins(this.timings[0].coinYield),this._createMicroScore(this.timings[0],this._green))},DrivingScore.prototype._readyForDriftAward=function(){if(this._driftScoreHistory.length<this._driftScoreCoinLimit)return!0;if(this._driftScoreHistory.length>0){let i=this._driftScoreHistory[0];if(performance.now()-i>=1e3*this._driftScoreIntervalLimitS)return this._driftScoreHistory.shift(),!0}return!1},DrivingScore.prototype._awardCoins=function(i){this.app.fire("driving:score",i)},DrivingScore.prototype._awardOldJump=function(){this._createMicroScore(this.timings[5],this._yellow)},DrivingScore.prototype._awardNewJump=function(){this._createMicroScore(this.timings[4],this._yellow)},DrivingScore.prototype._createMicroScore=function(i,t=null){let e=this.microScoreTemplate.resource.instantiate();e.element.text=i.scoreName+" +"+i.coinYield,t&&(e.element.color=t),this.entity.addChild(e),this._microScores.push({entity:e,countdownS:i.displayTimeS,config:i})},DrivingScore.prototype._updateMicroScores=function(i){for(let t in this._microScores){let e=this._microScores[t],r=e.entity,o=r.element;if(e.countdownS-=i,e.countdownS<=0)this.entity.removeChild(e.entity),e.entity.destroy();else{const i=1-e.countdownS/e.config.displayTimeS;this.app.globals.isTouchPortrait&&(e.config.startPos.y=200),r.setLocalPosition(e.config.startPos.x,e.config.startPos.y+this.yPosCurve.value(i),0);const t=this.opacityCurve.value(i);o.opacity=t,o.outlineThickness=.5*t,o.shadowOffset.x=-.15*t,o.shadowOffset.y=-.15*t;const s=this.scaleCurve.value(i);r.setLocalScale(s,s,s)}}this._microScores=this._microScores.filter((function(i){return i.countdownS>0}))};var BoostPickup=pc.createScript("boostPickup");BoostPickup.attributes.add("boostSeconds",{type:"number",default:3}),BoostPickup.attributes.add("tank",{type:"entity"}),BoostPickup.attributes.add("tankRotationSpeed",{type:"number",default:1}),BoostPickup.attributes.add("respawnTimeS",{type:"number",default:60}),BoostPickup.attributes.add("ring",{type:"entity"}),BoostPickup.attributes.add("ringScaleTimeS",{type:"number",default:1}),BoostPickup.attributes.add("ringScaleCurve",{type:"curve"}),BoostPickup.attributes.add("collectScaleOutTimeS",{type:"number",default:.5}),BoostPickup.attributes.add("collectScaleInTimeS",{type:"number",default:.5}),BoostPickup.attributes.add("collectScaleCurve",{type:"curve"}),BoostPickup.attributes.add("hudBoostButton",{type:"entity"}),BoostPickup.prototype.initialize=function(){this._ringScaleCountdownS=this.ringScaleTimeS,this._collectScaleOutCountdownS=0,this._collectScaleInCountdownS=0,this.entity.collision.on("triggerenter",this._attemptPickup,this)},BoostPickup.prototype._attemptPickup=function(t){this._respawnCountdownS>0||t.script&&t.script.vehicle&&t.script.vehicle.isPlayerControlled&&(this._collectScaleOutCountdownS=this.collectScaleOutTimeS,this._addBoost())},BoostPickup.prototype._addBoost=function(){let t=this.app.globals.currentVehicle.vehicleName;this.app.playerStats.vehicles[t].boostTime||(this.app.playerStats.vehicles[t].boostTime=0),this.app.playerStats.vehicles[t].boostTime+=this.boostSeconds;const e=this.app.playerStats.vehicles[t].boostTime;this.app.globals.currentVehicle.script.vehicle.setBoostTime(e),this.app.fire("vehicle:boost:add",t,e),this.hudBoostButton.enabled=!0,this.hudBoostButton.script.uiBoostButton.show()},BoostPickup.prototype.update=function(t){this.tank.rotateLocal(0,0,this.tankRotationSpeed),this._ringScaleCountdownS-=t,this._ringScaleCountdownS<=0&&(this._ringScaleCountdownS=this.ringScaleTimeS);let e=1-this._ringScaleCountdownS/this.ringScaleTimeS,o=this.ringScaleCurve.value(e);if(this.ring.setLocalScale(o,o,o),this._collectScaleOutCountdownS>0){this._collectScaleOutCountdownS-=t;let e=1-this._collectScaleOutCountdownS/this.collectScaleOutTimeS,o=this.collectScaleCurve.value(e);this.tank.setLocalScale(o,o,o),this.ring.setLocalScale(o,o,o),this._collectScaleOutCountdownS<=0&&(this.tank.enabled=!1,this.ring.enabled=!1,this._respawnCountdownS=this.respawnTimeS)}else if(this._respawnCountdownS>0)this._respawnCountdownS-=t,this._respawnCountdownS<=0&&(this._collectScaleInCountdownS=this.collectScaleInTimeS);else if(this._collectScaleInCountdownS>0){this.tank.enabled=!0,this.ring.enabled=!0,this._collectScaleInCountdownS-=t;let e=this._collectScaleInCountdownS/this.collectScaleInTimeS,o=this.collectScaleCurve.value(e);this.tank.setLocalScale(o,o,o)}};var UiRegionsButton=pc.createScript("uiRegionsButton");UiRegionsButton.attributes.add("movementTimeS",{type:"number"}),UiRegionsButton.attributes.add("movementCurve",{type:"curve",curves:["x","y"]}),UiRegionsButton.prototype.initialize=function(){this._direction="in",this._movementTimeCountdownS=0},UiRegionsButton.prototype.slideIn=function(){this._direction="in",this._movementTimeCountdownS=this.movementTimeS},UiRegionsButton.prototype.slideOut=function(){this._direction="out",this._movementTimeCountdownS=this.movementTimeS},UiRegionsButton.prototype.setMapChunk=function(t){this.entity.findByName("Name").element.text=t.name},UiRegionsButton.prototype.update=function(t){if(this._movementTimeCountdownS>0){this._movementTimeCountdownS-=t;let e=1-this._movementTimeCountdownS/this.movementTimeS;"out"==this._direction&&(e=this._movementTimeCountdownS/this.movementTimeS);let i=this.movementCurve.value(e);this.entity.setLocalPosition(i[0],i[1],0),this._movementTimeCountdownS<=0&&(this._movementTimeCountdownS=0,"out"==this._direction&&(this.entity.enabled=!1))}};var UiRedirectButton=pc.createScript("uiRedirectButton");UiRedirectButton.attributes.add("url",{type:"string"}),UiRedirectButton.prototype.initialize=function(){this.entity.button.on("click",this._redirectTo,this),this.on("destroy",(function(){this.entity.button.off("click",this._redirectTo,this)}),this)},UiRedirectButton.prototype._redirectTo=function(){window.open(this.url,"_blank")};var GuideArrow=pc.createScript("guideArrow");GuideArrow.attributes.add("arrowRender",{type:"entity"}),GuideArrow.attributes.add("followCamera",{type:"entity"}),GuideArrow.attributes.add("scaleCurve",{type:"curve"}),GuideArrow.attributes.add("scaleTimeS",{type:"number",default:.33}),GuideArrow.attributes.add("hideAtDistance",{type:"number",default:5}),GuideArrow.prototype.initialize=function(){this._scaleCountdownS=0,this._scaleDirection="",this._START_SCALE=this.entity.getLocalScale().clone(),this._waypointStore=[],this._currentWaypointTarget=null,this.app.on("job:start",this._startGuiding,this),this.app.on("job:failed",this._stopGuiding,this),this.app.on("job:cancel",this._stopGuiding,this),this.app.on("job:complete",this._stopGuiding,this),this.app.on("vehicle:player:despawn",this._stash,this),this.app.on("vehicle:player:ready",this._bindToCurrentVehicle,this),this.app.on("delivery:target:deactivate",this._deactivateWaypoint,this)},GuideArrow.prototype.show=function(){this.arrowRender.enabled=!0,this._scaleCountdownS=this.scaleTimeS,this._scaleDirection="in"},GuideArrow.prototype.hide=function(){this._scaleCountdownS=this.scaleTimeS,this._scaleDirection="out"},GuideArrow.prototype._bindToCurrentVehicle=function(){this.app.globals.currentVehicle?(this.entity.parent._guid!=this.app.globals.currentVehicle._guid&&this.entity.parent.removeChild(this.entity),this.app.globals.currentVehicle.addChild(this.entity)):console.error("GuideArrow _bindToCurrentVehicle, currentVehicle is null")},GuideArrow.prototype._startGuiding=function(t){this.show(),this._waypointStore=[];for(let i in t.waypoints)this._waypointStore.push({guid:t.waypoints[i]._guid,delivered:!1,waypoint:t.waypoints[i]});this._navigateToClosestWaypoint(),this.app.on("job:restart",this._startGuiding.bind(this,t),this)},GuideArrow.prototype._stopGuiding=function(){this.hide(),this._currentWaypointTarget=null,this._waypointStore=[]},GuideArrow.prototype._stash=function(t){this.entity.parent._guid==t._guid&&(this.entity.parent.removeChild(this.entity),this.followCamera.addChild(this.entity))},GuideArrow.prototype._deactivateWaypoint=function(t){if(!t.script)return;if(!t.script.deliveryTarget)return;if(!t.script.deliveryTarget.hostWaypoint)return;let i=t.script.deliveryTarget.hostWaypoint._guid;for(let t in this._waypointStore)if(this._waypointStore[t].guid==i){this._waypointStore[t].delivered=!0;break}this._navigateToClosestWaypoint()},GuideArrow.prototype._alreadyDelivered=function(t){for(let i in this._waypointStore)if(this._waypointStore[i].guid==t._guid&&this._waypointStore[i].delivered)return!0;return!1},GuideArrow.prototype._navigateToClosestWaypoint=function(){let t=0,i=null;for(let e in this._waypointStore){let o=this._waypointStore[e];if(this._alreadyDelivered(o.waypoint))continue;let r=this.app.globals.restorePosition.distance(o.waypoint.getPosition());(null==i||r<t)&&(i=o.waypoint,t=r)}this._currentWaypointTarget=i},GuideArrow.prototype.update=function(t){if(this._scaleCountdownS>0){this._scaleCountdownS-=t;let i=this._scaleCountdownS/this.scaleTimeS;"in"==this._scaleDirection&&(i=1-this._scaleCountdownS/this.scaleTimeS);let e=this.scaleCurve.value(i);this.entity.setLocalScale(this._START_SCALE.x*e,this._START_SCALE.y*e,this._START_SCALE.z*e),this._scaleCountdownS<=0&&"out"==this._scaleDirection&&(this.arrowRender.enabled=!1,this._scaleDirection)}if(this._shouldNavigate()){this.entity.setPosition(this.app.globals.currentVehicle.getPosition()),this.entity.lookAt(this._currentWaypointTarget.getPosition(),pc.Vec3.UP),this.entity.setLocalPosition(0,1.25,6);let t=this.app.globals.currentVehicle.getPosition().distance(this._currentWaypointTarget.getPosition());t<=this.hideAtDistance&&"out"!=this._scaleDirection?this.hide():!this.arrowRender.enabled&&t>this.hideAtDistance&&this.show()}},GuideArrow.prototype._shouldNavigate=function(){return this._currentWaypointTarget&&this.app.globals.isDriving&&this.app.globals.currentJob&&this.app.globals.currentJob.numDeliveriesRemaining>0&&!this.app.globals.currentJob.hasFailed};var GaragePage=pc.createScript("garagePage");GaragePage.attributes.add("infoGroup",{type:"entity"}),GaragePage.attributes.add("showroomWindow",{type:"entity"}),GaragePage.prototype.initialize=function(){this.entity.on("show",this._updateLayout,this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this)},GaragePage.prototype._updateLayout=function(){this.app.globals.isTouchPortrait?this._showPortraitLayout():this._showLandscapeLayout()},GaragePage.prototype._showPortraitLayout=function(){this.infoGroup.script.pageAnimation.enabled=!1,this.showroomWindow.script.pageAnimation.enabled=!1,this.showroomWindow.element.anchor=[.5,1,.5,1],this.showroomWindow.element.pivot=[.5,1],this.showroomWindow.setLocalPosition(0,-230,0),this.showroomWindow.setLocalScale(.7,.7,.7),this.infoGroup.element.anchor=[.5,1,.5,1],this.infoGroup.element.pivot=[.5,1],this.infoGroup.setLocalPosition(315,-840,0),this.infoGroup.setLocalScale(.9,.9,.9)},GaragePage.prototype._showLandscapeLayout=function(){this.infoGroup.script.pageAnimation.enabled=!0,this.showroomWindow.script.pageAnimation.enabled=!0,this.showroomWindow.element.anchor=[.5,.5,.5,.5],this.showroomWindow.element.pivot=[.5,.5],this.showroomWindow.setLocalPosition(180,0,0),this.showroomWindow.setLocalScale(1,1,1),this.infoGroup.element.anchor=[.5,.5,.5,.5],this.infoGroup.element.pivot=[.5,.5],this.infoGroup.setLocalPosition(-5,-30,0),this.infoGroup.setLocalScale(1,1,1)};var TitleScreenScript=pc.createScript("titleScreenScript");TitleScreenScript.attributes.add("title",{type:"entity"}),TitleScreenScript.attributes.add("car0Button",{type:"entity"}),TitleScreenScript.attributes.add("car1Button",{type:"entity"}),TitleScreenScript.attributes.add("car2Button",{type:"entity"}),TitleScreenScript.attributes.add("progressBar",{type:"entity"}),TitleScreenScript.attributes.add("progressGroup",{type:"entity"}),TitleScreenScript.attributes.add("statusMessage",{type:"entity"}),TitleScreenScript.attributes.add("progressPercentage",{type:"entity"}),TitleScreenScript.prototype.initialize=function(){this._isLoading=!1,this._carsBRequired=!1,this.car0Button.button.on("click",this._enterGame.bind(this,"Memphis"),this),this.car1Button.button.on("click",this._enterGame.bind(this,"Callie"),this),this.car2Button.button.on("click",this._enterGame.bind(this,"Oxford"),this),this.app.graphicsDevice.on("resizecanvas",this._updateLayout,this),this._updateLayout(),this._progressPercentage=0,this._mapBuildingCountdownS=0,this._MAP_BUILD_TIME_ALLOWED_S=4,this.on("destroy",function(){this.car0Button.button.off("click",this),this.car1Button.button.off("click",this),this.car2Button.button.off("click",this),this.app.graphicsDevice.off("resizecanvas",this)}.bind(this))},TitleScreenScript.prototype._updateLayout=function(){this.app.graphicsDevice.height>this.app.graphicsDevice.width?this._setPortrait():this.app.graphicsDevice.width>=this.app.graphicsDevice.height&&this._setLandscape()},TitleScreenScript.prototype._setPortrait=function(){this.title.element&&(this.title.element.anchor=[.5,1,.5,1]),this.title.setLocalPosition(-10,-120,0),this.progressGroup.setLocalPosition(0,280,0),this.statusMessage.setLocalPosition(0,325,0),this.car0Button.setLocalPosition(0,165,0),this.car1Button.setLocalPosition(0,-95,0),this.car2Button.setLocalPosition(0,-355,0)},TitleScreenScript.prototype._setLandscape=function(){this.title.element&&(this.title.element.anchor=[.5,.5,.5,.5]),this.title.setLocalPosition(-10,154,0),this.progressGroup.setLocalPosition(0,8,0),this.statusMessage.setLocalPosition(0,56,0),this.car0Button.setLocalPosition(-260,-100,0),this.car1Button.setLocalPosition(0,-100,0),this.car2Button.setLocalPosition(260,-100,0)},TitleScreenScript.prototype.postInitialize=function(){this._playerVehicleStats=this._getPlayerVehicleStats(),this._showAvailableVehicles(this._playerVehicleStats)},TitleScreenScript.prototype._getPlayerVehicleStats=function(){let t=this.entity.script.localStorage.getItem("stats");if(t&&t.length>0){let e=JSON.parse(JSON.stringify(t));return JSON.parse(atob(e)).vehicles}return{}},TitleScreenScript.prototype._showAvailableVehicles=function(t){const e=[{name:"Dasher",sheet:"b",color:{r:.98,g:.968,b:.768},price:0},{name:"Bruno",sheet:"b",color:{r:.98,g:.635,b:.635},price:800},{name:"Statesman",sheet:"b",color:{r:1,g:1,b:1},price:800},{name:"Trekker",sheet:"b",color:{r:1,g:1,b:1},price:800},{name:"Blitzano",sheet:"b",color:{r:.98,g:.635,b:.635},price:1600},{name:"Bernard",sheet:"b",color:{r:.658,g:.745,b:1},price:800},{name:"Reinhold",sheet:"b",color:{r:.596,g:.596,b:.596},price:2e3},{name:"Celestia",sheet:"b",color:{r:1,g:1,b:1},price:4e3},{name:"Zenith",sheet:"b",color:{r:.658,g:.745,b:1},price:7e3},{name:"Omega",sheet:"b",color:{r:.894,g:.925,b:.576},price:1e4},{name:"Henley",sheet:"b",color:{r:.97,g:.725,b:.545},price:1e3},{name:"Memphis",sheet:"a",color:{r:.98,g:.635,b:.635},price:790},{name:"Callie",sheet:"a",color:{r:.957,g:.765,b:.992},price:790},{name:"Oxford",sheet:"a",color:{r:.725,g:.847,b:.761},price:790}];let i=[];for(const[s,r]of Object.entries(t))for(let t in e)e[t].name==s&&i.push(e[t]);if(i.sort(((t,e)=>e.price-t.price)),i.length>3){this._carsBRequired=!0;let t=[];for(let e=0;e<3;e++){let s=this.app.assets.find(i[e].name,"sprite");s.loaded||t.push(s)}this._numSpritesToLoad=t.length,this._numSpritesLoaded=0;let e=function(t){this._numSpritesLoaded+=1,this._numSpritesLoaded>=this._numSpritesToLoad&&this._displayVehicles(i)}.bind(this,t);for(let i in t)t[i].ready(e),this.app.assets.load(t[i])}else this._displayVehicles([{name:"Memphis",sheet:"a",color:{r:.98,g:.635,b:.635},price:790},{name:"Callie",sheet:"a",color:{r:.957,g:.765,b:.992},price:790},{name:"Oxford",sheet:"a",color:{r:.725,g:.847,b:.761},price:790}])},TitleScreenScript.prototype._displayVehicles=function(t){const e=[this.car0Button,this.car1Button,this.car2Button];for(let i in e){const s=t[i].color;e[i].findByName("Color").element.color=new pc.Color(s.r,s.g,s.b,1),e[i].findByName("Picture").element.sprite=this.app.assets.find(t[i].name,"sprite").resource,e[i].button.off("click"),e[i].button.on("click",this._enterGame.bind(this,t[i].name),this)}},TitleScreenScript.prototype._enterGame=function(t){if(this._isLoading)return;window.carNameSelected=t,this._isLoading=!0,this.statusMessage.element.text="Loading...",this.progressGroup.enabled=!0,this.car0Button.enabled=!1,this.car1Button.enabled=!1,this.car2Button.enabled=!1;var e=this.app.assets.filter((t=>t.tags.has("main")));if(this._carsBRequired){let t=this.app.assets.find("car-4");e.push(t)}var i=0,s=e.length;let r=function(){this._isLoading=!1,this.statusMessage.element.text="Building Map...",this._mapBuildingCountdownS=this._MAP_BUILD_TIME_ALLOWED_S,this.app.scenes.changeScene("Main",function(t,e){t&&console.error("PlayCanvas error loading scene",t)}.bind(this))}.bind(this);for(var n=function(t){i+=1,this._progressPercentage=i/s*.45,i===s&&r()}.bind(this),o=0;o<e.length;o++)e[o].loaded?n():(e[o].ready(n),this.app.assets.load(e[o]));0===e.length&&r()},TitleScreenScript.prototype.update=function(t){this._updateProgress(t)},TitleScreenScript.prototype._updateProgress=function(t){if(this._mapBuildingCountdownS>0){this._mapBuildingCountdownS-=t;let e=1-this._mapBuildingCountdownS/this._MAP_BUILD_TIME_ALLOWED_S;this._progressPercentage=.45+e}this._progressPercentage>.99&&(this._progressPercentage=.99),this.progressPercentage.element.text=parseInt(100*this._progressPercentage)+"%",this.progressBar.element.width=628*this._progressPercentage};var TitleButtonBounce=pc.createScript("titleButtonBounce");TitleButtonBounce.attributes.add("bounceTimeS",{type:"number",default:1}),TitleButtonBounce.attributes.add("bounceStartOffset",{type:"number",default:0,description:"How far through the animation do we start between 0.0 and 1.0"}),TitleButtonBounce.attributes.add("bounceScaleCurve",{type:"curve"}),TitleButtonBounce.prototype.initialize=function(){this._animCountdownS=this.bounceTimeS,this.bounceStartOffset>0&&(this._animCountdownS=this.bounceStartOffset*this.bounceTimeS),this._startEuler=this.entity.getLocalEulerAngles().clone()},TitleButtonBounce.prototype.update=function(t){this._animCountdownS-=t,this._animCountdownS<=0&&(this._animCountdownS=this.bounceTimeS);let e=this._animCountdownS/this.bounceTimeS,n=this.bounceScaleCurve.value(e);this.entity.setLocalScale(n,n,n),this.entity.setLocalEulerAngles(this._startEuler.x,this._startEuler.y,this._startEuler.z-100*(n-1))};var VehicleTraffic=pc.createScript("vehicleTraffic");VehicleTraffic.attributes.add("mapGrid",{type:"entity"}),VehicleTraffic.attributes.add("intersections",{type:"entity"}),VehicleTraffic.attributes.add("waypoints",{type:"entity"}),VehicleTraffic.attributes.add("vehicleContainer",{type:"entity"}),VehicleTraffic.attributes.add("disabledEntityPosition",{type:"vec3",description:"Position entities are teleported to when not in use."}),VehicleTraffic.attributes.add("maxVehicleLimit",{type:"number",default:12,description:"The highest number of vehicles that will be spawned on high-end devices"}),VehicleTraffic.attributes.add("npcVehicleTemplates",{array:!0,type:"asset",assetType:"template"}),VehicleTraffic.attributes.add("mainTextureMaterial",{type:"asset",assetType:"material",description:"The main texture palette used by all vehicle renders"}),VehicleTraffic.attributes.add("npcVehicleMaterials",{array:!0,type:"asset",assetType:"material",description:"These will occupy the variable color space on the vehicle renders"}),VehicleTraffic.prototype.initialize=function(){this.vehicles=[],this._startingVehicleDensity=3,this._entityPool=[],this._activeChunkGuids={},this._fillEntityPool(),this.app.on("stats:loaded",this._setDensity,this),this.app.on("map:chunk:load",this._loadChunk,this),this.app.on("map:chunk:unload",this._unloadChunk,this)},VehicleTraffic.prototype._fillEntityPool=function(){for(let e in this.vehicleContainer.children){let i=this.vehicleContainer.children[e];this._entityPool.push(i),i.script.vehicle.initVehiclePhysics()}},VehicleTraffic.prototype._setDensity=function(){let e=this.app.playerStats.settings.vehicleDensity-this._startingVehicleDensity;this.increaseVehicleDensity(e)},VehicleTraffic.prototype._loadChunk=function(e){this._activeChunkGuids[e._guid]={cells:[]};let i=e.script.mapChunk.vehicleWaypoints.children;this._placeWaypointsInGrid(e,i)},VehicleTraffic.prototype._placeWaypointsInGrid=function(e,i){for(let t in i){let s=i[t];if(s.script&&s.script.vehicleWaypoint){let i=this.mapGrid.script.mapGrid.getGridPosition(s),t=this.mapGrid.script.mapGrid.gridCells[i.x][i.z];t.vehicleWaypoints||(t.vehicleWaypoints=[]),t.vehicleWaypoints.push(s),this._activeChunkGuids[e._guid].cells.push(t)}s.children&&this._placeWaypointsInGrid(e,s.children)}},VehicleTraffic.prototype._unloadChunk=function(e){for(let i in this._activeChunkGuids[e._guid].cells){this._activeChunkGuids[e._guid].cells[i].vehicleWaypoints=[]}delete this._activeChunkGuids[e._guid]},VehicleTraffic.prototype.update=function(e){this._removeOutOfViewVehicles(),this._spawnNewVehicles()},VehicleTraffic.prototype._removeOutOfViewVehicles=function(){for(let e in this.vehicles){let i=this.vehicles[e],t=this.mapGrid.script.mapGrid,s=t.getGridPosition(i);0==t.gridCells[s.x][s.z].inFrustum&&this.despawn(i)}},VehicleTraffic.prototype.despawn=function(e){for(let i=this.vehicles.length-1;i>=0;--i)this.vehicles[i]._guid==e._guid&&this.vehicles.splice(i,1);this._entityPool.push(e),e.rigidbody.teleport(this.disabledEntityPosition),e.rigidbody.angularVelocity=pc.Vec3.ZERO,e.rigidbody.linearVelocity=pc.Vec3.ZERO;e.script.vehicle.body.setActivationState(3),e.script.aiDriver&&(e.script.aiDriver.setCurrentWaypoint(null),e.script.aiDriver.despawn())},VehicleTraffic.prototype._spawnNewVehicles=function(){if(this.mapGrid)for(let e in this.mapGrid.script.mapGrid.newlyOpenedGridCells){if(this._entityPool.length<=0)break;let i=this.mapGrid.script.mapGrid.newlyOpenedGridCells[e];this._spawnNewVehiclesInCell(i)}},VehicleTraffic.prototype._spawnNewVehiclesInCell=function(e){let i=this._getCompatibleWaypoints(e.vehicleWaypoints);if(!(i.length<=0))for(let e in i){let t=this._entityPool.shift();if(!t)return;let s=i[e],n=s.script.vehicleWaypoint.nextWaypoint[0];t.script.aiDriver.setCurrentWaypoint(n),t.setPosition(s.getPosition()),t.setRotation(s.getRotation()),t.rigidbody.teleport(t.getPosition(),t.getRotation());const l=1;t.script.vehicle.body.setActivationState(l),this.vehicles.push(t)}},VehicleTraffic.prototype._getCompatibleWaypoints=function(e){if(!e||e.length<=0)return[];let i=0,t=[];for(let s=Math.floor(pc.math.random(0,e.length));s<e.length;s++){i+=1;let n=e[s];if(i>=e.length)return t.push(n),t;s>=e.length&&i<e.length&&(s=0),n.script&&n.script.vehicleWaypoint&&n.script.vehicleWaypoint.supportsSpawns&&t.push(n)}return t},VehicleTraffic.prototype.increaseVehicleDensity=function(e){this.app.playerStats.settings.vehicleDensity+=e;for(let i=0;i<e;i++){if(this._entityPool.length+this.vehicles.length>this.maxVehicleLimit)return;let e=parseInt(pc.math.random(0,this.npcVehicleTemplates.length)),i=this.npcVehicleTemplates[e].resource.instantiate();i.setPosition(0,0,0),this.vehicleContainer.addChild(i),this._entityPool.push(i),i.script.vehicle.initVehiclePhysics();let t=i.findByName("Body Render"),s=parseInt(pc.math.random(0,this.npcVehicleMaterials.length));t.render.materialAssets=[this.mainTextureMaterial,this.npcVehicleMaterials[s]]}};var MapGrid=pc.createScript("mapGrid");MapGrid.attributes.add("mapSize",{type:"number",default:1e3,description:"Width and depth of the map. Used to calculate grid cell dimensions."}),MapGrid.attributes.add("gridSize",{type:"number",default:50,description:"Number of cells both width and depth. Grids are always 2D squares."}),MapGrid.attributes.add("camera",{type:"entity"}),MapGrid.prototype.initialize=function(){this.gridCells={},this._CELL_WIDTH=this.mapSize/this.gridSize,this._GRID_RADIUS=Math.ceil(this.camera.camera.farClip/this._CELL_WIDTH),this._setUpGridCells(),this.newlyOpenedGridCells=[],this.newlyClosedGridCells=[],this._hasGameLoaded=!1,this._frustumUpdateDelayFrames=3,this.app.once("game:loaded",(function(){this._hasGameLoaded=!0}),this),this._checkSpherePosition=new pc.Vec3,this._checkSphere=new pc.BoundingSphere(this._checkCell,2*this._CELL_WIDTH)},MapGrid.prototype._setUpGridCells=function(){for(let e=-this.gridSize;e<this.gridSize;e+=1){this.gridCells[e]={};for(let t=-this.gridSize;t<this.gridSize;t+=1)this.gridCells[e][t]={inFrustum:!1}}},MapGrid.prototype.update=function(){this._hasGameLoaded&&(this._frustumUpdateDelayFrames<=0?this._updateFrustum():this._frustumUpdateDelayFrames-=1)},MapGrid.prototype._updateFrustum=function(){this.newlyOpenedGridCells=[],this.newlyClosedGridCells=[];let e=this.getGridPosition(this.camera),t=0,i=0;for(let s=0;s<this._GRID_RADIUS+1;s+=1){0==s&&(t=e.x,i=e.z,this._updateCell(t,i));let r=e.x-s,d=e.x+s,a=e.z-s,h=e.z+s;for(t=r;t<=d;t++)i=e.z-s,this._updateCell(t,i);for(t=r;t<=d;t++)i=e.z+s,this._updateCell(t,i);for(i=a;i<=h;i++)t=e.x-s,this._updateCell(t,i);for(i=a;i<=h;i++)t=e.x+s,this._updateCell(t,i)}},MapGrid.prototype._updateCell=function(e,t){let i=e*this._CELL_WIDTH,s=t*this._CELL_WIDTH;e<-49?e=-49:e>49&&(e=49),t<-49?t=-49:t>49&&(t=49),this._checkSphere.center.x=i,this._checkSphere.center.z=s;let r=this.camera.camera.frustum.containsSphere(this._checkSphere);0==this.gridCells[e][t].inFrustum&&0!=r?this.newlyOpenedGridCells.push(this.gridCells[e][t]):0!=this.gridCells[e][t].inFrustum&&0==r&&this.newlyClosedGridCells.push(this.gridCells[e][t]),this.gridCells[e][t].inFrustum=r},MapGrid.prototype.getGridPosition=function(e){return{x:parseInt(e.getPosition().x/this._CELL_WIDTH),z:parseInt(e.getPosition().z/this._CELL_WIDTH)}};var PedestrianTraffic=pc.createScript("pedestrianTraffic");PedestrianTraffic.attributes.add("mapGrid",{type:"entity"}),PedestrianTraffic.attributes.add("pedestrianContainer",{type:"entity"}),PedestrianTraffic.attributes.add("maxPedLimit",{type:"number",default:20,description:"The highest number of peds that will be spawned on high-end devices"}),PedestrianTraffic.attributes.add("disabledEntityPosition",{type:"vec3",description:"Position entities are teleported to when not in use."}),PedestrianTraffic.attributes.add("pedestrianTemplate",{type:"asset",assetType:"template"}),PedestrianTraffic.prototype.initialize=function(){this.peds=[],this.customers=[],this._startingPedDensity=6,this._entityPool=[],this._activeChunkGuids={},this._fillEntityPool(),this.app.on("stats:loaded",this._setDensity,this),this.app.on("map:chunk:load",this._loadChunk,this),this.app.on("map:chunk:unload",this._unloadChunk,this),this.app.on("skills:upgrade",this._setJobSizeDensity,this)},PedestrianTraffic.prototype._fillEntityPool=function(){for(let t in this.pedestrianContainer.children){let i=this.pedestrianContainer.children[t];i.enabled&&this._entityPool.push(i)}},PedestrianTraffic.prototype._setDensity=function(){let t=this.app.playerStats.settings.pedDensity-this._startingPedDensity;this.increasePedDensity(t),this._setJobSizeDensity()},PedestrianTraffic.prototype._setJobSizeDensity=function(){let t=this.app.playerStats.skills.jobSize;if(this._entityPool.length<t){const i=t-this._entityPool.length;this.increasePedDensity(i)}},PedestrianTraffic.prototype._loadChunk=function(t){this._activeChunkGuids[t._guid]={cells:[]};let i=t.script.mapChunk.getPedestrianWaypoints();this._placeWaypointsInGrid(t,i)},PedestrianTraffic.prototype._placeWaypointsInGrid=function(t,i){for(let e in i){let s=i[e];if(s.script&&s.script.pedestrianWaypoint){let i=this.mapGrid.script.mapGrid.getGridPosition(s),e=this.mapGrid.script.mapGrid.gridCells[i.x][i.z];e.pedWaypoints||(e.pedWaypoints=[]),e.pedWaypoints.push(s),this._activeChunkGuids[t._guid].cells.push(e)}s.children&&this._placeWaypointsInGrid(t,s.children)}},PedestrianTraffic.prototype._unloadChunk=function(t){for(let i in this._activeChunkGuids[t._guid].cells){this._activeChunkGuids[t._guid].cells[i].pedWaypoints=[]}delete this._activeChunkGuids[t._guid]},PedestrianTraffic.prototype.update=function(t){this._removeOutOfViewPeds(),this._spawnNewPeds()},PedestrianTraffic.prototype._removeOutOfViewPeds=function(){for(let t in this.peds){let i=this.peds[t];if(i.script.pedestrian.isWaitingForPlayer())continue;let e=this.mapGrid.script.mapGrid,s=e.getGridPosition(i);(0==e.gridCells[s.x][s.z].inFrustum||i.script.pedestrian.isOffMap)&&this.despawn(i)}},PedestrianTraffic.prototype.despawn=function(t){t.setPosition(this.disabledEntityPosition),t.script.pedestrian&&t.script.pedestrian.despawn();for(let i=this.peds.length-1;i>=0;--i)this.peds[i]._guid==t._guid&&this.peds.splice(i,1);this._entityPool.push(t)},PedestrianTraffic.prototype._spawnNewPeds=function(){for(let t in this.mapGrid.script.mapGrid.newlyOpenedGridCells){if(this._entityPool.length<=0)break;let i=this.mapGrid.script.mapGrid.newlyOpenedGridCells[t];this._spawnNewPedsInCell(i)}},PedestrianTraffic.prototype._spawnNewPedsInCell=function(t){let i=this._getCompatibleWaypoints(t.pedWaypoints);if(!(i.length<=0))for(let t in i){if(this._entityPool.length<=0)return;let e=this._entityPool.shift(),s=i[t],n=s.script.pedestrianWaypoint.nextWaypoint;e.script.pedestrian.setCurrentWaypoint(n),e.setPosition(s.getPosition()),e.script.pedestrian.spawn(),this.peds.push(e)}},PedestrianTraffic.prototype._getCompatibleWaypoints=function(t){let i=[];for(let e in t){if(i.length>=2)return i;t[e].script&&t[e].script.pedestrianWaypoint.supportsSpawns&&i.push(t[e])}return i},PedestrianTraffic.prototype.increasePedDensity=function(t){this.app.playerStats.settings.pedDensity+=t;for(let i=0;i<t;i++){if(this._entityPool.length+this.peds.length>this.maxPedLimit)return;let t=this.pedestrianTemplate.resource.instantiate();this.pedestrianContainer.addChild(t),this._entityPool.push(t)}},PedestrianTraffic.prototype.getCustomer=function(){if(this._entityPool.length<=0){let t=this.peds[0];return this.despawn(t),this.getCustomer()}let t=this._entityPool.shift();return this.peds.push(t),t.script.pedestrian.spawn(),t};var UiRegionName=pc.createScript("uiRegionName");UiRegionName.attributes.add("displayTime",{type:"number"}),UiRegionName.attributes.add("opacityCurve",{type:"curve"}),UiRegionName.prototype.initialize=function(){this._displayTimeCountdownS=this.displayTime/2,this._shadowHalf=new pc.Color(0,0,0,.5),this._shadowFull=new pc.Color(0,0,0,1),this.app.on("map:chunk:load",this._show,this)},UiRegionName.prototype._show=function(i){this._displayTimeCountdownS=this.displayTime,this.entity.element.text=i.name,this.entity.element.enabled=!0},UiRegionName.prototype.update=function(i){if(this._displayTimeCountdownS>0){this._displayTimeCountdownS-=i;let t=1-this._displayTimeCountdownS/this.displayTime,e=this.opacityCurve.value(t);this.entity.element.opacity=e,this.entity.element.outlineThickness=.5*e,this.entity.element.shadowColor=e>=.99?this._shadowFull:this._shadowHalf,this._displayTimeCountdownS<=0&&(this._displayTimeCountdownS=0,this.entity.element.opacity=0,this.entity.element.enabled=!1)}};var PageCanvas=pc.createScript("pageCanvas");PageCanvas.attributes.add("screenName",{type:"entity"}),PageCanvas.attributes.add("background",{type:"entity"}),PageCanvas.attributes.add("backButton",{type:"entity"}),PageCanvas.attributes.add("coinCount",{type:"entity"}),PageCanvas.attributes.add("animatedEntities",{type:"entity",array:!0}),PageCanvas.prototype.initialize=function(){this._savedPage=null,this._savedParent=null,this.backButton.button.on("click",this._backOrDrive,this)},PageCanvas.prototype._backOrDrive=function(){this._savedPage.script.page.returnToDrive?this.entity.fire("drive"):this.entity.fire("back")},PageCanvas.prototype.show=function(t){this.screenName.element.text=t.script.page.name,t.enabled=!0,t.fire("show"),this._savedPage=t,this._savedParent=t.parent,t.parent.removeChild(t),this.background.addChild(t),t.script.page.showCoinCount?this.coinCount.enabled=!0:this.coinCount.enabled=!1;for(let t in this.animatedEntities){let a=this.animatedEntities[t];a.script.pageAnimation&&a.script.pageAnimation.play()}this.app.on("ui:home:back:lock",this._lockBackButton,this),this.app.on("ui:home:back:unlock",this._unlockBackButton,this),this.app.keyboard.on(pc.EVENT_KEYDOWN,this._listenForBackKeys,this)},PageCanvas.prototype.hide=function(){this.screenName.element.text="",this.app.off("ui:home:back:lock"),this.app.off("ui:home:back:unlock"),this.app.keyboard.off(pc.EVENT_KEYDOWN,this._listenForBackKeys,this),null!=this._savedPage&&null!=this._savedParent&&(this.background.removeChild(this._savedPage),this._savedParent.addChild(this._savedPage),this._savedPage.fire("hide"),this._savedPage.enabled=!1,this._savedParent=null,this._savedPage=null)},PageCanvas.prototype._lockBackButton=function(){this.backButton.enabled=!1},PageCanvas.prototype._unlockBackButton=function(){this.backButton.enabled=!0},PageCanvas.prototype._listenForBackKeys=function(t){t.key!=pc.KEY_ESCAPE||this.app.globals.isAdPlaying||this._backOrDrive()};var VehicleControls=pc.createScript("vehicleControls");VehicleControls.attributes.add("targetVehicle",{type:"entity",title:"Target Vehicle"}),VehicleControls.prototype.initialize=function(){this._needsVehiclePhysicsInit=!0,this.leftKeyPressed=!1,this.rightKeyPressed=!1,this.upKeyPressed=!1,this.downKeyPressed=!1,this.spaceKeyPressed=!1,this.shiftKeyPressed=!1,this.app.keyboard.on("keydown",(function(e){switch(e.key){case pc.KEY_A:case pc.KEY_LEFT:this.leftKeyPressed=!0;break;case pc.KEY_D:case pc.KEY_RIGHT:this.rightKeyPressed=!0;break;case pc.KEY_W:case pc.KEY_UP:this.upKeyPressed=!0;break;case pc.KEY_S:case pc.KEY_DOWN:this.downKeyPressed=!0;break;case pc.KEY_SHIFT:this.shiftKeyPressed=!0}}),this),this.app.keyboard.on("keyup",(function(e){switch(e.key){case pc.KEY_A:case pc.KEY_LEFT:this.leftKeyPressed=!1;break;case pc.KEY_D:case pc.KEY_RIGHT:this.rightKeyPressed=!1;break;case pc.KEY_W:case pc.KEY_UP:this.upKeyPressed=!1;break;case pc.KEY_S:case pc.KEY_DOWN:this.downKeyPressed=!1;break;case pc.KEY_SHIFT:this.shiftKeyPressed=!1}}),this),this.app.on("window:blur",this._stopAllInputs,this)},VehicleControls.prototype.update=function(e){if(this._needsVehiclePhysicsInit&&(this.targetVehicle.script.vehicle.initVehiclePhysics(),this._needsVehiclePhysicsInit=!1),this.targetVehicle&&this.app.globals.isDriving){var s=0,t=0,i=0;(this.app.leftButtonPressed||this.leftKeyPressed)&&s++,(this.app.rightButtonPressed||this.rightKeyPressed)&&s--,(this.app.forwardButtonPressed||this.upKeyPressed)&&t++,(this.app.reverseButtonPressed||this.downKeyPressed)&&t--,this.shiftKeyPressed&&i++,this.app.isUsingTouch&&this.app.eBrakeButtonPressed&&(i++,t++),this.app.globals.firstInputGiven||0==t||(this.app.globals.firstInputGiven=!0,this.app.fire("poki:gameplayStart")),this.targetVehicle.script.vehicle.fire("vehicle:controls",e,s,t,i)}},VehicleControls.prototype._stopAllInputs=function(){this.leftKeyPressed=!1,this.rightKeyPressed=!1,this.upKeyPressed=!1,this.downKeyPressed=!1,this.spaceKeyPressed=!1,this.shiftKeyPressed=!1};var PulsingElement=pc.createScript("pulsingElement");PulsingElement.attributes.add("pulseTime",{type:"number",default:1.5}),PulsingElement.attributes.add("pulseScaleCurve",{type:"curve"}),PulsingElement.attributes.add("autoPlay",{type:"boolean",default:!0}),PulsingElement.attributes.add("continuous",{type:"boolean",default:!0}),PulsingElement.prototype.initialize=function(){this.autoPlay&&this.play()},PulsingElement.prototype.update=function(t){if(this._pulseCountdownS>0){this._pulseCountdownS-=t;let e=1-this._pulseCountdownS/this.pulseTime,u=this.pulseScaleCurve.value(e);this.entity.setLocalScale(u,u,u),this._pulseCountdownS<=0&&this.continuous&&(this._pulseCountdownS=this.pulseTime)}},PulsingElement.prototype.play=function(){this._pulseCountdownS=this.pulseTime},PulsingElement.prototype.stop=function(){this._pulseCountdownS=0;let t=this.pulseScaleCurve.value(0);this.entity.setLocalScale(t,t,t)};// confetti.min.js
/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/canvas-confetti@1.5.1/dist/confetti.browser.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){!function t(e,n,a,i){var o=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL);function r(){}function l(t){var a=n.exports.Promise,i=void 0!==a?a:e.Promise;return"function"==typeof i?new i(t):(t(r,r),null)}var c,s,u,d,f,h,m,g,b,v=(u=Math.floor(1e3/60),d={},f=0,"function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(c=function(t){var e=Math.random();return d[e]=requestAnimationFrame((function n(a){f===a||f+u-1<a?(f=a,delete d[e],t()):d[e]=requestAnimationFrame(n)})),e},s=function(t){d[t]&&cancelAnimationFrame(d[t])}):(c=function(t){return setTimeout(t,u)},s=function(t){return clearTimeout(t)}),{frame:c,cancel:s}),p=(g={},function(){if(h)return h;if(!a&&o){var e=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join("\n");try{h=new Worker(URL.createObjectURL(new Blob([e])))}catch(t){return void 0!==typeof console&&"function"==typeof console.warn&&console.warn("🎊 Could not load worker",t),null}!function(t){function e(e,n){t.postMessage({options:e||{},callback:n})}t.init=function(e){var n=e.transferControlToOffscreen();t.postMessage({canvas:n},[n])},t.fire=function(n,a,i){if(m)return e(n,null),m;var o=Math.random().toString(36).slice(2);return m=l((function(a){function r(e){e.data.callback===o&&(delete g[o],t.removeEventListener("message",r),m=null,i(),a())}t.addEventListener("message",r),e(n,o),g[o]=r.bind(null,{data:{callback:o}})}))},t.reset=function(){for(var e in t.postMessage({reset:!0}),g)g[e](),delete g[e]}}(h)}return h}),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function M(t,e,n){return function(t,e){return e?e(t):t}(t&&null!=t[e]?t[e]:y[e],n)}function w(t){return t<0?0:Math.floor(t)}function x(t){return parseInt(t,16)}function C(t){return t.map(k)}function k(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:x(e.substring(0,2)),g:x(e.substring(2,4)),b:x(e.substring(4,6))}}function I(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function S(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function T(t,e,n,o,r){var c,s,u=e.slice(),d=t.getContext("2d"),f=l((function(e){function l(){c=s=null,d.clearRect(0,0,o.width,o.height),r(),e()}c=v.frame((function e(){!a||o.width===i.width&&o.height===i.height||(o.width=t.width=i.width,o.height=t.height=i.height),o.width||o.height||(n(t),o.width=t.width,o.height=t.height),d.clearRect(0,0,o.width,o.height),u=u.filter((function(t){return function(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.wobble+=e.wobbleSpeed,e.velocity*=e.decay,e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble);var n=e.tick++/e.totalTicks,a=e.x+e.random*e.tiltCos,i=e.y+e.random*e.tiltSin,o=e.wobbleX+e.random*e.tiltCos,r=e.wobbleY+e.random*e.tiltSin;return t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-n)+")",t.beginPath(),"circle"===e.shape?t.ellipse?t.ellipse(e.x,e.y,Math.abs(o-a)*e.ovalScalar,Math.abs(r-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):function(t,e,n,a,i,o,r,l,c){t.save(),t.translate(e,n),t.rotate(o),t.scale(a,i),t.arc(0,0,1,r,l,c),t.restore()}(t,e.x,e.y,Math.abs(o-a)*e.ovalScalar,Math.abs(r-i)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):(t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(i)),t.lineTo(Math.floor(o),Math.floor(r)),t.lineTo(Math.floor(a),Math.floor(e.wobbleY))),t.closePath(),t.fill(),e.tick<e.totalTicks}(d,t)})),u.length?c=v.frame(e):l()})),s=l}));return{addFettis:function(t){return u=u.concat(t),f},canvas:t,promise:f,reset:function(){c&&v.cancel(c),s&&s()}}}function E(t,n){var a,i=!t,r=!!M(n||{},"resize"),c=M(n,"disableForReducedMotion",Boolean),s=o&&!!M(n||{},"useWorker")?p():null,u=i?I:S,d=!(!t||!s)&&!!t.__confetti_initialized,f="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function h(e,n,i){for(var o,r,l,c,s,d=M(e,"particleCount",w),f=M(e,"angle",Number),h=M(e,"spread",Number),m=M(e,"startVelocity",Number),g=M(e,"decay",Number),b=M(e,"gravity",Number),v=M(e,"drift",Number),p=M(e,"colors",C),y=M(e,"ticks",Number),x=M(e,"shapes"),k=M(e,"scalar"),I=function(t){var e=M(t,"origin",Object);return e.x=M(e,"x",Number),e.y=M(e,"y",Number),e}(e),S=d,E=[],F=t.width*I.x,N=t.height*I.y;S--;)E.push((o={x:F,y:N,angle:f,spread:h,startVelocity:m,color:p[S%p.length],shape:x[(c=0,s=x.length,Math.floor(Math.random()*(s-c))+c)],ticks:y,decay:g,gravity:b,drift:v,scalar:k},r=void 0,l=void 0,r=o.angle*(Math.PI/180),l=o.spread*(Math.PI/180),{x:o.x,y:o.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*o.startVelocity+Math.random()*o.startVelocity,angle2D:-r+(.5*l-Math.random()*l),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:o.color,shape:o.shape,tick:0,totalTicks:o.ticks,decay:o.decay,drift:o.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*o.gravity,ovalScalar:.6,scalar:o.scalar}));return a?a.addFettis(E):(a=T(t,E,u,n,i)).promise}function m(n){var o=c||M(n,"disableForReducedMotion",Boolean),m=M(n,"zIndex",Number);if(o&&f)return l((function(t){t()}));i&&a?t=a.canvas:i&&!t&&(t=function(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}(m),document.body.appendChild(t)),r&&!d&&u(t);var g={width:t.width,height:t.height};function b(){if(s){var e={getBoundingClientRect:function(){if(!i)return t.getBoundingClientRect()}};return u(e),void s.postMessage({resize:{width:e.width,height:e.height}})}g.width=g.height=null}function v(){a=null,r&&e.removeEventListener("resize",b),i&&t&&(document.body.removeChild(t),t=null,d=!1)}return s&&!d&&s.init(t),d=!0,s&&(t.__confetti_initialized=!0),r&&e.addEventListener("resize",b,!1),s?s.fire(n,g,v):h(n,g,v)}return m.reset=function(){s&&s.reset(),a&&a.reset()},m}function F(){return b||(b=E(null,{useWorker:!0,resize:!0})),b}n.exports=function(){return F().apply(this,arguments)},n.exports.reset=function(){F().reset()},n.exports.create=E}(function(){return void 0!==t?t:"undefined"!=typeof self?self:this||{}}(),e,!1),t.confetti=e.exports}(window,{});
//# sourceMappingURL=/sm/ab60d7fb9bf5b5ded42c77782b65b071de85f56c21da42948364d6b2b1961762.map

var PokiTitle=pc.createScript("pokiTitle");PokiTitle.prototype.initialize=function(){PokiSDK.init().then(function(){this.app.fire("poki:ready")}.bind(this)).catch(function(){this.app.fire("poki:ready")}.bind(this)),window.location.href.indexOf("launch.playcanvas.com")>-1&&PokiSDK.setDebug(!0),this.app.on("poki:ready",this._pokiReady,this)},PokiTitle.prototype._pokiReady=function(){PokiSDK.gameLoadingFinished()};var PokiMain=pc.createScript("pokiMain");PokiMain.prototype.initialize=function(){this._gameplayState="stopped",this.app.on("poki:gameplayStart",this._gameplayStart,this),this.app.on("poki:gameplayStop",this._gameplayStop,this),this.app.on("poki:rewardedBreak:play",this._rewardedBreak,this),this.app.on("poki:commercialBreak:play",this._commercialBreak,this)},PokiMain.prototype.captureError=function(a){PokiSDK.captureError(a)},PokiMain.prototype._gameplayStart=function(a=null){"started"!=this._gameplayState&&this._commercialBreak(function(a){PokiSDK.gameplayStart(),this._gameplayState="started",a&&a()}.bind(this,a))},PokiMain.prototype._gameplayStop=function(a=null){"stopped"!=this._gameplayState&&(PokiSDK.gameplayStop(),this._gameplayState="stopped")},PokiMain.prototype._rewardedBreak=function(a,t=null){this.app.globals.isAdPlaying=!0,PokiSDK.rewardedBreak((()=>{this.app.fire("poki:rewardedBreak:start"),this.app.systems.sound.volume=0})).then((i=>{this.app.fire("poki:rewardedBreak:finish"),this.app.playerStats.settings.sfxMuted||(this.app.systems.sound.volume=1),this.app.globals.isAdPlaying=!1,i?a():t&&t()}))},PokiMain.prototype._commercialBreak=function(a){this.app.globals.isTutorialRunning?a&&a():(this.app.systems.sound.volume=0,this.app.globals.isAdPlaying=!0,PokiSDK.commercialBreak().then((()=>{this.app.playerStats.settings.sfxMuted||(this.app.systems.sound.volume=1),this.app.globals.isAdPlaying=!1,a&&a()})))};